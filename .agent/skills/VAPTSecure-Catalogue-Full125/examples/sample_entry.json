{
  "risk_id": "VAPT-001",
  "title": "SQL Injection – Login Form",
  "category": "Injection",
  "sub_category": "SQL",
  "severity": "Critical",
  "cvss_score": 9.8,
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "owasp_ref": "A03:2021",
  "cwe_id": "CWE-89",
  "description": "The WordPress login form at /wp-login.php does not properly sanitise the 'log' (username) parameter before passing it to a MySQL query. An unauthenticated attacker can inject arbitrary SQL to bypass authentication, dump the users table, or execute OS-level commands via INTO OUTFILE.",
  "impact": "Full database compromise; authentication bypass granting wp-admin access; potential remote code execution via SQL FILE privilege.",
  "evidence": "POST /wp-login.php HTTP/1.1\nlog=' OR 1=1--&pwd=x&wp-submit=Log+In\n\nResponse: HTTP/1.1 302 Found — authenticated as admin (user_id=1)",
  "remediation": "1. Update WordPress core to ≥ 6.5.3.\n2. Replace raw $wpdb->query() calls with $wpdb->prepare() throughout the plugin.\n3. Enable a WAF rule blocking SQL metacharacters in authentication fields.\n4. Rotate all WordPress admin credentials and database passwords immediately.\n5. Review and sanitise all other form inputs using sanitize_text_field() / esc_sql().",
  "references": [
    "https://owasp.org/www-project-top-ten/2021/A03_2021-Injection",
    "https://cwe.mitre.org/data/definitions/89.html",
    "https://developer.wordpress.org/reference/classes/wpdb/prepare/"
  ],
  "tags": ["wordpress", "authentication", "sql", "login", "unauthenticated"],
  "affected_asset": "/wp-login.php",
  "discovered_at": "2024-03-10T14:05:00Z",
  "status": "Open"
}
