{
  "metadata": {
    "name": "VAPTSecure SixTee12 — Canonical Risk Catalogue",
    "skill": "VAPTSecure SixTee12",
    "schema_version": "3.4.0",
    "owasp_standard": "OWASP Top 10 2025",
    "plugin": "WordPress VAPT Protection Suite",
    "generated_at": "2026-02-16T06:31:05Z",
    "source": "VAPT-SixTee-Risk-Catalogue-12-EntReady_v3_4.json",
    "total_risks": 12,
    "total_max_cvss": 71.9,
    "score_formula": "security_score = 100 - ( sum_of_unprotected_cvss / 71.9 * 100 )",
    "score_bands": {
      "secure":          { "min": 80, "max": 100, "color": "#00C896" },
      "needs_attention": { "min": 50, "max": 79,  "color": "#FFAA00" },
      "critical":        { "min": 0,  "max": 49,  "color": "#FF4444" }
    },
    "severity_colors": {
      "high":   "#FF4444",
      "medium": "#FFAA00",
      "low":    "#00C896"
    },
    "compliance": {
      "pci_dss": "Requirement 6.5",
      "gdpr": "Article 32",
      "nist_csf": "PR.DS-5"
    }
  },
  "risks": [
    {
      "id": "RISK-001", "check_id": "CHECK-001-001",
      "title": "wp-cron.php Enabled Leads to DoS Attack",
      "category": "Configuration", "severity": "high", "cvss": 7.5, "priority": 8,
      "remediation_effort": "low", "estimated_fix_time": "1-2 hours",
      "owasp": "A06:2025 - Insecure Design", "cwe": ["CWE-400"],
      "summary": "WordPress cron system enabled via wp-cron.php allows resource exhaustion through repeated cron spam requests, leading to server overload.",
      "attack_scenario": "Attacker spams GET /wp-cron.php to trigger repeated cron execution, exhausting server CPU and memory — denial of service.",
      "affected_components": ["WordPress Core", "wp-cron.php", "Server Resources"],
      "payloads": [
        { "type": "http_request", "method": "GET", "url": "/wp-cron.php", "expected_status": 403, "automated": true, "description": "Direct access to wp-cron.php should return 403 Forbidden" },
        { "type": "server_check", "check": "cron_job_exists", "expected_result": "true", "automated": false, "description": "A server-level cron job should exist as the wp-cron replacement" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Add DISABLE_WP_CRON to wp-config.php", "code": "define('DISABLE_WP_CRON', true);", "file": "wp-config.php", "automated": true },
        { "step": 2, "action": "Create server cron job", "code": "*/15 * * * * wget -q -O - https://your-site.com/wp-cron.php?doing_wp_cron > /dev/null 2>&1", "file": "crontab", "automated": false },
        { "step": 3, "action": "Verify endpoint returns 403", "code": "curl -s -o /dev/null -w \"%{http_code}\" https://your-site.com/wp-cron.php", "expected_output": "403", "automated": true }
      ],
      "rollback": ["Remove define('DISABLE_WP_CRON', true) from wp-config.php", "Remove server cron job: crontab -e"]
    },
    {
      "id": "RISK-002", "check_id": "CHECK-002-001",
      "title": "XML-RPC Enabled Leads to Pingback DDoS",
      "category": "Information Disclosure", "severity": "high", "cvss": 7.5, "priority": 9,
      "remediation_effort": "low", "estimated_fix_time": "1-2 hours",
      "owasp": "A02:2025 - Security Misconfiguration", "cwe": ["CWE-918"],
      "summary": "XML-RPC enabled allows distributed pingback amplification attacks, enabling DDoS via the pingback.ping method.",
      "attack_scenario": "Attacker sends pingback.ping via POST /xmlrpc.php to use the site as a DDoS reflector against third-party targets.",
      "affected_components": ["xmlrpc.php", "WordPress Core", "Network"],
      "payloads": [
        { "type": "http_request", "method": "POST", "url": "/xmlrpc.php", "headers": { "Content-Type": "text/xml" }, "body": "<?xml version=\"1.0\"?><methodCall><methodName>pingback.ping</methodName><params><param><value><string>http://evil.com</string></value></param></params></methodCall>", "expected_status": 403, "automated": true, "description": "XML-RPC pingback.ping should return 403" },
        { "type": "http_request", "method": "POST", "url": "/xmlrpc.php", "headers": { "Content-Type": "text/xml" }, "body": "<?xml version=\"1.0\"?><methodCall><methodName>system.listMethods</methodName></methodCall>", "expected_status": 403, "automated": true, "description": "All XML-RPC method calls should be blocked" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Block xmlrpc.php via .htaccess", "code": "<Files xmlrpc.php>\n  Order Deny,Allow\n  Deny from all\n</Files>", "file": ".htaccess", "automated": true },
        { "step": 2, "action": "Or block via Nginx", "code": "location = /xmlrpc.php {\n    deny all;\n    return 403;\n}", "file": "nginx.conf", "automated": true },
        { "step": 3, "action": "Verify blocked", "code": "curl -s -o /dev/null -w \"%{http_code}\" -X POST https://your-site.com/xmlrpc.php", "expected_output": "403", "automated": true }
      ],
      "rollback": ["Remove <Files xmlrpc.php> block from .htaccess", "Remove nginx deny rule and reload: nginx -s reload"]
    },
    {
      "id": "RISK-003", "check_id": "CHECK-003-001",
      "title": "Username Enumeration via WordPress REST API",
      "category": "Authentication", "severity": "medium", "cvss": 5.3, "priority": 6,
      "remediation_effort": "medium", "estimated_fix_time": "2-3 hours",
      "owasp": "A01:2025 - Broken Access Control", "cwe": ["CWE-204"],
      "summary": "The WP REST API /wp/v2/users endpoint exposes all WordPress usernames without authentication.",
      "attack_scenario": "Attacker sends GET /wp-json/wp/v2/users to harvest all WordPress usernames for use in credential stuffing attacks.",
      "affected_components": ["WordPress REST API", "/wp-json/wp/v2/users"],
      "payloads": [
        { "type": "http_request", "method": "GET", "url": "/wp-json/wp/v2/users", "expected_status": 401, "automated": true, "description": "REST users endpoint should require authentication" },
        { "type": "http_request", "method": "GET", "url": "/wp-json/wp/v2/users/1", "expected_status": 401, "automated": true, "description": "Individual user endpoint should also require authentication" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Restrict REST API users endpoint", "code": "add_filter('rest_authentication_errors', function($result) {\n    if (!is_user_logged_in()) {\n        return new WP_Error('rest_not_logged_in', 'Authentication required.', ['status' => 401]);\n    }\n    return $result;\n});", "file": "functions.php", "automated": true },
        { "step": 2, "action": "Verify endpoint returns 401", "code": "curl -s -o /dev/null -w \"%{http_code}\" https://your-site.com/wp-json/wp/v2/users", "expected_output": "401", "automated": true }
      ],
      "rollback": ["Remove add_filter('rest_authentication_errors') from functions.php"]
    },
    {
      "id": "RISK-004", "check_id": "CHECK-004-001",
      "title": "Email Flooding via Password Reset",
      "category": "Authentication", "severity": "medium", "cvss": 5.3, "priority": 5,
      "remediation_effort": "medium", "estimated_fix_time": "2-3 hours",
      "owasp": "A07:2025 - Authentication Failures", "cwe": ["CWE-770"],
      "summary": "The wp-login.php?action=lostpassword endpoint allows unlimited password reset emails.",
      "attack_scenario": "Attacker automates POST requests to /wp-login.php?action=lostpassword to flood the victim's inbox.",
      "affected_components": ["wp-login.php", "WordPress Password Reset"],
      "payloads": [
        { "type": "rate_limit_test", "method": "POST", "url": "/wp-login.php?action=lostpassword", "headers": { "Content-Type": "application/x-www-form-urlencoded" }, "body": "user_login=admin", "attempts": 5, "timeframe_seconds": 300, "expected_behavior": "rate_limited", "expected_status_after_limit": 429, "automated": true, "description": "Password reset should be rate limited after 5 attempts in 5 minutes" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Add transient-based rate limiter to functions.php", "code": "add_action('lostpassword_post', function() {\n    $ip = $_SERVER['REMOTE_ADDR'];\n    $key = 'pwd_reset_' . md5($ip);\n    $attempts = get_transient($key) ?: 0;\n    if ($attempts >= 3) { wp_die('Too many reset attempts. Try again later.', 'Error', 429); }\n    set_transient($key, $attempts + 1, 5 * MINUTE_IN_SECONDS);\n});", "file": "functions.php", "automated": true }
      ],
      "rollback": ["Remove lostpassword_post action hook from functions.php"]
    },
    {
      "id": "RISK-005", "check_id": "CHECK-005-001",
      "title": "Exposed WordPress Admin Username via Author Query",
      "category": "Information Disclosure", "severity": "medium", "cvss": 5.3, "priority": 6,
      "remediation_effort": "low", "estimated_fix_time": "1 hour",
      "owasp": "A01:2025 - Broken Access Control", "cwe": ["CWE-204"],
      "summary": "The /?author=1 query parameter reveals admin usernames through an IDOR vulnerability in author archives.",
      "attack_scenario": "Attacker iterates /?author=N to enumerate all WordPress usernames via the redirect URL which exposes /author/{username}.",
      "affected_components": ["WordPress Author Archives", "URL Rewriting"],
      "payloads": [
        { "type": "http_request", "method": "GET", "url": "/?author=1", "expected_status": 403, "follow_redirects": false, "automated": true, "description": "Author query should return 403, not redirect to /author/{username}" },
        { "type": "http_request", "method": "GET", "url": "/?author=2", "expected_status": 403, "follow_redirects": false, "automated": true, "description": "All author ID enumeration should be blocked" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Block author enumeration via functions.php", "code": "add_action('template_redirect', function() {\n    if (isset($_GET['author'])) { wp_die('Forbidden', 403); }\n    if (is_author()) { wp_redirect(home_url(), 301); exit; }\n});", "file": "functions.php", "automated": true },
        { "step": 2, "action": "Verify /?author=1 is blocked", "code": "curl -s -o /dev/null -w \"%{http_code}\" -L https://your-site.com/?author=1", "expected_output": "403", "automated": true }
      ],
      "rollback": ["Remove template_redirect action hook from functions.php"]
    },
    {
      "id": "RISK-006", "check_id": "CHECK-006-001",
      "title": "Endpoint Disclosure via Auto-Generated WP REST Routes",
      "category": "API Security", "severity": "low", "cvss": 3.7, "priority": 3,
      "remediation_effort": "medium", "estimated_fix_time": "1-2 hours",
      "owasp": "A02:2025 - Security Misconfiguration", "cwe": ["CWE-200"],
      "summary": "WordPress auto-generates REST API routes, exposing the full internal API surface without authentication.",
      "attack_scenario": "Attacker fetches GET /wp-json/ to map all internal REST routes, identifying exploitable endpoints.",
      "affected_components": ["WordPress REST API", "/wp-json/"],
      "payloads": [
        { "type": "http_request", "method": "GET", "url": "/wp-json/", "expected_status": 401, "automated": true, "description": "REST API discovery endpoint should require authentication" },
        { "type": "http_request", "method": "GET", "url": "/wp-json/wp/v2/posts", "expected_status": 401, "automated": true, "description": "Posts endpoint should require authentication when strict" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Restrict REST index to authenticated users", "code": "add_filter('rest_authentication_errors', function($result) {\n    if (!is_user_logged_in()) {\n        return new WP_Error('rest_not_logged_in', 'Authentication required.', ['status' => 401]);\n    }\n    return $result;\n});", "file": "functions.php", "automated": true }
      ],
      "rollback": ["Remove rest_authentication_errors filter from functions.php"]
    },
    {
      "id": "RISK-007", "check_id": "CHECK-007-001",
      "title": "Lack of Rate Limiting on WordPress Login",
      "category": "Authentication", "severity": "high", "cvss": 7.5, "priority": 9,
      "remediation_effort": "medium", "estimated_fix_time": "2-4 hours",
      "owasp": "A07:2025 - Authentication Failures", "cwe": ["CWE-307"],
      "summary": "wp-login.php has no brute-force protection, enabling unlimited automated login attempts.",
      "attack_scenario": "Attacker runs credential stuffing or dictionary attacks against /wp-login.php with no IP lockout, CAPTCHA, or rate limiting.",
      "affected_components": ["wp-login.php", "WordPress Authentication"],
      "payloads": [
        { "type": "brute_force_simulation", "target": "/wp-login.php", "username": "admin", "password": "wrongpassword", "attempts": 5, "expected_behavior": "ip_blocked", "automated": false, "manual_instructions": "Run 5+ failed logins, then check: fail2ban-client status wordpress", "description": "IP should be blocked after 5 failed login attempts" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Configure fail2ban WordPress jail", "code": "[wordpress]\nenabled  = true\nfilter   = wordpress\nlogpath  = /var/log/auth.log\nmaxretry = 5\nfindtime = 600\nbantime  = 3600", "file": "/etc/fail2ban/jail.local", "automated": false },
        { "step": 2, "action": "Add Nginx rate limiting for wp-login.php", "code": "limit_req_zone $binary_remote_addr zone=wplogin:10m rate=5r/m;\nlocation = /wp-login.php {\n    limit_req zone=wplogin burst=3 nodelay;\n}", "file": "nginx.conf", "automated": false },
        { "step": 3, "action": "Restart services", "code": "systemctl restart fail2ban && nginx -s reload", "automated": false }
      ],
      "rollback": ["fail2ban-client unban all", "Remove limit_req from nginx.conf", "nginx -s reload"]
    },
    {
      "id": "RISK-008", "check_id": "CHECK-008-001",
      "title": "Username Enumeration via wp-login.php Error Messages",
      "category": "Authentication", "severity": "medium", "cvss": 5.3, "priority": 5,
      "remediation_effort": "low", "estimated_fix_time": "1 hour",
      "owasp": "A07:2025 - Authentication Failures", "cwe": ["CWE-203"],
      "summary": "Different error messages on wp-login.php reveal whether a username is valid or invalid.",
      "attack_scenario": "Attacker sends login requests and infers valid usernames from differential error messages.",
      "affected_components": ["wp-login.php", "WordPress Login Error Handling"],
      "payloads": [
        { "type": "login_test", "method": "POST", "url": "/wp-login.php", "headers": { "Content-Type": "application/x-www-form-urlencoded" }, "body": "log=invaliduser__vapt__99999&pwd=wrongpassword&wp-submit=Log+In", "forbidden_strings": ["unknown username", "incorrect password", "the password you entered for", "is not registered on this site"], "automated": true, "description": "Error message must not reveal username existence" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Override login error messages", "code": "add_filter('login_errors', function() {\n    return 'Invalid credentials. Please try again.';\n});", "file": "functions.php", "automated": true },
        { "step": 2, "action": "Verify generic message", "code": "curl -s -X POST https://your-site.com/wp-login.php -d 'log=invaliduser&pwd=wrongpass' | grep -i 'unknown\\|incorrect'", "expected_output": "(empty)", "automated": true }
      ],
      "rollback": ["Remove login_errors filter from functions.php"]
    },
    {
      "id": "RISK-009", "check_id": "CHECK-009-001",
      "title": "Lack of Rate Limiting on Contact and Registration Forms",
      "category": "Configuration", "severity": "medium", "cvss": 5.3, "priority": 4,
      "remediation_effort": "medium", "estimated_fix_time": "2-3 hours",
      "owasp": "A06:2025 - Insecure Design", "cwe": ["CWE-770"],
      "summary": "Contact and registration forms accept unlimited submissions, enabling spam and resource exhaustion.",
      "attack_scenario": "Bots flood contact/registration forms causing spam emails, database bloat, and resource exhaustion.",
      "affected_components": ["Contact Forms", "Registration Forms", "CF7", "Gravity Forms"],
      "payloads": [
        { "type": "form_submission", "method": "POST", "url": "/contact-us/", "rapid_submissions": 10, "timeframe_seconds": 60, "expected_behavior": "rate_limited_or_captcha", "expected_status_after_limit": 429, "automated": true, "description": "Rapid form submissions should trigger rate limiting or CAPTCHA" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Add reCAPTCHA v3 or hCaptcha to all public forms", "description": "Install hCaptcha for WP or configure reCAPTCHA in your form plugin settings", "automated": false },
        { "step": 2, "action": "Add Nginx rate limiting for form endpoints", "code": "limit_req_zone $binary_remote_addr zone=forms:10m rate=5r/m;\nlocation ~ ^/(contact|register) {\n    limit_req zone=forms burst=2 nodelay;\n}", "file": "nginx.conf", "automated": false }
      ],
      "rollback": ["Disable CAPTCHA plugin", "Remove limit_req from nginx.conf"]
    },
    {
      "id": "RISK-010", "check_id": "CHECK-010-001",
      "title": "Server Banner Grabbing via HTTP Headers",
      "category": "Information Disclosure", "severity": "low", "cvss": 3.7, "priority": 3,
      "remediation_effort": "low", "estimated_fix_time": "30 minutes",
      "owasp": "A02:2025 - Security Misconfiguration", "cwe": ["CWE-200"],
      "summary": "HTTP response headers expose server software and version, enabling targeted version-specific exploits.",
      "attack_scenario": "Attacker reads Server and X-Powered-By headers to identify exact software versions, then matches against known CVEs.",
      "affected_components": ["HTTP Response Headers", "Apache/Nginx Configuration"],
      "payloads": [
        { "type": "header_inspection", "method": "GET", "url": "/", "forbidden_headers": ["Server", "X-Powered-By", "X-Runtime", "X-AspNet-Version"], "automated": true, "description": "Server version headers must not be present in HTTP responses" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Hide version in Apache", "code": "ServerTokens Prod\nServerSignature Off", "file": "httpd.conf", "automated": true },
        { "step": 2, "action": "Or hide version in Nginx", "code": "server_tokens off;", "file": "nginx.conf", "automated": true },
        { "step": 3, "action": "Remove X-Powered-By header", "code": "Header unset X-Powered-By", "file": ".htaccess", "automated": true },
        { "step": 4, "action": "Verify headers absent", "code": "curl -sI https://your-site.com/ | grep -iE 'server:|x-powered-by:'", "expected_output": "(empty or no version string)", "automated": true }
      ],
      "rollback": ["Remove ServerTokens Prod from httpd.conf", "Revert server_tokens to default in nginx.conf"]
    },
    {
      "id": "RISK-011", "check_id": "CHECK-011-001",
      "title": "Information Disclosure via readme.html",
      "category": "Information Disclosure", "severity": "medium", "cvss": 5.3, "priority": 4,
      "remediation_effort": "low", "estimated_fix_time": "30 minutes",
      "owasp": "A02:2025 - Security Misconfiguration", "cwe": ["CWE-200"],
      "summary": "The WordPress root readme.html file exposes the exact WordPress version number.",
      "attack_scenario": "Attacker fetches /readme.html to identify the exact WordPress version and cross-reference against known CVEs.",
      "affected_components": ["readme.html", "license.txt", "wp-activate.php"],
      "payloads": [
        { "type": "http_request", "method": "GET", "url": "/readme.html", "expected_status": 403, "automated": true, "description": "readme.html should return 403 Forbidden" },
        { "type": "http_request", "method": "GET", "url": "/license.txt", "expected_status": 403, "automated": true, "description": "license.txt also discloses WordPress version" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Block disclosure files via .htaccess", "code": "<FilesMatch \"^(readme|license|wp-config-sample)\\.\\w+$\">\n  Order Deny,Allow\n  Deny from all\n</FilesMatch>", "file": ".htaccess", "automated": true },
        { "step": 2, "action": "Verify file is blocked", "code": "curl -s -o /dev/null -w \"%{http_code}\" https://your-site.com/readme.html", "expected_output": "403", "automated": true }
      ],
      "rollback": ["Remove FilesMatch block from .htaccess"]
    },
    {
      "id": "RISK-012", "check_id": "CHECK-012-001",
      "title": "HSTS Not Implemented",
      "category": "Configuration", "severity": "medium", "cvss": 5.3, "priority": 6,
      "remediation_effort": "low", "estimated_fix_time": "30 minutes",
      "owasp": "A02:2025 - Security Misconfiguration", "cwe": ["CWE-319"],
      "summary": "The missing Strict-Transport-Security header allows HTTPS downgrade attacks and MITM interception.",
      "attack_scenario": "Attacker performs SSL stripping or MITM attack when the victim visits the HTTP version of the site.",
      "affected_components": ["HTTP Response Headers", "TLS Configuration"],
      "payloads": [
        { "type": "header_inspection", "method": "GET", "url": "/", "protocol": "https", "required_header": "Strict-Transport-Security", "required_value_contains": "max-age=31536000", "minimum_max_age": 31536000, "automated": true, "description": "HSTS header must be present with max-age of at least 1 year" },
        { "type": "ssl_test", "url": "http://", "expected_behavior": "redirect_to_https", "expected_status": 301, "automated": true, "description": "HTTP must redirect to HTTPS" }
      ],
      "remediation_steps": [
        { "step": 1, "action": "Add HSTS header in Apache", "code": "Header always set Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\"", "file": ".htaccess", "automated": true },
        { "step": 2, "action": "Or add HSTS header in Nginx", "code": "add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\" always;", "file": "nginx.conf", "automated": true },
        { "step": 3, "action": "Verify header present", "code": "curl -sI https://your-site.com/ | grep -i strict-transport", "expected_output": "strict-transport-security: max-age=31536000", "automated": true },
        { "step": 4, "action": "Optional: submit to HSTS preload list", "url": "https://hstspreload.org", "automated": false, "note": "Only after confirming ALL subdomains support HTTPS" }
      ],
      "rollback": ["Remove HSTS header directive from .htaccess / nginx.conf", "Reload web server"]
    }
  ]
}
