{
  "schema_version": "2.0.0",
  "bundle_date": "2026-02-21",
  "source_file": "VAPT-Risk-Catalogue-Full-125-v3_4_1.json",
  "file_role": "enforcer_pattern_library",
  "bundle_files": {
    "pattern_library": "enforcer_pattern_library_v2.0.json",
    "interface_schema": "interface_schema_v2.0.json",
    "agent_instructions": "ai_agent_instructions_v2.0.json",
    "driver_manifest": "vapt_driver_manifest_v2.0.json",
    "driver_reference": "VAPT_Driver_Reference_v2.0.php",
    "readme": "VAPT_AI_Agent_System_README_v2.0.md"
  },
  "description": "VAPT Enforcer Pattern Library v2.0 \u2014 All 125 risks, all enforcer types. Keys are enforcer-named (htaccess, wp_config, php_functions, wordpress, wordpress_core, fail2ban, nginx, apache, caddy_native, cloudflare, iis, caddy). Every entry includes a driver{} sub-object with machine-executable fields consumed by vapt_driver_manifest_v2.0.json.",
  "enforcer_key_map": {
    "htaccess": ".htaccess enforcer \u2014 corrected rules + cloudflare/iis/caddy variants",
    "wp_config": "wp-config.php enforcer \u2014 enriched with target_constants, insertion anchor",
    "php_functions": "PHP Functions enforcer \u2014 hook-based code for functions.php / plugin file",
    "wordpress": "WordPress enforcer \u2014 WP action/filter hooks",
    "wordpress_core": "WordPress Core enforcer \u2014 core filter hooks",
    "fail2ban": "fail2ban enforcer \u2014 jail.local config blocks",
    "nginx": "Nginx enforcer \u2014 nginx.conf directives",
    "apache": "Apache enforcer \u2014 httpd.conf / VirtualHost directives",
    "caddy_native": "Native Caddy enforcer risks (RISK-123, RISK-124)",
    "cloudflare": "Cloudflare edge implementation derived from .htaccess correction",
    "iis": "IIS web.config implementation derived from .htaccess correction",
    "caddy": "Caddyfile v2 implementation derived from .htaccess correction"
  },
  "patterns": {
    "RISK-001": {
      "risk_id": "RISK-001",
      "title": "wp-cron.php Enabled Leads to DoS Attack",
      "category": "Configuration",
      "severity": "high",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "add_constant",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "DISABLE_WP_CRON"
        ],
        "target_values": [
          "true"
        ],
        "target_constant": "DISABLE_WP_CRON",
        "target_value": "true",
        "value_type": "boolean",
        "code": "define('DISABLE_WP_CRON', true);",
        "wrapped_code": "/* BEGIN VAPT RISK-001 */\ndefine('DISABLE_WP_CRON', true);\n/* END VAPT RISK-001 */",
        "begin_marker": "/* BEGIN VAPT RISK-001 */",
        "end_marker": "/* END VAPT RISK-001 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get DISABLE_WP_CRON",
          "expected": "true"
        },
        "rollback": "wp config delete DISABLE_WP_CRON",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-001 */\ndefine('DISABLE_WP_CRON', true);\n/* END VAPT RISK-001 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-001 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-002": {
      "risk_id": "RISK-002",
      "title": "Xmlrpc enabled Leads to Ping back attack",
      "category": "Information Disclosure",
      "severity": "high",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_block",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<Files \"xmlrpc.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
        "wrapped_code": "# BEGIN VAPT RISK-002\n<Files \"xmlrpc.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-002",
        "begin_marker": "# BEGIN VAPT RISK-002",
        "end_marker": "# END VAPT RISK-002",
        "note": "Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-002 ... # END VAPT RISK-002 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-002\n<Files \"xmlrpc.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-002",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-002",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-002",
        "expression": "(http.request.uri.path ends_with \".xmlrpc\") or (http.request.uri.path ends_with \".php\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-002 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><hiddenSegments>\n      <add segment=\"xmlrpc.php\" />\n    </hiddenSegments></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-002 -->",
        "verification": "curl -sI https://yoursite.com/xmlrpc.php | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-002\n@risk002 {\n    path /xmlrpc.php\n}\nrespond @risk002 \"Access Denied\" 403\n# END VAPT RISK-002",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-003": {
      "risk_id": "RISK-003",
      "title": "Username Enumeration via WordPress REST API",
      "category": "Authentication",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_rewrite_rule",
        "target_file": ".htaccess",
        "insertion_point": "before_wordpress_rewrite",
        "anchor": {
          "search": "# BEGIN WordPress",
          "position": "before",
          "fallback": "prepend"
        },
        "requires": [
          "mod_rewrite"
        ],
        "allowoverride": "FileInfo",
        "code": "<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^wp-json/wp/v2/users$ - [F,L]\n    RewriteRule ^wp-json/wp/v2/users/ - [F,L]\n</IfModule>",
        "wrapped_code": "# BEGIN VAPT RISK-003\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^wp-json/wp/v2/users$ - [F,L]\n    RewriteRule ^wp-json/wp/v2/users/ - [F,L]\n</IfModule>\n# END VAPT RISK-003",
        "begin_marker": "# BEGIN VAPT RISK-003",
        "end_marker": "# END VAPT RISK-003",
        "note": "Must be BEFORE # BEGIN WordPress. WP [L] catch-all makes anything after # END WordPress a dead zone. Covers /users and /users/ variants.",
        "verification": {
          "command": "apachectl -t && curl -sI 'https://yoursite.com/' | grep HTTP",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-003 ... # END VAPT RISK-003 block from .htaccess",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-003\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^wp-json/wp/v2/users$ - [F,L]\n    RewriteRule ^wp-json/wp/v2/users/ - [F,L]\n</IfModule>\n# END VAPT RISK-003",
          "anchor_string": "# BEGIN WordPress",
          "anchor_position": "before",
          "fallback": "prepend",
          "idempotency_check": "# BEGIN VAPT RISK-003",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-003",
        "expression": "(http.request.uri.path eq \"/wp-json/wp/v2/users\") or (http.request.uri.path wildcard \"/wp-json/wp/v2/users/*\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_url_rewrite",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-003 -->\n<configuration>\n  <system.webServer>\n    <rewrite><rules>\n      <rule name=\"VAPT RISK-003\" stopProcessing=\"true\">\n        <match url=\"^wp-json/wp/v2/users.*\" />\n        <action type=\"CustomResponse\" statusCode=\"403\" statusReason=\"Forbidden\" statusDescription=\"Blocked by VAPT RISK-003\" />\n      </rule>\n    </rules></rewrite>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-003 -->",
        "requirements": [
          "IIS URL Rewrite Module 2.1 \u2014 install from Web Platform Installer"
        ],
        "verification": "appcmd validate config && curl -sI https://yoursite.com | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-003\n@risk003 {\n    path /wp-json/wp/v2/users*\n}\nrespond @risk003 \"Access Denied\" 403\n# END VAPT RISK-003",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-004": {
      "risk_id": "RISK-004",
      "title": "Email Flooding via Password Reset",
      "category": "Authentication",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "add_action_hook",
        "target_file": "PHP Functions",
        "insertion_point": "functions_php",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('login_init', 'vapt_rate_limit_password_reset');\nfunction vapt_rate_limit_password_reset() {\n    if ($_POST['user_login'] ?? false) {\n        $ip = $_SERVER['REMOTE_ADDR'];\n        $transient = 'pwd_reset_' . md5($ip);\n        if (get_transient($transient)) {\n            wp_die('Too many attempts. Please try again later.');\n        }\n        set_transient($transient, true, 300); // 5 minutes\n    }\n}",
        "wrapped_code": "// BEGIN VAPT RISK-004\nadd_action('login_init', 'vapt_rate_limit_password_reset');\nfunction vapt_rate_limit_password_reset() {\n    if ($_POST['user_login'] ?? false) {\n        $ip = $_SERVER['REMOTE_ADDR'];\n        $transient = 'pwd_reset_' . md5($ip);\n        if (get_transient($transient)) {\n            wp_die('Too many attempts. Please try again later.');\n        }\n        set_transient($transient, true, 300); // 5 minutes\n    }\n}\n// END VAPT RISK-004",
        "begin_marker": "// BEGIN VAPT RISK-004",
        "end_marker": "// END VAPT RISK-004",
        "target_hook": "login_init",
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp eval \"do_action('login_init');\" --skip-themes",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-004...// END VAPT RISK-004 from target file",
        "driver": {
          "write_mode": "append_to_file",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-004\nadd_action('login_init', 'vapt_rate_limit_password_reset');\nfunction vapt_rate_limit_password_reset() {\n    if ($_POST['user_login'] ?? false) {\n        $ip = $_SERVER['REMOTE_ADDR'];\n        $transient = 'pwd_reset_' . md5($ip);\n        if (get_transient($transient)) {\n            wp_die('Too many attempts. Please try again later.');\n        }\n        set_transient($transient, true, 300); // 5 minutes\n    }\n}\n// END VAPT RISK-004",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-004",
          "if_found": "skip"
        }
      }
    },
    "RISK-005": {
      "risk_id": "RISK-005",
      "title": "Exposed WordPress Admin Username via Author Query",
      "category": "Information Disclosure",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_rewrite_cond",
        "target_file": ".htaccess",
        "insertion_point": "before_wordpress_rewrite",
        "anchor": {
          "search": "# BEGIN WordPress",
          "position": "before",
          "fallback": "prepend"
        },
        "requires": [
          "mod_rewrite"
        ],
        "allowoverride": "FileInfo",
        "code": "<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{QUERY_STRING} (^|&)author=\\d+ [NC]\n    RewriteRule ^ - [F,L]\n</IfModule>",
        "wrapped_code": "# BEGIN VAPT RISK-005\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{QUERY_STRING} (^|&)author=\\d+ [NC]\n    RewriteRule ^ - [F,L]\n</IfModule>\n# END VAPT RISK-005",
        "begin_marker": "# BEGIN VAPT RISK-005",
        "end_marker": "# END VAPT RISK-005",
        "note": "Must be BEFORE # BEGIN WordPress. Regex (^|&)author=\\d+ matches all numeric IDs and any query param position.",
        "verification": {
          "command": "apachectl -t && curl -sI 'https://yoursite.com/' | grep HTTP",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-005 ... # END VAPT RISK-005 block from .htaccess",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-005\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{QUERY_STRING} (^|&)author=\\d+ [NC]\n    RewriteRule ^ - [F,L]\n</IfModule>\n# END VAPT RISK-005",
          "anchor_string": "# BEGIN WordPress",
          "anchor_position": "before",
          "fallback": "prepend",
          "idempotency_check": "# BEGIN VAPT RISK-005",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-005",
        "expression": "(http.request.uri.query contains \"author=\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_url_rewrite",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-005 -->\n<configuration>\n  <system.webServer>\n    <rewrite><rules>\n      <rule name=\"VAPT RISK-005\" stopProcessing=\"true\">\n          <conditions><add input=\"{QUERY_STRING}\" pattern=\"author=\\d+\" /></conditions>\n        <match url=\".*\" />\n        <action type=\"CustomResponse\" statusCode=\"403\" statusReason=\"Forbidden\" statusDescription=\"Blocked by VAPT RISK-005\" />\n      </rule>\n    </rules></rewrite>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-005 -->",
        "requirements": [
          "IIS URL Rewrite Module 2.1 \u2014 install from Web Platform Installer"
        ],
        "verification": "appcmd validate config && curl -sI https://yoursite.com | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-005\n@risk005 {\n    query author=*\n}\nrespond @risk005 \"Access Denied\" 403\n# END VAPT RISK-005",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-006": {
      "risk_id": "RISK-006",
      "title": "Endpoint Disclosure (auto-generated WP REST routes)",
      "category": "API Security",
      "severity": "low",
      "wordpress_core": {
        "enforcer": "WordPress Core",
        "operation": "add_filter_hook",
        "target_file": "WordPress Core",
        "insertion_point": "functions_php",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('rest_authentication_errors', 'vapt_restrict_rest_api');\nfunction vapt_restrict_rest_api($result) {\n    if (!empty($result)) return $result;\n    if (!is_user_logged_in()) {\n        return new WP_Error('rest_not_logged_in', 'Authentication required.', array('status' => 401));\n    }\n    return $result;\n}",
        "wrapped_code": "// BEGIN VAPT RISK-006\nadd_filter('rest_authentication_errors', 'vapt_restrict_rest_api');\nfunction vapt_restrict_rest_api($result) {\n    if (!empty($result)) return $result;\n    if (!is_user_logged_in()) {\n        return new WP_Error('rest_not_logged_in', 'Authentication required.', array('status' => 401));\n    }\n    return $result;\n}\n// END VAPT RISK-006",
        "begin_marker": "// BEGIN VAPT RISK-006",
        "end_marker": "// END VAPT RISK-006",
        "target_hook": "rest_authentication_errors",
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp eval \"do_action('rest_authentication_errors');\" --skip-themes",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-006...// END VAPT RISK-006 from target file",
        "driver": {
          "write_mode": "append_to_file",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-006\nadd_filter('rest_authentication_errors', 'vapt_restrict_rest_api');\nfunction vapt_restrict_rest_api($result) {\n    if (!empty($result)) return $result;\n    if (!is_user_logged_in()) {\n        return new WP_Error('rest_not_logged_in', 'Authentication required.', array('status' => 401));\n    }\n    return $result;\n}\n// END VAPT RISK-006",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-006",
          "if_found": "skip"
        }
      }
    },
    "RISK-007": {
      "risk_id": "RISK-007",
      "title": "Lack of Rate Limiting on WordPress Login",
      "category": "Authentication",
      "severity": "high",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "add_jail_config",
        "target_file": "fail2ban",
        "insertion_point": "jail_local",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-login]\nenabled = true\nport = http,https\nfilter = wordpress-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-007\n[wordpress-login]\nenabled = true\nport = http,https\nfilter = wordpress-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-007",
        "begin_marker": "# BEGIN VAPT RISK-007",
        "end_marker": "# END VAPT RISK-007",
        "target_hook": null,
        "target_jail": "wordpress-login",
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress-login",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-007...# END VAPT RISK-007 from target file",
        "driver": {
          "write_mode": "append_to_file",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-007\n[wordpress-login]\nenabled = true\nport = http,https\nfilter = wordpress-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-007",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-007",
          "if_found": "skip"
        }
      }
    },
    "RISK-008": {
      "risk_id": "RISK-008",
      "title": "Username Enumeration via wp-login.php",
      "category": "Authentication",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "add_filter_hook",
        "target_file": "PHP Functions",
        "insertion_point": "functions_php",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('login_errors', 'vapt_hide_login_errors');\nfunction vapt_hide_login_errors() {\n    return 'Invalid credentials. Please try again.';\n}",
        "wrapped_code": "// BEGIN VAPT RISK-008\nadd_filter('login_errors', 'vapt_hide_login_errors');\nfunction vapt_hide_login_errors() {\n    return 'Invalid credentials. Please try again.';\n}\n// END VAPT RISK-008",
        "begin_marker": "// BEGIN VAPT RISK-008",
        "end_marker": "// END VAPT RISK-008",
        "target_hook": "login_errors",
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp eval \"do_action('login_errors');\" --skip-themes",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-008...// END VAPT RISK-008 from target file",
        "driver": {
          "write_mode": "append_to_file",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-008\nadd_filter('login_errors', 'vapt_hide_login_errors');\nfunction vapt_hide_login_errors() {\n    return 'Invalid credentials. Please try again.';\n}\n// END VAPT RISK-008",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-008",
          "if_found": "skip"
        }
      }
    },
    "RISK-009": {
      "risk_id": "RISK-009",
      "title": "Lack of Rate Limiting on Contact and Registration Forms",
      "category": "Configuration",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "add_action_hook",
        "target_file": "PHP Functions",
        "insertion_point": "functions_php",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('wp_enqueue_scripts', 'vapt_add_recaptcha_v3');\nfunction vapt_add_recaptcha_v3() {\n    wp_enqueue_script('google-recaptcha', 'https://www.google.com/recaptcha/api.js?render=YOUR_SITE_KEY');\n}",
        "wrapped_code": "// BEGIN VAPT RISK-009\nadd_action('wp_enqueue_scripts', 'vapt_add_recaptcha_v3');\nfunction vapt_add_recaptcha_v3() {\n    wp_enqueue_script('google-recaptcha', 'https://www.google.com/recaptcha/api.js?render=YOUR_SITE_KEY');\n}\n// END VAPT RISK-009",
        "begin_marker": "// BEGIN VAPT RISK-009",
        "end_marker": "// END VAPT RISK-009",
        "target_hook": "wp_enqueue_scripts",
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp eval \"do_action('wp_enqueue_scripts');\" --skip-themes",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-009...// END VAPT RISK-009 from target file",
        "driver": {
          "write_mode": "append_to_file",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-009\nadd_action('wp_enqueue_scripts', 'vapt_add_recaptcha_v3');\nfunction vapt_add_recaptcha_v3() {\n    wp_enqueue_script('google-recaptcha', 'https://www.google.com/recaptcha/api.js?render=YOUR_SITE_KEY');\n}\n// END VAPT RISK-009",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-009",
          "if_found": "skip"
        }
      }
    },
    "RISK-010": {
      "risk_id": "RISK-010",
      "title": "Server Banner Grabbing",
      "category": "Information Disclosure",
      "severity": "low",
      "nginx": {
        "enforcer": "Nginx",
        "operation": "modify_server_tokens",
        "target_file": "Nginx",
        "insertion_point": "http_block",
        "anchor": {
          "search": "http {",
          "position": "after",
          "fallback": "append"
        },
        "code": "ServerTokens Prod\nServerSignature Off",
        "wrapped_code": "# BEGIN VAPT RISK-010\nServerTokens Prod\nServerSignature Off\n# END VAPT RISK-010",
        "begin_marker": "# BEGIN VAPT RISK-010",
        "end_marker": "# END VAPT RISK-010",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": "off",
        "verification": {
          "command": "nginx -t && nginx -s reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-010...# END VAPT RISK-010 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "write_block": "# BEGIN VAPT RISK-010\nServerTokens Prod\nServerSignature Off\n# END VAPT RISK-010",
          "anchor_string": "http {",
          "anchor_position": "after",
          "fallback": "append",
          "idempotency_check": "# BEGIN VAPT RISK-010",
          "if_found": "skip"
        }
      }
    },
    "RISK-011": {
      "risk_id": "RISK-011",
      "title": "Information Disclosure via readme.html",
      "category": "Information Disclosure",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_block",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<Files \"readme.html\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
        "wrapped_code": "# BEGIN VAPT RISK-011\n<Files \"readme.html\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-011",
        "begin_marker": "# BEGIN VAPT RISK-011",
        "end_marker": "# END VAPT RISK-011",
        "note": "Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-011 ... # END VAPT RISK-011 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-011\n<Files \"readme.html\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-011",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-011",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-011",
        "expression": "(http.request.uri.path ends_with \".readme\") or (http.request.uri.path ends_with \".html\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-011 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><hiddenSegments>\n      <add segment=\"readme.html\" />\n    </hiddenSegments></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-011 -->",
        "verification": "curl -sI https://yoursite.com/readme.html | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-011\n@risk011 {\n    path /readme.html\n}\nrespond @risk011 \"Access Denied\" 403\n# END VAPT RISK-011",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-012": {
      "risk_id": "RISK-012",
      "title": "HSTS Not Implemented",
      "category": "Configuration",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\"",
        "wrapped_code": "# BEGIN VAPT RISK-012\nHeader always set Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\"\n# END VAPT RISK-012",
        "begin_marker": "# BEGIN VAPT RISK-012",
        "end_marker": "# END VAPT RISK-012",
        "note": "Enable mod_headers: sudo a2enmod headers. Effective over HTTPS only.",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Strict-Transport-Security'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-012 ... # END VAPT RISK-012 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-012\nHeader always set Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\"\n# END VAPT RISK-012",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-012",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "Strict-Transport-Security",
        "value": "max-age=31536000; includeSubDomains; preload",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'Strict-Transport-Security'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-012 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"Strict-Transport-Security\" />\n        <add name=\"Strict-Transport-Security\" value=\"max-age=31536000; includeSubDomains; preload\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-012 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"Strict-Transport-Security\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-012\nheader {\n    Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\"\n    defer\n}\n# END VAPT RISK-012",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'Strict-Transport-Security'"
      }
    },
    "RISK-013": {
      "risk_id": "RISK-013",
      "title": "Directory Listing Enabled",
      "category": "Configuration",
      "severity": "high",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_directive",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [],
        "allowoverride": "Options",
        "code": "Options -Indexes",
        "wrapped_code": "# BEGIN VAPT RISK-013\nOptions -Indexes\n# END VAPT RISK-013",
        "begin_marker": "# BEGIN VAPT RISK-013",
        "end_marker": "# END VAPT RISK-013",
        "note": "Requires AllowOverride Options or All. Silently fails without it.",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-013 ... # END VAPT RISK-013 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-013\nOptions -Indexes\n# END VAPT RISK-013",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-013",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "notes_only",
        "note": "'Options -Indexes' has no Cloudflare edge equivalent. Enforce at origin server."
      },
      "iis": {
        "implementation_type": "web_config_directory_browsing",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-013 -->\n<configuration>\n  <system.webServer>\n    <directoryBrowse enabled=\"false\" />\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-013 -->",
        "verification": "curl -s https://yoursite.com/wp-content/uploads/ | findstr Index"
      },
      "caddy": {
        "implementation_type": "caddy_file_server",
        "caddyfile_snippet": "# BEGIN VAPT RISK-013\n# Directory listing disabled by default in Caddy file_server.\n# Ensure \"browse\" is NOT present:\nfile_server\n# END VAPT RISK-013",
        "note": "Caddy disables directory listing by default. Remove 'browse' if present."
      }
    },
    "RISK-014": {
      "risk_id": "RISK-014",
      "title": "Missing X-Frame-Options Header",
      "category": "Configuration",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set X-Frame-Options \"SAMEORIGIN\"",
        "wrapped_code": "# BEGIN VAPT RISK-014\nHeader always set X-Frame-Options \"SAMEORIGIN\"\n# END VAPT RISK-014",
        "begin_marker": "# BEGIN VAPT RISK-014",
        "end_marker": "# END VAPT RISK-014",
        "note": "",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'X-Frame-Options'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-014 ... # END VAPT RISK-014 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-014\nHeader always set X-Frame-Options \"SAMEORIGIN\"\n# END VAPT RISK-014",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-014",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "X-Frame-Options",
        "value": "SAMEORIGIN",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'X-Frame-Options'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-014 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"X-Frame-Options\" />\n        <add name=\"X-Frame-Options\" value=\"SAMEORIGIN\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-014 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"X-Frame-Options\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-014\nheader {\n    X-Frame-Options \"SAMEORIGIN\"\n    defer\n}\n# END VAPT RISK-014",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'X-Frame-Options'"
      }
    },
    "RISK-015": {
      "risk_id": "RISK-015",
      "title": "Missing X-Content-Type-Options Header",
      "category": "Configuration",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set X-Content-Type-Options \"nosniff\"",
        "wrapped_code": "# BEGIN VAPT RISK-015\nHeader always set X-Content-Type-Options \"nosniff\"\n# END VAPT RISK-015",
        "begin_marker": "# BEGIN VAPT RISK-015",
        "end_marker": "# END VAPT RISK-015",
        "note": "",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'X-Content-Type-Options'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-015 ... # END VAPT RISK-015 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-015\nHeader always set X-Content-Type-Options \"nosniff\"\n# END VAPT RISK-015",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-015",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "X-Content-Type-Options",
        "value": "nosniff",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'X-Content-Type-Options'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-015 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"X-Content-Type-Options\" />\n        <add name=\"X-Content-Type-Options\" value=\"nosniff\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-015 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"X-Content-Type-Options\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-015\nheader {\n    X-Content-Type-Options \"nosniff\"\n    defer\n}\n# END VAPT RISK-015",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'X-Content-Type-Options'"
      }
    },
    "RISK-016": {
      "risk_id": "RISK-016",
      "title": "Missing X-XSS-Protection Header",
      "category": "Configuration",
      "severity": "low",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set X-XSS-Protection \"1; mode=block\"",
        "wrapped_code": "# BEGIN VAPT RISK-016\nHeader always set X-XSS-Protection \"1; mode=block\"\n# END VAPT RISK-016",
        "begin_marker": "# BEGIN VAPT RISK-016",
        "end_marker": "# END VAPT RISK-016",
        "note": "",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'X-XSS-Protection'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-016 ... # END VAPT RISK-016 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-016\nHeader always set X-XSS-Protection \"1; mode=block\"\n# END VAPT RISK-016",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-016",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "X-XSS-Protection",
        "value": "1; mode=block",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'X-XSS-Protection'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-016 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"X-XSS-Protection\" />\n        <add name=\"X-XSS-Protection\" value=\"1; mode=block\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-016 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"X-XSS-Protection\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-016\nheader {\n    X-XSS-Protection \"1; mode=block\"\n    defer\n}\n# END VAPT RISK-016",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'X-XSS-Protection'"
      }
    },
    "RISK-017": {
      "risk_id": "RISK-017",
      "title": "Missing Referrer-Policy Header",
      "category": "Configuration",
      "severity": "low",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set Referrer-Policy \"strict-origin-when-cross-origin\"",
        "wrapped_code": "# BEGIN VAPT RISK-017\nHeader always set Referrer-Policy \"strict-origin-when-cross-origin\"\n# END VAPT RISK-017",
        "begin_marker": "# BEGIN VAPT RISK-017",
        "end_marker": "# END VAPT RISK-017",
        "note": "",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Referrer-Policy'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-017 ... # END VAPT RISK-017 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-017\nHeader always set Referrer-Policy \"strict-origin-when-cross-origin\"\n# END VAPT RISK-017",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-017",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "Referrer-Policy",
        "value": "strict-origin-when-cross-origin",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'Referrer-Policy'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-017 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"Referrer-Policy\" />\n        <add name=\"Referrer-Policy\" value=\"strict-origin-when-cross-origin\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-017 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"Referrer-Policy\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-017\nheader {\n    Referrer-Policy \"strict-origin-when-cross-origin\"\n    defer\n}\n# END VAPT RISK-017",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'Referrer-Policy'"
      }
    },
    "RISK-018": {
      "risk_id": "RISK-018",
      "title": "Missing Permissions-Policy Header",
      "category": "Configuration",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set Permissions-Policy \"geolocation=(), microphone=(), camera=()\"",
        "wrapped_code": "# BEGIN VAPT RISK-018\nHeader always set Permissions-Policy \"geolocation=(), microphone=(), camera=()\"\n# END VAPT RISK-018",
        "begin_marker": "# BEGIN VAPT RISK-018",
        "end_marker": "# END VAPT RISK-018",
        "note": "",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Permissions-Policy'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-018 ... # END VAPT RISK-018 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-018\nHeader always set Permissions-Policy \"geolocation=(), microphone=(), camera=()\"\n# END VAPT RISK-018",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-018",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "Permissions-Policy",
        "value": "geolocation=(), microphone=(), camera=()",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'Permissions-Policy'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-018 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"Permissions-Policy\" />\n        <add name=\"Permissions-Policy\" value=\"geolocation=(), microphone=(), camera=()\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-018 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"Permissions-Policy\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-018\nheader {\n    Permissions-Policy \"geolocation=(), microphone=(), camera=()\"\n    defer\n}\n# END VAPT RISK-018",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'Permissions-Policy'"
      }
    },
    "RISK-019": {
      "risk_id": "RISK-019",
      "title": "Sensitive Files Accessible",
      "category": "Information Disclosure",
      "severity": "high",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_match_block",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<FilesMatch \"\\.(env|git|sql|log|ini|yml|yaml|bak|conf)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>",
        "wrapped_code": "# BEGIN VAPT RISK-019\n<FilesMatch \"\\.(env|git|sql|log|ini|yml|yaml|bak|conf)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-019",
        "begin_marker": "# BEGIN VAPT RISK-019",
        "end_marker": "# END VAPT RISK-019",
        "note": "Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-019 ... # END VAPT RISK-019 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-019\n<FilesMatch \"\\.(env|git|sql|log|ini|yml|yaml|bak|conf)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-019",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-019",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-019",
        "expression": "(http.request.uri.path ends_with \".env\") or (http.request.uri.path ends_with \".git\") or (http.request.uri.path ends_with \".sql\") or (http.request.uri.path ends_with \".log\") or (http.request.uri.path ends_with \".ini\") or (http.request.uri.path ends_with \".yml\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering_extensions",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-019 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><fileExtensions>\n          <add fileExtension=\".env\" allowed=\"false\" />\n          <add fileExtension=\".git\" allowed=\"false\" />\n          <add fileExtension=\".sql\" allowed=\"false\" />\n          <add fileExtension=\".log\" allowed=\"false\" />\n          <add fileExtension=\".ini\" allowed=\"false\" />\n          <add fileExtension=\".yml\" allowed=\"false\" />\n          <add fileExtension=\".yaml\" allowed=\"false\" />\n          <add fileExtension=\".bak\" allowed=\"false\" />\n          <add fileExtension=\".conf\" allowed=\"false\" />\n    </fileExtensions></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-019 -->",
        "verification": "curl -sI https://yoursite.com/test.bak | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-019\n@risk019 {\n    path *.env\n    path *.git\n    path *.sql\n    path *.log\n    path *.ini\n    path *.yml\n    path *.yaml\n    path *.bak\n    path *.conf\n}\nrespond @risk019 \"Access Denied\" 403\n# END VAPT RISK-019",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-020": {
      "risk_id": "RISK-020",
      "title": "PHP File Execution in Uploads Directory",
      "category": "Configuration",
      "severity": "critical",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_match_block",
        "target_file": "wp-content/uploads/.htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<FilesMatch \"\\.php$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>",
        "wrapped_code": "# BEGIN VAPT RISK-020\n<FilesMatch \"\\.php$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-020",
        "begin_marker": "# BEGIN VAPT RISK-020",
        "end_marker": "# END VAPT RISK-020",
        "note": "CRITICAL: Place in wp-content/uploads/.htaccess \u2014 a separate file. <Directory> is silently ignored in .htaccess. Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-020 ... # END VAPT RISK-020 block from wp-content/uploads/.htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}wp-content/uploads/.htaccess",
          "write_block": "# BEGIN VAPT RISK-020\n<FilesMatch \"\\.php$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-020",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-020",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-020",
        "expression": "(http.request.uri.path ends_with \".php\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering_extensions",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-020 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><fileExtensions>\n          <add fileExtension=\".php\" allowed=\"false\" />\n    </fileExtensions></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-020 -->",
        "verification": "curl -sI https://yoursite.com/test.bak | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-020\n@risk020 {\n    path *.php\n}\nrespond @risk020 \"Access Denied\" 403\n# END VAPT RISK-020",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-021": {
      "risk_id": "RISK-021",
      "title": "WordPress Config File Accessible",
      "category": "Information Disclosure",
      "severity": "critical",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_block",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<Files \"wp-config.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
        "wrapped_code": "# BEGIN VAPT RISK-021\n<Files \"wp-config.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-021",
        "begin_marker": "# BEGIN VAPT RISK-021",
        "end_marker": "# END VAPT RISK-021",
        "note": "Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-021 ... # END VAPT RISK-021 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-021\n<Files \"wp-config.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-021",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-021",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-021",
        "expression": "(http.request.uri.path ends_with \".wp\") or (http.request.uri.path ends_with \".config\") or (http.request.uri.path ends_with \".php\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-021 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><hiddenSegments>\n      <add segment=\"wp-config.php\" />\n    </hiddenSegments></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-021 -->",
        "verification": "curl -sI https://yoursite.com/wp-config.php | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-021\n@risk021 {\n    path /wp-config.php\n}\nrespond @risk021 \"Access Denied\" 403\n# END VAPT RISK-021",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-022": {
      "risk_id": "RISK-022",
      "title": "Missing Content-Security-Policy Header",
      "category": "Configuration",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set Content-Security-Policy \"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';\"",
        "wrapped_code": "# BEGIN VAPT RISK-022\nHeader always set Content-Security-Policy \"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';\"\n# END VAPT RISK-022",
        "begin_marker": "# BEGIN VAPT RISK-022",
        "end_marker": "# END VAPT RISK-022",
        "note": "Tune to your plugin/theme needs. Use Content-Security-Policy-Report-Only first.",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Content-Security-Policy'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-022 ... # END VAPT RISK-022 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-022\nHeader always set Content-Security-Policy \"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';\"\n# END VAPT RISK-022",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-022",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "Content-Security-Policy",
        "value": "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'Content-Security-Policy'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-022 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"Content-Security-Policy\" />\n        <add name=\"Content-Security-Policy\" value=\"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-022 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"Content-Security-Policy\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-022\nheader {\n    Content-Security-Policy \"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';\"\n    defer\n}\n# END VAPT RISK-022",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'Content-Security-Policy'"
      }
    },
    "RISK-023": {
      "risk_id": "RISK-023",
      "title": "Trace Method Enabled",
      "category": "Configuration",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_rewrite_rule",
        "target_file": ".htaccess",
        "insertion_point": "before_wordpress_rewrite",
        "anchor": {
          "search": "# BEGIN WordPress",
          "position": "before",
          "fallback": "prepend"
        },
        "requires": [
          "mod_rewrite"
        ],
        "allowoverride": "FileInfo",
        "code": "<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{REQUEST_METHOD} ^TRACE [NC]\n    RewriteRule .* - [F,L]\n</IfModule>",
        "wrapped_code": "# BEGIN VAPT RISK-023\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{REQUEST_METHOD} ^TRACE [NC]\n    RewriteRule .* - [F,L]\n</IfModule>\n# END VAPT RISK-023",
        "begin_marker": "# BEGIN VAPT RISK-023",
        "end_marker": "# END VAPT RISK-023",
        "note": "TraceEnable off is server-level only (silently ignored in .htaccess). Also add: TraceEnable off to httpd.conf.",
        "verification": {
          "command": "apachectl -t && curl -sI 'https://yoursite.com/' | grep HTTP",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-023 ... # END VAPT RISK-023 block from .htaccess",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-023\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{REQUEST_METHOD} ^TRACE [NC]\n    RewriteRule .* - [F,L]\n</IfModule>\n# END VAPT RISK-023",
          "anchor_string": "# BEGIN WordPress",
          "anchor_position": "before",
          "fallback": "prepend",
          "idempotency_check": "# BEGIN VAPT RISK-023",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-023",
        "expression": "(http.request.method eq \"TRACE\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_url_rewrite",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-023 -->\n<configuration>\n  <system.webServer>\n    <rewrite><rules>\n      <rule name=\"VAPT RISK-023\" stopProcessing=\"true\">\n          <conditions><add input=\"{REQUEST_METHOD}\" pattern=\"^TRACE$\" /></conditions>\n        <match url=\".*\" />\n        <action type=\"CustomResponse\" statusCode=\"403\" statusReason=\"Forbidden\" statusDescription=\"Blocked by VAPT RISK-023\" />\n      </rule>\n    </rules></rewrite>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-023 -->",
        "requirements": [
          "IIS URL Rewrite Module 2.1 \u2014 install from Web Platform Installer"
        ],
        "verification": "appcmd validate config && curl -sI https://yoursite.com | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-023\n@risk023 {\n    method TRACE\n}\nrespond @risk023 \"Access Denied\" 403\n# END VAPT RISK-023",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-024": {
      "risk_id": "RISK-024",
      "title": "Server Signature Enabled",
      "category": "Information Disclosure",
      "severity": "low",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header unset Server\nHeader always unset X-Powered-By\nHeader unset X-Powered-By",
        "wrapped_code": "# BEGIN VAPT RISK-024\nHeader unset Server\nHeader always unset X-Powered-By\nHeader unset X-Powered-By\n# END VAPT RISK-024",
        "begin_marker": "# BEGIN VAPT RISK-024",
        "end_marker": "# END VAPT RISK-024",
        "note": "ServerSignature Off is server-level only (silently ignored in .htaccess). Also add: ServerSignature Off + ServerTokens Prod to httpd.conf.",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Server'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-024 ... # END VAPT RISK-024 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-024\nHeader unset Server\nHeader always unset X-Powered-By\nHeader unset X-Powered-By\n# END VAPT RISK-024",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-024",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Remove",
        "names": [
          "Server",
          "X-Powered-By"
        ],
        "expression": "true",
        "note": "Cloudflare Pro+ removes Server header by default; use Transform Rule on Free plan."
      },
      "iis": {
        "implementation_type": "web_config_remove_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-024 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol><customHeaders><remove name=\"X-Powered-By\" /></customHeaders></httpProtocol>\n    <security><requestFiltering removeServerHeader=\"true\" /></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-024 -->",
        "requirements": [
          "IIS 10.0+ for removeServerHeader"
        ],
        "verification": "curl -sI https://yoursite.com | findstr Server"
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-024\nheader {\n    -Server\n    -X-Powered-By\n    defer\n}\n# END VAPT RISK-024",
        "note": "Caddy omits Server header by default; this explicitly removes if a proxy upstream adds it."
      }
    },
    "RISK-025": {
      "risk_id": "RISK-025",
      "title": "ETags Information Leakage",
      "category": "Information Disclosure",
      "severity": "low",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_directive",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [],
        "allowoverride": "Options",
        "code": "FileETag None",
        "wrapped_code": "# BEGIN VAPT RISK-025\nFileETag None\n# END VAPT RISK-025",
        "begin_marker": "# BEGIN VAPT RISK-025",
        "end_marker": "# END VAPT RISK-025",
        "note": "Requires AllowOverride Options or All.",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-025 ... # END VAPT RISK-025 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-025\nFileETag None\n# END VAPT RISK-025",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-025",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "notes_only",
        "note": "'FileETag None' has no Cloudflare edge equivalent. Enforce at origin server."
      },
      "iis": {
        "implementation_type": "notes_only",
        "note": "No direct IIS equivalent for: FileETag None"
      },
      "caddy": {
        "implementation_type": "notes_only",
        "note": "No direct Caddy equivalent for: FileETag None"
      }
    },
    "RISK-026": {
      "risk_id": "RISK-026",
      "title": "Symbolic Links Following Enabled",
      "category": "Configuration",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_directive",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [],
        "allowoverride": "Options",
        "code": "Options -FollowSymLinks\nOptions +SymLinksIfOwnerMatch",
        "wrapped_code": "# BEGIN VAPT RISK-026\nOptions -FollowSymLinks\nOptions +SymLinksIfOwnerMatch\n# END VAPT RISK-026",
        "begin_marker": "# BEGIN VAPT RISK-026",
        "end_marker": "# END VAPT RISK-026",
        "note": "SymLinksIfOwnerMatch allows same-owner symlinks as a safer alternative.",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-026 ... # END VAPT RISK-026 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-026\nOptions -FollowSymLinks\nOptions +SymLinksIfOwnerMatch\n# END VAPT RISK-026",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-026",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "notes_only",
        "note": "'Options -FollowSymLinks\nOptions +SymLinksIfOwnerMatch' has no Cloudflare edge equivalent. Enforce at origin server."
      },
      "iis": {
        "implementation_type": "notes_only",
        "note": "No direct IIS equivalent for: Options -FollowSymLinks\nOptions +SymLinksIfOwnerMatch"
      },
      "caddy": {
        "implementation_type": "notes_only",
        "note": "No direct Caddy equivalent for: Options -FollowSymLinks\nOptions +SymLinksIfOwnerMatch"
      }
    },
    "RISK-027": {
      "risk_id": "RISK-027",
      "title": "WordPress Install File Accessible",
      "category": "Information Disclosure",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_block",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<Files \"install.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
        "wrapped_code": "# BEGIN VAPT RISK-027\n<Files \"install.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-027",
        "begin_marker": "# BEGIN VAPT RISK-027",
        "end_marker": "# END VAPT RISK-027",
        "note": "Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-027 ... # END VAPT RISK-027 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-027\n<Files \"install.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-027",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-027",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-027",
        "expression": "(http.request.uri.path ends_with \".install\") or (http.request.uri.path ends_with \".php\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-027 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><hiddenSegments>\n      <add segment=\"install.php\" />\n    </hiddenSegments></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-027 -->",
        "verification": "curl -sI https://yoursite.com/install.php | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-027\n@risk027 {\n    path /install.php\n}\nrespond @risk027 \"Access Denied\" 403\n# END VAPT RISK-027",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-028": {
      "risk_id": "RISK-028",
      "title": "WordPress Upgrade File Accessible",
      "category": "Information Disclosure",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_block",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<Files \"upgrade.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
        "wrapped_code": "# BEGIN VAPT RISK-028\n<Files \"upgrade.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-028",
        "begin_marker": "# BEGIN VAPT RISK-028",
        "end_marker": "# END VAPT RISK-028",
        "note": "Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-028 ... # END VAPT RISK-028 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-028\n<Files \"upgrade.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-028",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-028",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-028",
        "expression": "(http.request.uri.path ends_with \".upgrade\") or (http.request.uri.path ends_with \".php\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-028 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><hiddenSegments>\n      <add segment=\"upgrade.php\" />\n    </hiddenSegments></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-028 -->",
        "verification": "curl -sI https://yoursite.com/upgrade.php | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-028\n@risk028 {\n    path /upgrade.php\n}\nrespond @risk028 \"Access Denied\" 403\n# END VAPT RISK-028",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-029": {
      "risk_id": "RISK-029",
      "title": "Backup Files Accessible",
      "category": "Information Disclosure",
      "severity": "high",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_match_block",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<FilesMatch \"\\.(bak|backup|old|orig|save|swp|sql|dump)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>",
        "wrapped_code": "# BEGIN VAPT RISK-029\n<FilesMatch \"\\.(bak|backup|old|orig|save|swp|sql|dump)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-029",
        "begin_marker": "# BEGIN VAPT RISK-029",
        "end_marker": "# END VAPT RISK-029",
        "note": "Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-029 ... # END VAPT RISK-029 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-029\n<FilesMatch \"\\.(bak|backup|old|orig|save|swp|sql|dump)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-029",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-029",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-029",
        "expression": "(http.request.uri.path ends_with \".bak\") or (http.request.uri.path ends_with \".backup\") or (http.request.uri.path ends_with \".old\") or (http.request.uri.path ends_with \".orig\") or (http.request.uri.path ends_with \".save\") or (http.request.uri.path ends_with \".swp\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering_extensions",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-029 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><fileExtensions>\n          <add fileExtension=\".bak\" allowed=\"false\" />\n          <add fileExtension=\".backup\" allowed=\"false\" />\n          <add fileExtension=\".old\" allowed=\"false\" />\n          <add fileExtension=\".orig\" allowed=\"false\" />\n          <add fileExtension=\".save\" allowed=\"false\" />\n          <add fileExtension=\".swp\" allowed=\"false\" />\n          <add fileExtension=\".sql\" allowed=\"false\" />\n          <add fileExtension=\".dump\" allowed=\"false\" />\n    </fileExtensions></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-029 -->",
        "verification": "curl -sI https://yoursite.com/test.bak | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-029\n@risk029 {\n    path *.bak\n    path *.backup\n    path *.old\n    path *.orig\n    path *.save\n    path *.swp\n    path *.sql\n    path *.dump\n}\nrespond @risk029 \"Access Denied\" 403\n# END VAPT RISK-029",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-030": {
      "risk_id": "RISK-030",
      "title": "Log Files Accessible",
      "category": "Information Disclosure",
      "severity": "high",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_match_block",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<FilesMatch \"\\.(log|error_log|access_log)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>",
        "wrapped_code": "# BEGIN VAPT RISK-030\n<FilesMatch \"\\.(log|error_log|access_log)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-030",
        "begin_marker": "# BEGIN VAPT RISK-030",
        "end_marker": "# END VAPT RISK-030",
        "note": "Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-030 ... # END VAPT RISK-030 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-030\n<FilesMatch \"\\.(log|error_log|access_log)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-030",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-030",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-030",
        "expression": "(http.request.uri.path ends_with \".log\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering_extensions",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-030 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><fileExtensions>\n          <add fileExtension=\".log\" allowed=\"false\" />\n    </fileExtensions></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-030 -->",
        "verification": "curl -sI https://yoursite.com/test.bak | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-030\n@risk030 {\n    path *.log\n}\nrespond @risk030 \"Access Denied\" 403\n# END VAPT RISK-030",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-031": {
      "risk_id": "RISK-031",
      "title": "Missing Cross-Origin-Resource-Policy",
      "category": "Configuration",
      "severity": "low",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set Cross-Origin-Resource-Policy \"same-origin\"",
        "wrapped_code": "# BEGIN VAPT RISK-031\nHeader always set Cross-Origin-Resource-Policy \"same-origin\"\n# END VAPT RISK-031",
        "begin_marker": "# BEGIN VAPT RISK-031",
        "end_marker": "# END VAPT RISK-031",
        "note": "",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Cross-Origin-Resource-Policy'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-031 ... # END VAPT RISK-031 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-031\nHeader always set Cross-Origin-Resource-Policy \"same-origin\"\n# END VAPT RISK-031",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-031",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "Cross-Origin-Resource-Policy",
        "value": "same-origin",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'Cross-Origin-Resource-Policy'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-031 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"Cross-Origin-Resource-Policy\" />\n        <add name=\"Cross-Origin-Resource-Policy\" value=\"same-origin\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-031 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"Cross-Origin-Resource-Policy\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-031\nheader {\n    Cross-Origin-Resource-Policy \"same-origin\"\n    defer\n}\n# END VAPT RISK-031",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'Cross-Origin-Resource-Policy'"
      }
    },
    "RISK-032": {
      "risk_id": "RISK-032",
      "title": "Missing Cross-Origin-Embedder-Policy",
      "category": "Configuration",
      "severity": "low",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set Cross-Origin-Embedder-Policy \"require-corp\"",
        "wrapped_code": "# BEGIN VAPT RISK-032\nHeader always set Cross-Origin-Embedder-Policy \"require-corp\"\n# END VAPT RISK-032",
        "begin_marker": "# BEGIN VAPT RISK-032",
        "end_marker": "# END VAPT RISK-032",
        "note": "May break third-party embeds. Test with COEP: Report-Only first.",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Cross-Origin-Embedder-Policy'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-032 ... # END VAPT RISK-032 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-032\nHeader always set Cross-Origin-Embedder-Policy \"require-corp\"\n# END VAPT RISK-032",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-032",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "Cross-Origin-Embedder-Policy",
        "value": "require-corp",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'Cross-Origin-Embedder-Policy'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-032 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"Cross-Origin-Embedder-Policy\" />\n        <add name=\"Cross-Origin-Embedder-Policy\" value=\"require-corp\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-032 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"Cross-Origin-Embedder-Policy\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-032\nheader {\n    Cross-Origin-Embedder-Policy \"require-corp\"\n    defer\n}\n# END VAPT RISK-032",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'Cross-Origin-Embedder-Policy'"
      }
    },
    "RISK-033": {
      "risk_id": "RISK-033",
      "title": "Missing Cross-Origin-Opener-Policy",
      "category": "Configuration",
      "severity": "low",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_header",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_headers"
        ],
        "allowoverride": "FileInfo",
        "code": "Header always set Cross-Origin-Opener-Policy \"same-origin\"",
        "wrapped_code": "# BEGIN VAPT RISK-033\nHeader always set Cross-Origin-Opener-Policy \"same-origin\"\n# END VAPT RISK-033",
        "begin_marker": "# BEGIN VAPT RISK-033",
        "end_marker": "# END VAPT RISK-033",
        "note": "",
        "verification": {
          "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Cross-Origin-Opener-Policy'",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-033 ... # END VAPT RISK-033 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-033\nHeader always set Cross-Origin-Opener-Policy \"same-origin\"\n# END VAPT RISK-033",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-033",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "transform_rule",
        "product": "Transform Rules > Modify Response Header",
        "action": "Set",
        "name": "Cross-Origin-Opener-Policy",
        "value": "same-origin",
        "expression": "true",
        "verification": "curl -sI https://yoursite.com | grep -i 'Cross-Origin-Opener-Policy'"
      },
      "iis": {
        "implementation_type": "web_config_http_headers",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-033 -->\n<configuration>\n  <system.webServer>\n    <httpProtocol>\n      <customHeaders>\n        <remove name=\"Cross-Origin-Opener-Policy\" />\n        <add name=\"Cross-Origin-Opener-Policy\" value=\"same-origin\" />\n      </customHeaders>\n    </httpProtocol>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-033 -->",
        "verification": "curl -sI https://yoursite.com | findstr \"Cross-Origin-Opener-Policy\""
      },
      "caddy": {
        "implementation_type": "caddy_header",
        "caddyfile_snippet": "# BEGIN VAPT RISK-033\nheader {\n    Cross-Origin-Opener-Policy \"same-origin\"\n    defer\n}\n# END VAPT RISK-033",
        "verification": "caddy validate && curl -sI https://yoursite.com | grep -i 'Cross-Origin-Opener-Policy'"
      }
    },
    "RISK-034": {
      "risk_id": "RISK-034",
      "title": "WordPress Debug Log Exposed",
      "category": "Information Disclosure",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_files_block",
        "target_file": ".htaccess",
        "insertion_point": "beginning_of_file",
        "anchor": {
          "search": null,
          "position": "prepend",
          "fallback": null
        },
        "requires": [
          "mod_authz_host"
        ],
        "allowoverride": "",
        "code": "<Files \"debug.log\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
        "wrapped_code": "# BEGIN VAPT RISK-034\n<Files \"debug.log\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-034",
        "begin_marker": "# BEGIN VAPT RISK-034",
        "end_marker": "# END VAPT RISK-034",
        "note": "Apache 2.4+: use Require all denied",
        "verification": {
          "command": "apachectl -t",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-034 ... # END VAPT RISK-034 block from .htaccess",
        "driver": {
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-034\n<Files \"debug.log\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-034",
          "anchor_string": null,
          "anchor_position": "prepend",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-034",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-034",
        "expression": "(http.request.uri.path ends_with \".debug\") or (http.request.uri.path ends_with \".log\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com/blocked-file | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_request_filtering",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-034 -->\n<configuration>\n  <system.webServer>\n    <security><requestFiltering><hiddenSegments>\n      <add segment=\"debug.log\" />\n    </hiddenSegments></requestFiltering></security>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-034 -->",
        "verification": "curl -sI https://yoursite.com/debug.log | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-034\n@risk034 {\n    path /debug.log\n}\nrespond @risk034 \"Access Denied\" 403\n# END VAPT RISK-034",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-035": {
      "risk_id": "RISK-035",
      "title": "Apache Status Page Accessible",
      "category": "Information Disclosure",
      "severity": "medium",
      "htaccess": {
        "enforcer": ".htaccess",
        "operation": "add_rewrite_rule",
        "target_file": ".htaccess",
        "insertion_point": "before_wordpress_rewrite",
        "anchor": {
          "search": "# BEGIN WordPress",
          "position": "before",
          "fallback": "prepend"
        },
        "requires": [
          "mod_rewrite"
        ],
        "allowoverride": "FileInfo",
        "code": "<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^server-status - [F,L]\n    RewriteRule ^server-info - [F,L]\n</IfModule>",
        "wrapped_code": "# BEGIN VAPT RISK-035\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^server-status - [F,L]\n    RewriteRule ^server-info - [F,L]\n</IfModule>\n# END VAPT RISK-035",
        "begin_marker": "# BEGIN VAPT RISK-035",
        "end_marker": "# END VAPT RISK-035",
        "note": "Preferred: restrict in httpd.conf with <Location /server-status> Require local </Location>",
        "verification": {
          "command": "apachectl -t && curl -sI 'https://yoursite.com/' | grep HTTP",
          "expected": "Exit 0, no syntax errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-035 ... # END VAPT RISK-035 block from .htaccess",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}.htaccess",
          "write_block": "# BEGIN VAPT RISK-035\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^server-status - [F,L]\n    RewriteRule ^server-info - [F,L]\n</IfModule>\n# END VAPT RISK-035",
          "anchor_string": "# BEGIN WordPress",
          "anchor_position": "before",
          "fallback": "prepend",
          "idempotency_check": "# BEGIN VAPT RISK-035",
          "if_found": "skip"
        }
      },
      "cloudflare": {
        "implementation_type": "waf_custom_rule",
        "name": "VAPT RISK-035",
        "expression": "(http.request.uri.path eq \"/server-status\") or (http.request.uri.path eq \"/server-info\")",
        "action": "Block",
        "dashboard_path": "Cloudflare \u2192 Security \u2192 WAF \u2192 Custom Rules \u2192 Create Rule",
        "verification": "curl -sI https://yoursite.com | grep HTTP"
      },
      "iis": {
        "implementation_type": "web_config_url_rewrite",
        "web_config_snippet": "<!-- BEGIN VAPT RISK-035 -->\n<configuration>\n  <system.webServer>\n    <rewrite><rules>\n      <rule name=\"VAPT RISK-035\" stopProcessing=\"true\">\n        <match url=\"^(server-status|server-info)$\" />\n        <action type=\"CustomResponse\" statusCode=\"403\" statusReason=\"Forbidden\" statusDescription=\"Blocked by VAPT RISK-035\" />\n      </rule>\n    </rules></rewrite>\n  </system.webServer>\n</configuration>\n<!-- END VAPT RISK-035 -->",
        "requirements": [
          "IIS URL Rewrite Module 2.1 \u2014 install from Web Platform Installer"
        ],
        "verification": "appcmd validate config && curl -sI https://yoursite.com | findstr HTTP"
      },
      "caddy": {
        "implementation_type": "caddy_respond_block",
        "caddyfile_snippet": "# BEGIN VAPT RISK-035\n@risk035 {\n    path /server-status* /server-info*\n}\nrespond @risk035 \"Access Denied\" 403\n# END VAPT RISK-035",
        "verification": "caddy validate && curl -sI https://yoursite.com/blocked | grep HTTP"
      }
    },
    "RISK-036": {
      "risk_id": "RISK-036",
      "title": "PHP Error Display Enabled",
      "category": "Configuration",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "display_errors",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('init', function() { @ini_set('display_errors', 0); });",
        "wrapped_code": "// BEGIN VAPT RISK-036\nadd_action('init', function() { @ini_set('display_errors', 0); });\n// END VAPT RISK-036",
        "begin_marker": "// BEGIN VAPT RISK-036",
        "end_marker": "// END VAPT RISK-036",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-036...// END VAPT RISK-036 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-036\nadd_action('init', function() { @ini_set('display_errors', 0); });\n// END VAPT RISK-036",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-036",
          "if_found": "skip"
        }
      }
    },
    "RISK-037": {
      "risk_id": "RISK-037",
      "title": "PHP Version Exposed in Headers",
      "category": "Information Disclosure",
      "severity": "low",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "X-Powered-By",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('init', function() { header_remove('X-Powered-By'); });",
        "wrapped_code": "// BEGIN VAPT RISK-037\nadd_action('init', function() { header_remove('X-Powered-By'); });\n// END VAPT RISK-037",
        "begin_marker": "// BEGIN VAPT RISK-037",
        "end_marker": "// END VAPT RISK-037",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-037...// END VAPT RISK-037 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-037\nadd_action('init', function() { header_remove('X-Powered-By'); });\n// END VAPT RISK-037",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-037",
          "if_found": "skip"
        }
      }
    },
    "RISK-038": {
      "risk_id": "RISK-038",
      "title": "WordPress Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_removed",
        "target_file": "PHP Functions",
        "insertion_point": "wp_generator",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "remove_action('wp_head', 'wp_generator');",
        "wrapped_code": "// BEGIN VAPT RISK-038\nremove_action('wp_head', 'wp_generator');\n// END VAPT RISK-038",
        "begin_marker": "// BEGIN VAPT RISK-038",
        "end_marker": "// END VAPT RISK-038",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-038...// END VAPT RISK-038 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-038\nremove_action('wp_head', 'wp_generator');\n// END VAPT RISK-038",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-038",
          "if_found": "skip"
        }
      }
    },
    "RISK-039": {
      "risk_id": "RISK-039",
      "title": "Plugin Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "version_query",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('style_loader_src', 'vapt_remove_version_query'); add_filter('script_loader_src', 'vapt_remove_version_query');",
        "wrapped_code": "// BEGIN VAPT RISK-039\nadd_filter('style_loader_src', 'vapt_remove_version_query'); add_filter('script_loader_src', 'vapt_remove_version_query');\n// END VAPT RISK-039",
        "begin_marker": "// BEGIN VAPT RISK-039",
        "end_marker": "// END VAPT RISK-039",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-039...// END VAPT RISK-039 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-039\nadd_filter('style_loader_src', 'vapt_remove_version_query'); add_filter('script_loader_src', 'vapt_remove_version_query');\n// END VAPT RISK-039",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-039",
          "if_found": "skip"
        }
      }
    },
    "RISK-040": {
      "risk_id": "RISK-040",
      "title": "WordPress Login Page Not Protected",
      "category": "Authentication",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "login_restrict",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('login_init', 'vapt_restrict_login_by_ip');",
        "wrapped_code": "// BEGIN VAPT RISK-040\nadd_action('login_init', 'vapt_restrict_login_by_ip');\n// END VAPT RISK-040",
        "begin_marker": "// BEGIN VAPT RISK-040",
        "end_marker": "// END VAPT RISK-040",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-040...// END VAPT RISK-040 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-040\nadd_action('login_init', 'vapt_restrict_login_by_ip');\n// END VAPT RISK-040",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-040",
          "if_found": "skip"
        }
      }
    },
    "RISK-041": {
      "risk_id": "RISK-041",
      "title": "Weak Password Policy",
      "category": "Authentication",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "password_policy",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('validate_password_reset', 'vapt_enforce_strong_password', 10, 2);",
        "wrapped_code": "// BEGIN VAPT RISK-041\nadd_action('validate_password_reset', 'vapt_enforce_strong_password', 10, 2);\n// END VAPT RISK-041",
        "begin_marker": "// BEGIN VAPT RISK-041",
        "end_marker": "// END VAPT RISK-041",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-041...// END VAPT RISK-041 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-041\nadd_action('validate_password_reset', 'vapt_enforce_strong_password', 10, 2);\n// END VAPT RISK-041",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-041",
          "if_found": "skip"
        }
      }
    },
    "RISK-042": {
      "risk_id": "RISK-042",
      "title": "Session Timeout Not Configured",
      "category": "Authentication",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "session_timeout",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('auth_cookie_expiration', 'vapt_set_session_timeout', 10, 3);",
        "wrapped_code": "// BEGIN VAPT RISK-042\nadd_filter('auth_cookie_expiration', 'vapt_set_session_timeout', 10, 3);\n// END VAPT RISK-042",
        "begin_marker": "// BEGIN VAPT RISK-042",
        "end_marker": "// END VAPT RISK-042",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-042...// END VAPT RISK-042 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-042\nadd_filter('auth_cookie_expiration', 'vapt_set_session_timeout', 10, 3);\n// END VAPT RISK-042",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-042",
          "if_found": "skip"
        }
      }
    },
    "RISK-043": {
      "risk_id": "RISK-043",
      "title": "No Account Lockout Policy",
      "category": "Authentication",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "account_lockout",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('wp_login_failed', 'vapt_track_failed_logins');",
        "wrapped_code": "// BEGIN VAPT RISK-043\nadd_action('wp_login_failed', 'vapt_track_failed_logins');\n// END VAPT RISK-043",
        "begin_marker": "// BEGIN VAPT RISK-043",
        "end_marker": "// END VAPT RISK-043",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-043...// END VAPT RISK-043 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-043\nadd_action('wp_login_failed', 'vapt_track_failed_logins');\n// END VAPT RISK-043",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-043",
          "if_found": "skip"
        }
      }
    },
    "RISK-044": {
      "risk_id": "RISK-044",
      "title": "User Registration Without Verification",
      "category": "Authentication",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "email_verification",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('user_register', 'vapt_require_email_verification');",
        "wrapped_code": "// BEGIN VAPT RISK-044\nadd_action('user_register', 'vapt_require_email_verification');\n// END VAPT RISK-044",
        "begin_marker": "// BEGIN VAPT RISK-044",
        "end_marker": "// END VAPT RISK-044",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-044...// END VAPT RISK-044 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-044\nadd_action('user_register', 'vapt_require_email_verification');\n// END VAPT RISK-044",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-044",
          "if_found": "skip"
        }
      }
    },
    "RISK-045": {
      "risk_id": "RISK-045",
      "title": "Default Admin Account Exists",
      "category": "Authentication",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "default_admin",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('admin_init', 'vapt_check_default_admin');",
        "wrapped_code": "// BEGIN VAPT RISK-045\nadd_action('admin_init', 'vapt_check_default_admin');\n// END VAPT RISK-045",
        "begin_marker": "// BEGIN VAPT RISK-045",
        "end_marker": "// END VAPT RISK-045",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-045...// END VAPT RISK-045 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-045\nadd_action('admin_init', 'vapt_check_default_admin');\n// END VAPT RISK-045",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-045",
          "if_found": "skip"
        }
      }
    },
    "RISK-046": {
      "risk_id": "RISK-046",
      "title": "No Two-Factor Authentication",
      "category": "Authentication",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "two_factor",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('wp_login', 'vapt_require_2fa_for_admins', 10, 2);",
        "wrapped_code": "// BEGIN VAPT RISK-046\nadd_action('wp_login', 'vapt_require_2fa_for_admins', 10, 2);\n// END VAPT RISK-046",
        "begin_marker": "// BEGIN VAPT RISK-046",
        "end_marker": "// END VAPT RISK-046",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-046...// END VAPT RISK-046 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-046\nadd_action('wp_login', 'vapt_require_2fa_for_admins', 10, 2);\n// END VAPT RISK-046",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-046",
          "if_found": "skip"
        }
      }
    },
    "RISK-047": {
      "risk_id": "RISK-047",
      "title": "File Upload Without Validation",
      "category": "Configuration",
      "severity": "critical",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "upload_validation",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('upload_mimes', 'vapt_restrict_upload_types');",
        "wrapped_code": "// BEGIN VAPT RISK-047\nadd_filter('upload_mimes', 'vapt_restrict_upload_types');\n// END VAPT RISK-047",
        "begin_marker": "// BEGIN VAPT RISK-047",
        "end_marker": "// END VAPT RISK-047",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-047...// END VAPT RISK-047 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-047\nadd_filter('upload_mimes', 'vapt_restrict_upload_types');\n// END VAPT RISK-047",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-047",
          "if_found": "skip"
        }
      }
    },
    "RISK-048": {
      "risk_id": "RISK-048",
      "title": "SQL Injection via Search",
      "category": "Injection",
      "severity": "critical",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "sql_injection",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('query_vars', 'vapt_sanitize_search_queries');",
        "wrapped_code": "// BEGIN VAPT RISK-048\nadd_filter('query_vars', 'vapt_sanitize_search_queries');\n// END VAPT RISK-048",
        "begin_marker": "// BEGIN VAPT RISK-048",
        "end_marker": "// END VAPT RISK-048",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-048...// END VAPT RISK-048 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-048\nadd_filter('query_vars', 'vapt_sanitize_search_queries');\n// END VAPT RISK-048",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-048",
          "if_found": "skip"
        }
      }
    },
    "RISK-049": {
      "risk_id": "RISK-049",
      "title": "Cross-Site Scripting in Comments",
      "category": "Injection",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "comment_xss",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('pre_comment_content', 'vapt_sanitize_comment_content');",
        "wrapped_code": "// BEGIN VAPT RISK-049\nadd_filter('pre_comment_content', 'vapt_sanitize_comment_content');\n// END VAPT RISK-049",
        "begin_marker": "// BEGIN VAPT RISK-049",
        "end_marker": "// END VAPT RISK-049",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-049...// END VAPT RISK-049 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-049\nadd_filter('pre_comment_content', 'vapt_sanitize_comment_content');\n// END VAPT RISK-049",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-049",
          "if_found": "skip"
        }
      }
    },
    "RISK-050": {
      "risk_id": "RISK-050",
      "title": "CSRF Protection Missing",
      "category": "Configuration",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "csrf_protection",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('init', 'vapt_verify_form_nonces');",
        "wrapped_code": "// BEGIN VAPT RISK-050\nadd_action('init', 'vapt_verify_form_nonces');\n// END VAPT RISK-050",
        "begin_marker": "// BEGIN VAPT RISK-050",
        "end_marker": "// END VAPT RISK-050",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-050...// END VAPT RISK-050 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-050\nadd_action('init', 'vapt_verify_form_nonces');\n// END VAPT RISK-050",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-050",
          "if_found": "skip"
        }
      }
    },
    "RISK-051": {
      "risk_id": "RISK-051",
      "title": "Unfiltered HTML in Posts",
      "category": "Injection",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "html_filter",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('content_save_pre', 'vapt_filter_post_html');",
        "wrapped_code": "// BEGIN VAPT RISK-051\nadd_filter('content_save_pre', 'vapt_filter_post_html');\n// END VAPT RISK-051",
        "begin_marker": "// BEGIN VAPT RISK-051",
        "end_marker": "// END VAPT RISK-051",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-051...// END VAPT RISK-051 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-051\nadd_filter('content_save_pre', 'vapt_filter_post_html');\n// END VAPT RISK-051",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-051",
          "if_found": "skip"
        }
      }
    },
    "RISK-052": {
      "risk_id": "RISK-052",
      "title": "Theme Editor Enabled",
      "category": "Configuration",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "theme_editor",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('admin_init', 'vapt_disable_theme_editor');",
        "wrapped_code": "// BEGIN VAPT RISK-052\nadd_action('admin_init', 'vapt_disable_theme_editor');\n// END VAPT RISK-052",
        "begin_marker": "// BEGIN VAPT RISK-052",
        "end_marker": "// END VAPT RISK-052",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-052...// END VAPT RISK-052 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-052\nadd_action('admin_init', 'vapt_disable_theme_editor');\n// END VAPT RISK-052",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-052",
          "if_found": "skip"
        }
      }
    },
    "RISK-053": {
      "risk_id": "RISK-053",
      "title": "Plugin Editor Enabled",
      "category": "Configuration",
      "severity": "high",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "plugin_editor",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('admin_init', 'vapt_disable_plugin_editor');",
        "wrapped_code": "// BEGIN VAPT RISK-053\nadd_action('admin_init', 'vapt_disable_plugin_editor');\n// END VAPT RISK-053",
        "begin_marker": "// BEGIN VAPT RISK-053",
        "end_marker": "// END VAPT RISK-053",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-053...// END VAPT RISK-053 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-053\nadd_action('admin_init', 'vapt_disable_plugin_editor');\n// END VAPT RISK-053",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-053",
          "if_found": "skip"
        }
      }
    },
    "RISK-054": {
      "risk_id": "RISK-054",
      "title": "XML External Entity Processing",
      "category": "Injection",
      "severity": "critical",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "function_called",
        "target_file": "PHP Functions",
        "insertion_point": "xxe_protection",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "libxml_disable_entity_loader(true);",
        "wrapped_code": "// BEGIN VAPT RISK-054\nlibxml_disable_entity_loader(true);\n// END VAPT RISK-054",
        "begin_marker": "// BEGIN VAPT RISK-054",
        "end_marker": "// END VAPT RISK-054",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-054...// END VAPT RISK-054 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-054\nlibxml_disable_entity_loader(true);\n// END VAPT RISK-054",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-054",
          "if_found": "skip"
        }
      }
    },
    "RISK-055": {
      "risk_id": "RISK-055",
      "title": "PHP Deserialization Vulnerability",
      "category": "Injection",
      "severity": "critical",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "deserialization",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('wp_check_filetype', 'vapt_prevent_phar_deserialization');",
        "wrapped_code": "// BEGIN VAPT RISK-055\nadd_filter('wp_check_filetype', 'vapt_prevent_phar_deserialization');\n// END VAPT RISK-055",
        "begin_marker": "// BEGIN VAPT RISK-055",
        "end_marker": "// END VAPT RISK-055",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-055...// END VAPT RISK-055 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-055\nadd_filter('wp_check_filetype', 'vapt_prevent_phar_deserialization');\n// END VAPT RISK-055",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-055",
          "if_found": "skip"
        }
      }
    },
    "RISK-056": {
      "risk_id": "RISK-056",
      "title": "Open Redirect Vulnerability",
      "category": "Configuration",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "redirect_validation",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('wp_redirect', 'vapt_validate_redirects');",
        "wrapped_code": "// BEGIN VAPT RISK-056\nadd_filter('wp_redirect', 'vapt_validate_redirects');\n// END VAPT RISK-056",
        "begin_marker": "// BEGIN VAPT RISK-056",
        "end_marker": "// END VAPT RISK-056",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-056...// END VAPT RISK-056 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-056\nadd_filter('wp_redirect', 'vapt_validate_redirects');\n// END VAPT RISK-056",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-056",
          "if_found": "skip"
        }
      }
    },
    "RISK-057": {
      "risk_id": "RISK-057",
      "title": "Information Leak via JSON API",
      "category": "Information Disclosure",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "api_filter",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('rest_prepare_user', 'vapt_filter_user_api_response');",
        "wrapped_code": "// BEGIN VAPT RISK-057\nadd_filter('rest_prepare_user', 'vapt_filter_user_api_response');\n// END VAPT RISK-057",
        "begin_marker": "// BEGIN VAPT RISK-057",
        "end_marker": "// END VAPT RISK-057",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-057...// END VAPT RISK-057 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-057\nadd_filter('rest_prepare_user', 'vapt_filter_user_api_response');\n// END VAPT RISK-057",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-057",
          "if_found": "skip"
        }
      }
    },
    "RISK-058": {
      "risk_id": "RISK-058",
      "title": "Comment Spam Not Protected",
      "category": "Configuration",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "spam_protection",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('preprocess_comment', 'vapt_check_comment_spam');",
        "wrapped_code": "// BEGIN VAPT RISK-058\nadd_filter('preprocess_comment', 'vapt_check_comment_spam');\n// END VAPT RISK-058",
        "begin_marker": "// BEGIN VAPT RISK-058",
        "end_marker": "// END VAPT RISK-058",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-058...// END VAPT RISK-058 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-058\nadd_filter('preprocess_comment', 'vapt_check_comment_spam');\n// END VAPT RISK-058",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-058",
          "if_found": "skip"
        }
      }
    },
    "RISK-059": {
      "risk_id": "RISK-059",
      "title": "Pingback XML-RPC Enabled",
      "category": "Configuration",
      "severity": "medium",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "filter_applied",
        "target_file": "PHP Functions",
        "insertion_point": "pingback_disable",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('xmlrpc_methods', 'vapt_disable_pingback_method');",
        "wrapped_code": "// BEGIN VAPT RISK-059\nadd_filter('xmlrpc_methods', 'vapt_disable_pingback_method');\n// END VAPT RISK-059",
        "begin_marker": "// BEGIN VAPT RISK-059",
        "end_marker": "// END VAPT RISK-059",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-059...// END VAPT RISK-059 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-059\nadd_filter('xmlrpc_methods', 'vapt_disable_pingback_method');\n// END VAPT RISK-059",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-059",
          "if_found": "skip"
        }
      }
    },
    "RISK-060": {
      "risk_id": "RISK-060",
      "title": "Trackback Enabled",
      "category": "Configuration",
      "severity": "low",
      "php_functions": {
        "enforcer": "PHP Functions",
        "operation": "hook_active",
        "target_file": "PHP Functions",
        "insertion_point": "trackback_disable",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('init', 'vapt_disable_trackbacks');",
        "wrapped_code": "// BEGIN VAPT RISK-060\nadd_action('init', 'vapt_disable_trackbacks');\n// END VAPT RISK-060",
        "begin_marker": "// BEGIN VAPT RISK-060",
        "end_marker": "// END VAPT RISK-060",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-060...// END VAPT RISK-060 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-060\nadd_action('init', 'vapt_disable_trackbacks');\n// END VAPT RISK-060",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-060",
          "if_found": "skip"
        }
      }
    },
    "RISK-061": {
      "risk_id": "RISK-061",
      "title": "WordPress Salts Not Configured",
      "category": "Configuration",
      "severity": "critical",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "AUTH_KEY",
          "SECURE_AUTH_KEY"
        ],
        "target_values": [
          "unique-key-here",
          "unique-key-here"
        ],
        "target_constant": "AUTH_KEY",
        "target_value": "unique-key-here",
        "value_type": "string",
        "code": "define('AUTH_KEY', 'unique-key-here'); define('SECURE_AUTH_KEY', 'unique-key-here');",
        "wrapped_code": "/* BEGIN VAPT RISK-061 */\ndefine('AUTH_KEY', 'unique-key-here'); define('SECURE_AUTH_KEY', 'unique-key-here');\n/* END VAPT RISK-061 */",
        "begin_marker": "/* BEGIN VAPT RISK-061 */",
        "end_marker": "/* END VAPT RISK-061 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get AUTH_KEY",
          "expected": "unique-key-here"
        },
        "rollback": "wp config delete AUTH_KEY",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-061 */\ndefine('AUTH_KEY', 'unique-key-here'); define('SECURE_AUTH_KEY', 'unique-key-here');\n/* END VAPT RISK-061 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-061 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-062": {
      "risk_id": "RISK-062",
      "title": "Database Credentials Exposed",
      "category": "Configuration",
      "severity": "critical",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "DB_PASSWORD"
        ],
        "target_values": [
          "getenv('DB_PASSWORD"
        ],
        "target_constant": "DB_PASSWORD",
        "target_value": "getenv('DB_PASSWORD",
        "value_type": "string",
        "code": "define('DB_PASSWORD', getenv('DB_PASSWORD'));",
        "wrapped_code": "/* BEGIN VAPT RISK-062 */\ndefine('DB_PASSWORD', getenv('DB_PASSWORD'));\n/* END VAPT RISK-062 */",
        "begin_marker": "/* BEGIN VAPT RISK-062 */",
        "end_marker": "/* END VAPT RISK-062 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get DB_PASSWORD",
          "expected": "getenv('DB_PASSWORD"
        },
        "rollback": "wp config delete DB_PASSWORD",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-062 */\ndefine('DB_PASSWORD', getenv('DB_PASSWORD'));\n/* END VAPT RISK-062 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-062 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-063": {
      "risk_id": "RISK-063",
      "title": "Debug Mode Enabled in Production",
      "category": "Configuration",
      "severity": "high",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "WP_DEBUG"
        ],
        "target_values": [
          "false"
        ],
        "target_constant": "WP_DEBUG",
        "target_value": "false",
        "value_type": "string",
        "code": "define('WP_DEBUG', false);",
        "wrapped_code": "/* BEGIN VAPT RISK-063 */\ndefine('WP_DEBUG', false);\n/* END VAPT RISK-063 */",
        "begin_marker": "/* BEGIN VAPT RISK-063 */",
        "end_marker": "/* END VAPT RISK-063 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get WP_DEBUG",
          "expected": "false"
        },
        "rollback": "wp config delete WP_DEBUG",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-063 */\ndefine('WP_DEBUG', false);\n/* END VAPT RISK-063 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-063 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-064": {
      "risk_id": "RISK-064",
      "title": "Script Debug Enabled",
      "category": "Configuration",
      "severity": "medium",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "SCRIPT_DEBUG"
        ],
        "target_values": [
          "false"
        ],
        "target_constant": "SCRIPT_DEBUG",
        "target_value": "false",
        "value_type": "string",
        "code": "define('SCRIPT_DEBUG', false);",
        "wrapped_code": "/* BEGIN VAPT RISK-064 */\ndefine('SCRIPT_DEBUG', false);\n/* END VAPT RISK-064 */",
        "begin_marker": "/* BEGIN VAPT RISK-064 */",
        "end_marker": "/* END VAPT RISK-064 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get SCRIPT_DEBUG",
          "expected": "false"
        },
        "rollback": "wp config delete SCRIPT_DEBUG",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-064 */\ndefine('SCRIPT_DEBUG', false);\n/* END VAPT RISK-064 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-064 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-065": {
      "risk_id": "RISK-065",
      "title": "Save Queries Enabled",
      "category": "Configuration",
      "severity": "medium",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "SAVEQUERIES"
        ],
        "target_values": [
          "false"
        ],
        "target_constant": "SAVEQUERIES",
        "target_value": "false",
        "value_type": "string",
        "code": "define('SAVEQUERIES', false);",
        "wrapped_code": "/* BEGIN VAPT RISK-065 */\ndefine('SAVEQUERIES', false);\n/* END VAPT RISK-065 */",
        "begin_marker": "/* BEGIN VAPT RISK-065 */",
        "end_marker": "/* END VAPT RISK-065 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get SAVEQUERIES",
          "expected": "false"
        },
        "rollback": "wp config delete SAVEQUERIES",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-065 */\ndefine('SAVEQUERIES', false);\n/* END VAPT RISK-065 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-065 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-066": {
      "risk_id": "RISK-066",
      "title": "File Edit Not Disabled",
      "category": "Configuration",
      "severity": "high",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "DISALLOW_FILE_EDIT"
        ],
        "target_values": [
          "true"
        ],
        "target_constant": "DISALLOW_FILE_EDIT",
        "target_value": "true",
        "value_type": "string",
        "code": "define('DISALLOW_FILE_EDIT', true);",
        "wrapped_code": "/* BEGIN VAPT RISK-066 */\ndefine('DISALLOW_FILE_EDIT', true);\n/* END VAPT RISK-066 */",
        "begin_marker": "/* BEGIN VAPT RISK-066 */",
        "end_marker": "/* END VAPT RISK-066 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get DISALLOW_FILE_EDIT",
          "expected": "true"
        },
        "rollback": "wp config delete DISALLOW_FILE_EDIT",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-066 */\ndefine('DISALLOW_FILE_EDIT', true);\n/* END VAPT RISK-066 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-066 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-067": {
      "risk_id": "RISK-067",
      "title": "File Modification Not Restricted",
      "category": "Configuration",
      "severity": "high",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "DISALLOW_FILE_MODS"
        ],
        "target_values": [
          "true"
        ],
        "target_constant": "DISALLOW_FILE_MODS",
        "target_value": "true",
        "value_type": "string",
        "code": "define('DISALLOW_FILE_MODS', true);",
        "wrapped_code": "/* BEGIN VAPT RISK-067 */\ndefine('DISALLOW_FILE_MODS', true);\n/* END VAPT RISK-067 */",
        "begin_marker": "/* BEGIN VAPT RISK-067 */",
        "end_marker": "/* END VAPT RISK-067 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get DISALLOW_FILE_MODS",
          "expected": "true"
        },
        "rollback": "wp config delete DISALLOW_FILE_MODS",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-067 */\ndefine('DISALLOW_FILE_MODS', true);\n/* END VAPT RISK-067 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-067 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-068": {
      "risk_id": "RISK-068",
      "title": "Automatic Updates Disabled",
      "category": "Configuration",
      "severity": "high",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "WP_AUTO_UPDATE_CORE"
        ],
        "target_values": [
          "true"
        ],
        "target_constant": "WP_AUTO_UPDATE_CORE",
        "target_value": "true",
        "value_type": "string",
        "code": "define('WP_AUTO_UPDATE_CORE', true);",
        "wrapped_code": "/* BEGIN VAPT RISK-068 */\ndefine('WP_AUTO_UPDATE_CORE', true);\n/* END VAPT RISK-068 */",
        "begin_marker": "/* BEGIN VAPT RISK-068 */",
        "end_marker": "/* END VAPT RISK-068 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get WP_AUTO_UPDATE_CORE",
          "expected": "true"
        },
        "rollback": "wp config delete WP_AUTO_UPDATE_CORE",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-068 */\ndefine('WP_AUTO_UPDATE_CORE', true);\n/* END VAPT RISK-068 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-068 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-069": {
      "risk_id": "RISK-069",
      "title": "SSL Not Enforced for Admin",
      "category": "Configuration",
      "severity": "high",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "FORCE_SSL_ADMIN"
        ],
        "target_values": [
          "true"
        ],
        "target_constant": "FORCE_SSL_ADMIN",
        "target_value": "true",
        "value_type": "string",
        "code": "define('FORCE_SSL_ADMIN', true);",
        "wrapped_code": "/* BEGIN VAPT RISK-069 */\ndefine('FORCE_SSL_ADMIN', true);\n/* END VAPT RISK-069 */",
        "begin_marker": "/* BEGIN VAPT RISK-069 */",
        "end_marker": "/* END VAPT RISK-069 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get FORCE_SSL_ADMIN",
          "expected": "true"
        },
        "rollback": "wp config delete FORCE_SSL_ADMIN",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-069 */\ndefine('FORCE_SSL_ADMIN', true);\n/* END VAPT RISK-069 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-069 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-070": {
      "risk_id": "RISK-070",
      "title": "SSL Not Enforced for Login",
      "category": "Configuration",
      "severity": "high",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "FORCE_SSL_LOGIN"
        ],
        "target_values": [
          "true"
        ],
        "target_constant": "FORCE_SSL_LOGIN",
        "target_value": "true",
        "value_type": "string",
        "code": "define('FORCE_SSL_LOGIN', true);",
        "wrapped_code": "/* BEGIN VAPT RISK-070 */\ndefine('FORCE_SSL_LOGIN', true);\n/* END VAPT RISK-070 */",
        "begin_marker": "/* BEGIN VAPT RISK-070 */",
        "end_marker": "/* END VAPT RISK-070 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get FORCE_SSL_LOGIN",
          "expected": "true"
        },
        "rollback": "wp config delete FORCE_SSL_LOGIN",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-070 */\ndefine('FORCE_SSL_LOGIN', true);\n/* END VAPT RISK-070 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-070 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-071": {
      "risk_id": "RISK-071",
      "title": "Cookie Domain Not Set",
      "category": "Configuration",
      "severity": "medium",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "COOKIE_DOMAIN"
        ],
        "target_values": [
          "example.com"
        ],
        "target_constant": "COOKIE_DOMAIN",
        "target_value": "example.com",
        "value_type": "string",
        "code": "define('COOKIE_DOMAIN', 'example.com');",
        "wrapped_code": "/* BEGIN VAPT RISK-071 */\ndefine('COOKIE_DOMAIN', 'example.com');\n/* END VAPT RISK-071 */",
        "begin_marker": "/* BEGIN VAPT RISK-071 */",
        "end_marker": "/* END VAPT RISK-071 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get COOKIE_DOMAIN",
          "expected": "example.com"
        },
        "rollback": "wp config delete COOKIE_DOMAIN",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-071 */\ndefine('COOKIE_DOMAIN', 'example.com');\n/* END VAPT RISK-071 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-071 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-072": {
      "risk_id": "RISK-072",
      "title": "Cookie Path Not Restricted",
      "category": "Configuration",
      "severity": "medium",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "COOKIEPATH"
        ],
        "target_values": [
          "/"
        ],
        "target_constant": "COOKIEPATH",
        "target_value": "/",
        "value_type": "string",
        "code": "define('COOKIEPATH', '/');",
        "wrapped_code": "/* BEGIN VAPT RISK-072 */\ndefine('COOKIEPATH', '/');\n/* END VAPT RISK-072 */",
        "begin_marker": "/* BEGIN VAPT RISK-072 */",
        "end_marker": "/* END VAPT RISK-072 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get COOKIEPATH",
          "expected": "/"
        },
        "rollback": "wp config delete COOKIEPATH",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-072 */\ndefine('COOKIEPATH', '/');\n/* END VAPT RISK-072 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-072 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-073": {
      "risk_id": "RISK-073",
      "title": "Trash Auto-Delete Not Configured",
      "category": "Configuration",
      "severity": "low",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "EMPTY_TRASH_DAYS"
        ],
        "target_values": [
          "7"
        ],
        "target_constant": "EMPTY_TRASH_DAYS",
        "target_value": "7",
        "value_type": "string",
        "code": "define('EMPTY_TRASH_DAYS', 7);",
        "wrapped_code": "/* BEGIN VAPT RISK-073 */\ndefine('EMPTY_TRASH_DAYS', 7);\n/* END VAPT RISK-073 */",
        "begin_marker": "/* BEGIN VAPT RISK-073 */",
        "end_marker": "/* END VAPT RISK-073 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get EMPTY_TRASH_DAYS",
          "expected": "7"
        },
        "rollback": "wp config delete EMPTY_TRASH_DAYS",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-073 */\ndefine('EMPTY_TRASH_DAYS', 7);\n/* END VAPT RISK-073 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-073 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-074": {
      "risk_id": "RISK-074",
      "title": "Post Revisions Unlimited",
      "category": "Configuration",
      "severity": "low",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "WP_POST_REVISIONS"
        ],
        "target_values": [
          "5"
        ],
        "target_constant": "WP_POST_REVISIONS",
        "target_value": "5",
        "value_type": "string",
        "code": "define('WP_POST_REVISIONS', 5);",
        "wrapped_code": "/* BEGIN VAPT RISK-074 */\ndefine('WP_POST_REVISIONS', 5);\n/* END VAPT RISK-074 */",
        "begin_marker": "/* BEGIN VAPT RISK-074 */",
        "end_marker": "/* END VAPT RISK-074 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get WP_POST_REVISIONS",
          "expected": "5"
        },
        "rollback": "wp config delete WP_POST_REVISIONS",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-074 */\ndefine('WP_POST_REVISIONS', 5);\n/* END VAPT RISK-074 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-074 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-075": {
      "risk_id": "RISK-075",
      "title": "Autosave Interval Too Long",
      "category": "Configuration",
      "severity": "low",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "AUTOSAVE_INTERVAL"
        ],
        "target_values": [
          "60"
        ],
        "target_constant": "AUTOSAVE_INTERVAL",
        "target_value": "60",
        "value_type": "string",
        "code": "define('AUTOSAVE_INTERVAL', 60);",
        "wrapped_code": "/* BEGIN VAPT RISK-075 */\ndefine('AUTOSAVE_INTERVAL', 60);\n/* END VAPT RISK-075 */",
        "begin_marker": "/* BEGIN VAPT RISK-075 */",
        "end_marker": "/* END VAPT RISK-075 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get AUTOSAVE_INTERVAL",
          "expected": "60"
        },
        "rollback": "wp config delete AUTOSAVE_INTERVAL",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-075 */\ndefine('AUTOSAVE_INTERVAL', 60);\n/* END VAPT RISK-075 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-075 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-076": {
      "risk_id": "RISK-076",
      "title": "Memory Limit Too Low",
      "category": "Configuration",
      "severity": "medium",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "WP_MEMORY_LIMIT"
        ],
        "target_values": [
          "256M"
        ],
        "target_constant": "WP_MEMORY_LIMIT",
        "target_value": "256M",
        "value_type": "string",
        "code": "define('WP_MEMORY_LIMIT', '256M');",
        "wrapped_code": "/* BEGIN VAPT RISK-076 */\ndefine('WP_MEMORY_LIMIT', '256M');\n/* END VAPT RISK-076 */",
        "begin_marker": "/* BEGIN VAPT RISK-076 */",
        "end_marker": "/* END VAPT RISK-076 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get WP_MEMORY_LIMIT",
          "expected": "256M"
        },
        "rollback": "wp config delete WP_MEMORY_LIMIT",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-076 */\ndefine('WP_MEMORY_LIMIT', '256M');\n/* END VAPT RISK-076 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-076 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-077": {
      "risk_id": "RISK-077",
      "title": "Max Memory Limit Not Set",
      "category": "Configuration",
      "severity": "medium",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "WP_MAX_MEMORY_LIMIT"
        ],
        "target_values": [
          "512M"
        ],
        "target_constant": "WP_MAX_MEMORY_LIMIT",
        "target_value": "512M",
        "value_type": "string",
        "code": "define('WP_MAX_MEMORY_LIMIT', '512M');",
        "wrapped_code": "/* BEGIN VAPT RISK-077 */\ndefine('WP_MAX_MEMORY_LIMIT', '512M');\n/* END VAPT RISK-077 */",
        "begin_marker": "/* BEGIN VAPT RISK-077 */",
        "end_marker": "/* END VAPT RISK-077 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get WP_MAX_MEMORY_LIMIT",
          "expected": "512M"
        },
        "rollback": "wp config delete WP_MAX_MEMORY_LIMIT",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-077 */\ndefine('WP_MAX_MEMORY_LIMIT', '512M');\n/* END VAPT RISK-077 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-077 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-078": {
      "risk_id": "RISK-078",
      "title": "Table Prefix Default",
      "category": "Configuration",
      "severity": "high",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "variable_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "table_prefix"
        ],
        "target_values": [
          "wp_x7k9m2_"
        ],
        "target_constant": "table_prefix",
        "target_value": "wp_x7k9m2_",
        "value_type": "string",
        "code": "$table_prefix = 'wp_x7k9m2_';",
        "wrapped_code": "/* BEGIN VAPT RISK-078 */\n$table_prefix = 'wp_x7k9m2_';\n/* END VAPT RISK-078 */",
        "begin_marker": "/* BEGIN VAPT RISK-078 */",
        "end_marker": "/* END VAPT RISK-078 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get table_prefix",
          "expected": "wp_x7k9m2_"
        },
        "rollback": "wp config delete table_prefix",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-078 */\n$table_prefix = 'wp_x7k9m2_';\n/* END VAPT RISK-078 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-078 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-079": {
      "risk_id": "RISK-079",
      "title": "Database Host Exposed",
      "category": "Configuration",
      "severity": "medium",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "DB_HOST"
        ],
        "target_values": [
          "getenv('DB_HOST"
        ],
        "target_constant": "DB_HOST",
        "target_value": "getenv('DB_HOST",
        "value_type": "string",
        "code": "define('DB_HOST', getenv('DB_HOST') ?: 'localhost');",
        "wrapped_code": "/* BEGIN VAPT RISK-079 */\ndefine('DB_HOST', getenv('DB_HOST') ?: 'localhost');\n/* END VAPT RISK-079 */",
        "begin_marker": "/* BEGIN VAPT RISK-079 */",
        "end_marker": "/* END VAPT RISK-079 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get DB_HOST",
          "expected": "getenv('DB_HOST"
        },
        "rollback": "wp config delete DB_HOST",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-079 */\ndefine('DB_HOST', getenv('DB_HOST') ?: 'localhost');\n/* END VAPT RISK-079 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-079 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-080": {
      "risk_id": "RISK-080",
      "title": "Custom User Table Not Defined",
      "category": "Configuration",
      "severity": "low",
      "wp_config": {
        "enforcer": "wp-config.php",
        "operation": "constant_exists",
        "target_file": "wp-config.php",
        "insertion_point": "before_wp_settings",
        "anchor": {
          "search": "require_once ABSPATH",
          "position": "before",
          "fallback": "append"
        },
        "target_constants": [
          "CUSTOM_USER_TABLE"
        ],
        "target_values": [
          "custom_users"
        ],
        "target_constant": "CUSTOM_USER_TABLE",
        "target_value": "custom_users",
        "value_type": "string",
        "code": "define('CUSTOM_USER_TABLE', 'custom_users');",
        "wrapped_code": "/* BEGIN VAPT RISK-080 */\ndefine('CUSTOM_USER_TABLE', 'custom_users');\n/* END VAPT RISK-080 */",
        "begin_marker": "/* BEGIN VAPT RISK-080 */",
        "end_marker": "/* END VAPT RISK-080 */",
        "insertion_rule": "Must be placed BEFORE: require_once ABSPATH . 'wp-settings.php';",
        "verification": {
          "command": "wp config get CUSTOM_USER_TABLE",
          "expected": "custom_users"
        },
        "rollback": "wp config delete CUSTOM_USER_TABLE",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "write_block": "/* BEGIN VAPT RISK-080 */\ndefine('CUSTOM_USER_TABLE', 'custom_users');\n/* END VAPT RISK-080 */",
          "anchor_string": "require_once ABSPATH",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "/* BEGIN VAPT RISK-080 */",
          "if_found": "skip"
        }
      }
    },
    "RISK-081": {
      "risk_id": "RISK-081",
      "title": "XML-RPC Brute Force Not Blocked",
      "category": "Authentication",
      "severity": "high",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-xmlrpc",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-xmlrpc]\nenabled = true\nport = http,https\nfilter = wordpress-xmlrpc\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-081\n[wordpress-xmlrpc]\nenabled = true\nport = http,https\nfilter = wordpress-xmlrpc\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-081",
        "begin_marker": "# BEGIN VAPT RISK-081",
        "end_marker": "# END VAPT RISK-081",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-081...# END VAPT RISK-081 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-081\n[wordpress-xmlrpc]\nenabled = true\nport = http,https\nfilter = wordpress-xmlrpc\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-081",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-081",
          "if_found": "skip"
        }
      }
    },
    "RISK-082": {
      "risk_id": "RISK-082",
      "title": "WP-Admin Brute Force Not Blocked",
      "category": "Authentication",
      "severity": "high",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-admin",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-admin]\nenabled = true\nport = http,https\nfilter = wordpress-admin\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-082\n[wordpress-admin]\nenabled = true\nport = http,https\nfilter = wordpress-admin\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600\n# END VAPT RISK-082",
        "begin_marker": "# BEGIN VAPT RISK-082",
        "end_marker": "# END VAPT RISK-082",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-082...# END VAPT RISK-082 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-082\n[wordpress-admin]\nenabled = true\nport = http,https\nfilter = wordpress-admin\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600\n# END VAPT RISK-082",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-082",
          "if_found": "skip"
        }
      }
    },
    "RISK-083": {
      "risk_id": "RISK-083",
      "title": "404 Exploit Scanning Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-404",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-404]\nenabled = true\nport = http,https\nfilter = wordpress-404\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 1800",
        "wrapped_code": "# BEGIN VAPT RISK-083\n[wordpress-404]\nenabled = true\nport = http,https\nfilter = wordpress-404\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 1800\n# END VAPT RISK-083",
        "begin_marker": "# BEGIN VAPT RISK-083",
        "end_marker": "# END VAPT RISK-083",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-083...# END VAPT RISK-083 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-083\n[wordpress-404]\nenabled = true\nport = http,https\nfilter = wordpress-404\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 1800\n# END VAPT RISK-083",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-083",
          "if_found": "skip"
        }
      }
    },
    "RISK-084": {
      "risk_id": "RISK-084",
      "title": "Comment Spam Not Rate Limited",
      "category": "Configuration",
      "severity": "medium",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-comments",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-comments]\nenabled = true\nport = http,https\nfilter = wordpress-comments\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-084\n[wordpress-comments]\nenabled = true\nport = http,https\nfilter = wordpress-comments\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600\n# END VAPT RISK-084",
        "begin_marker": "# BEGIN VAPT RISK-084",
        "end_marker": "# END VAPT RISK-084",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-084...# END VAPT RISK-084 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-084\n[wordpress-comments]\nenabled = true\nport = http,https\nfilter = wordpress-comments\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600\n# END VAPT RISK-084",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-084",
          "if_found": "skip"
        }
      }
    },
    "RISK-085": {
      "risk_id": "RISK-085",
      "title": "Registration Spam Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-register",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-register]\nenabled = true\nport = http,https\nfilter = wordpress-register\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-085\n[wordpress-register]\nenabled = true\nport = http,https\nfilter = wordpress-register\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-085",
        "begin_marker": "# BEGIN VAPT RISK-085",
        "end_marker": "# END VAPT RISK-085",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-085...# END VAPT RISK-085 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-085\n[wordpress-register]\nenabled = true\nport = http,https\nfilter = wordpress-register\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-085",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-085",
          "if_found": "skip"
        }
      }
    },
    "RISK-086": {
      "risk_id": "RISK-086",
      "title": "REST API Abuse Not Blocked",
      "category": "API Security",
      "severity": "medium",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-rest",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-rest]\nenabled = true\nport = http,https\nfilter = wordpress-rest\nlogpath = /var/log/apache2/access.log\nmaxretry = 20\nbantime = 1800",
        "wrapped_code": "# BEGIN VAPT RISK-086\n[wordpress-rest]\nenabled = true\nport = http,https\nfilter = wordpress-rest\nlogpath = /var/log/apache2/access.log\nmaxretry = 20\nbantime = 1800\n# END VAPT RISK-086",
        "begin_marker": "# BEGIN VAPT RISK-086",
        "end_marker": "# END VAPT RISK-086",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-086...# END VAPT RISK-086 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-086\n[wordpress-rest]\nenabled = true\nport = http,https\nfilter = wordpress-rest\nlogpath = /var/log/apache2/access.log\nmaxretry = 20\nbantime = 1800\n# END VAPT RISK-086",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-086",
          "if_found": "skip"
        }
      }
    },
    "RISK-087": {
      "risk_id": "RISK-087",
      "title": "Password Reset Abuse Not Blocked",
      "category": "Authentication",
      "severity": "medium",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-reset",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-reset]\nenabled = true\nport = http,https\nfilter = wordpress-reset\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-087\n[wordpress-reset]\nenabled = true\nport = http,https\nfilter = wordpress-reset\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-087",
        "begin_marker": "# BEGIN VAPT RISK-087",
        "end_marker": "# END VAPT RISK-087",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-087...# END VAPT RISK-087 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-087\n[wordpress-reset]\nenabled = true\nport = http,https\nfilter = wordpress-reset\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-087",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-087",
          "if_found": "skip"
        }
      }
    },
    "RISK-088": {
      "risk_id": "RISK-088",
      "title": "File Upload Abuse Not Blocked",
      "category": "Configuration",
      "severity": "high",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-upload",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-upload]\nenabled = true\nport = http,https\nfilter = wordpress-upload\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-088\n[wordpress-upload]\nenabled = true\nport = http,https\nfilter = wordpress-upload\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 3600\n# END VAPT RISK-088",
        "begin_marker": "# BEGIN VAPT RISK-088",
        "end_marker": "# END VAPT RISK-088",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-088...# END VAPT RISK-088 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-088\n[wordpress-upload]\nenabled = true\nport = http,https\nfilter = wordpress-upload\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 3600\n# END VAPT RISK-088",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-088",
          "if_found": "skip"
        }
      }
    },
    "RISK-089": {
      "risk_id": "RISK-089",
      "title": "Search Query Abuse Not Blocked",
      "category": "Configuration",
      "severity": "low",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-search",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-search]\nenabled = true\nport = http,https\nfilter = wordpress-search\nlogpath = /var/log/apache2/access.log\nmaxretry = 15\nbantime = 1800",
        "wrapped_code": "# BEGIN VAPT RISK-089\n[wordpress-search]\nenabled = true\nport = http,https\nfilter = wordpress-search\nlogpath = /var/log/apache2/access.log\nmaxretry = 15\nbantime = 1800\n# END VAPT RISK-089",
        "begin_marker": "# BEGIN VAPT RISK-089",
        "end_marker": "# END VAPT RISK-089",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-089...# END VAPT RISK-089 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-089\n[wordpress-search]\nenabled = true\nport = http,https\nfilter = wordpress-search\nlogpath = /var/log/apache2/access.log\nmaxretry = 15\nbantime = 1800\n# END VAPT RISK-089",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-089",
          "if_found": "skip"
        }
      }
    },
    "RISK-090": {
      "risk_id": "RISK-090",
      "title": "Bot Traffic Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-badbots",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-badbots]\nenabled = true\nport = http,https\nfilter = wordpress-badbots\nlogpath = /var/log/apache2/access.log\nmaxretry = 1\nbantime = 86400",
        "wrapped_code": "# BEGIN VAPT RISK-090\n[wordpress-badbots]\nenabled = true\nport = http,https\nfilter = wordpress-badbots\nlogpath = /var/log/apache2/access.log\nmaxretry = 1\nbantime = 86400\n# END VAPT RISK-090",
        "begin_marker": "# BEGIN VAPT RISK-090",
        "end_marker": "# END VAPT RISK-090",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-090...# END VAPT RISK-090 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-090\n[wordpress-badbots]\nenabled = true\nport = http,https\nfilter = wordpress-badbots\nlogpath = /var/log/apache2/access.log\nmaxretry = 1\nbantime = 86400\n# END VAPT RISK-090",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-090",
          "if_found": "skip"
        }
      }
    },
    "RISK-091": {
      "risk_id": "RISK-091",
      "title": "HTTP Method Abuse Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-methods",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-methods]\nenabled = true\nport = http,https\nfilter = wordpress-methods\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-091\n[wordpress-methods]\nenabled = true\nport = http,https\nfilter = wordpress-methods\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600\n# END VAPT RISK-091",
        "begin_marker": "# BEGIN VAPT RISK-091",
        "end_marker": "# END VAPT RISK-091",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-091...# END VAPT RISK-091 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-091\n[wordpress-methods]\nenabled = true\nport = http,https\nfilter = wordpress-methods\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600\n# END VAPT RISK-091",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-091",
          "if_found": "skip"
        }
      }
    },
    "RISK-092": {
      "risk_id": "RISK-092",
      "title": "User Agent Abuse Not Blocked",
      "category": "Configuration",
      "severity": "low",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-useragent",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-useragent]\nenabled = true\nport = http,https\nfilter = wordpress-useragent\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-092\n[wordpress-useragent]\nenabled = true\nport = http,https\nfilter = wordpress-useragent\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-092",
        "begin_marker": "# BEGIN VAPT RISK-092",
        "end_marker": "# END VAPT RISK-092",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-092...# END VAPT RISK-092 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-092\n[wordpress-useragent]\nenabled = true\nport = http,https\nfilter = wordpress-useragent\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-092",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-092",
          "if_found": "skip"
        }
      }
    },
    "RISK-093": {
      "risk_id": "RISK-093",
      "title": "XML-RPC Pingback Abuse Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-pingback",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-pingback]\nenabled = true\nport = http,https\nfilter = wordpress-pingback\nlogpath = /var/log/apache2/access.log\nmaxretry = 2\nbantime = 86400",
        "wrapped_code": "# BEGIN VAPT RISK-093\n[wordpress-pingback]\nenabled = true\nport = http,https\nfilter = wordpress-pingback\nlogpath = /var/log/apache2/access.log\nmaxretry = 2\nbantime = 86400\n# END VAPT RISK-093",
        "begin_marker": "# BEGIN VAPT RISK-093",
        "end_marker": "# END VAPT RISK-093",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-093...# END VAPT RISK-093 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-093\n[wordpress-pingback]\nenabled = true\nport = http,https\nfilter = wordpress-pingback\nlogpath = /var/log/apache2/access.log\nmaxretry = 2\nbantime = 86400\n# END VAPT RISK-093",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-093",
          "if_found": "skip"
        }
      }
    },
    "RISK-094": {
      "risk_id": "RISK-094",
      "title": "WooCommerce Login Not Protected",
      "category": "Authentication",
      "severity": "high",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "woocommerce-login",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[woocommerce-login]\nenabled = true\nport = http,https\nfilter = woocommerce-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
        "wrapped_code": "# BEGIN VAPT RISK-094\n[woocommerce-login]\nenabled = true\nport = http,https\nfilter = woocommerce-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-094",
        "begin_marker": "# BEGIN VAPT RISK-094",
        "end_marker": "# END VAPT RISK-094",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-094...# END VAPT RISK-094 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-094\n[woocommerce-login]\nenabled = true\nport = http,https\nfilter = woocommerce-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-094",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-094",
          "if_found": "skip"
        }
      }
    },
    "RISK-095": {
      "risk_id": "RISK-095",
      "title": "Long Duration Attacks Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "fail2ban": {
        "enforcer": "fail2ban",
        "operation": "service_restart",
        "target_file": "fail2ban",
        "insertion_point": "wordpress-slow",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "[wordpress-slow]\nenabled = true\nport = http,https\nfilter = wordpress-slow\nlogpath = /var/log/apache2/access.log\nfindtime = 86400\nmaxretry = 10\nbantime = 86400",
        "wrapped_code": "# BEGIN VAPT RISK-095\n[wordpress-slow]\nenabled = true\nport = http,https\nfilter = wordpress-slow\nlogpath = /var/log/apache2/access.log\nfindtime = 86400\nmaxretry = 10\nbantime = 86400\n# END VAPT RISK-095",
        "begin_marker": "# BEGIN VAPT RISK-095",
        "end_marker": "# END VAPT RISK-095",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-095...# END VAPT RISK-095 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "write_block": "# BEGIN VAPT RISK-095\n[wordpress-slow]\nenabled = true\nport = http,https\nfilter = wordpress-slow\nlogpath = /var/log/apache2/access.log\nfindtime = 86400\nmaxretry = 10\nbantime = 86400\n# END VAPT RISK-095",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-095",
          "if_found": "skip"
        }
      }
    },
    "RISK-096": {
      "risk_id": "RISK-096",
      "title": "WordPress Cron Not Replaced with Server Cron",
      "category": "Configuration",
      "severity": "high",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "wp_cron",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "*/5 * * * * curl -s https://site.com/wp-cron.php?doing_wp_cron > /dev/null 2>&1",
        "wrapped_code": "# BEGIN VAPT RISK-096\n*/5 * * * * curl -s https://site.com/wp-cron.php?doing_wp_cron > /dev/null 2>&1\n# END VAPT RISK-096",
        "begin_marker": "# BEGIN VAPT RISK-096",
        "end_marker": "# END VAPT RISK-096",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-096...# END VAPT RISK-096 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-096\n*/5 * * * * curl -s https://site.com/wp-cron.php?doing_wp_cron > /dev/null 2>&1\n# END VAPT RISK-096",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-096",
          "if_found": "skip"
        }
      }
    },
    "RISK-097": {
      "risk_id": "RISK-097",
      "title": "No Automated Backup Schedule",
      "category": "Configuration",
      "severity": "high",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "wp_backup",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "0 2 * * * /usr/local/bin/wp-backup.sh > /var/log/wp-backup.log 2>&1",
        "wrapped_code": "# BEGIN VAPT RISK-097\n0 2 * * * /usr/local/bin/wp-backup.sh > /var/log/wp-backup.log 2>&1\n# END VAPT RISK-097",
        "begin_marker": "# BEGIN VAPT RISK-097",
        "end_marker": "# END VAPT RISK-097",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-097...# END VAPT RISK-097 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-097\n0 2 * * * /usr/local/bin/wp-backup.sh > /var/log/wp-backup.log 2>&1\n# END VAPT RISK-097",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-097",
          "if_found": "skip"
        }
      }
    },
    "RISK-098": {
      "risk_id": "RISK-098",
      "title": "No Security Scan Schedule",
      "category": "Configuration",
      "severity": "medium",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "wp_security_scan",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "0 3 * * 0 /usr/local/bin/wp-security-scan.sh > /var/log/wp-scan.log 2>&1",
        "wrapped_code": "# BEGIN VAPT RISK-098\n0 3 * * 0 /usr/local/bin/wp-security-scan.sh > /var/log/wp-scan.log 2>&1\n# END VAPT RISK-098",
        "begin_marker": "# BEGIN VAPT RISK-098",
        "end_marker": "# END VAPT RISK-098",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-098...# END VAPT RISK-098 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-098\n0 3 * * 0 /usr/local/bin/wp-security-scan.sh > /var/log/wp-scan.log 2>&1\n# END VAPT RISK-098",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-098",
          "if_found": "skip"
        }
      }
    },
    "RISK-099": {
      "risk_id": "RISK-099",
      "title": "No Log Rotation Configured",
      "category": "Configuration",
      "severity": "medium",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "wp_logrotate",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/wordpress",
        "wrapped_code": "# BEGIN VAPT RISK-099\n0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/wordpress\n# END VAPT RISK-099",
        "begin_marker": "# BEGIN VAPT RISK-099",
        "end_marker": "# END VAPT RISK-099",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-099...# END VAPT RISK-099 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-099\n0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/wordpress\n# END VAPT RISK-099",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-099",
          "if_found": "skip"
        }
      }
    },
    "RISK-100": {
      "risk_id": "RISK-100",
      "title": "No Plugin Update Schedule",
      "category": "Configuration",
      "severity": "high",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "wp_plugin_update",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "0 4 * * * cd /var/www/html && wp plugin update --all --allow-root > /var/log/wp-plugin-update.log 2>&1",
        "wrapped_code": "# BEGIN VAPT RISK-100\n0 4 * * * cd /var/www/html && wp plugin update --all --allow-root > /var/log/wp-plugin-update.log 2>&1\n# END VAPT RISK-100",
        "begin_marker": "# BEGIN VAPT RISK-100",
        "end_marker": "# END VAPT RISK-100",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-100...# END VAPT RISK-100 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-100\n0 4 * * * cd /var/www/html && wp plugin update --all --allow-root > /var/log/wp-plugin-update.log 2>&1\n# END VAPT RISK-100",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-100",
          "if_found": "skip"
        }
      }
    },
    "RISK-101": {
      "risk_id": "RISK-101",
      "title": "No Core Update Schedule",
      "category": "Configuration",
      "severity": "high",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "wp_core_update",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "0 5 * * * cd /var/www/html && wp core update --allow-root > /var/log/wp-core-update.log 2>&1",
        "wrapped_code": "# BEGIN VAPT RISK-101\n0 5 * * * cd /var/www/html && wp core update --allow-root > /var/log/wp-core-update.log 2>&1\n# END VAPT RISK-101",
        "begin_marker": "# BEGIN VAPT RISK-101",
        "end_marker": "# END VAPT RISK-101",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-101...# END VAPT RISK-101 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-101\n0 5 * * * cd /var/www/html && wp core update --allow-root > /var/log/wp-core-update.log 2>&1\n# END VAPT RISK-101",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-101",
          "if_found": "skip"
        }
      }
    },
    "RISK-102": {
      "risk_id": "RISK-102",
      "title": "No Database Optimization Schedule",
      "category": "Configuration",
      "severity": "low",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "wp_db_optimize",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "0 2 * * 0 cd /var/www/html && wp db optimize --allow-root > /var/log/wp-db-optimize.log 2>&1",
        "wrapped_code": "# BEGIN VAPT RISK-102\n0 2 * * 0 cd /var/www/html && wp db optimize --allow-root > /var/log/wp-db-optimize.log 2>&1\n# END VAPT RISK-102",
        "begin_marker": "# BEGIN VAPT RISK-102",
        "end_marker": "# END VAPT RISK-102",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-102...# END VAPT RISK-102 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-102\n0 2 * * 0 cd /var/www/html && wp db optimize --allow-root > /var/log/wp-db-optimize.log 2>&1\n# END VAPT RISK-102",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-102",
          "if_found": "skip"
        }
      }
    },
    "RISK-103": {
      "risk_id": "RISK-103",
      "title": "No Spam Cleanup Schedule",
      "category": "Configuration",
      "severity": "low",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "wp_spam_cleanup",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "0 1 * * * cd /var/www/html && wp comment delete --status=spam --allow-root > /var/log/wp-spam-cleanup.log 2>&1",
        "wrapped_code": "# BEGIN VAPT RISK-103\n0 1 * * * cd /var/www/html && wp comment delete --status=spam --allow-root > /var/log/wp-spam-cleanup.log 2>&1\n# END VAPT RISK-103",
        "begin_marker": "# BEGIN VAPT RISK-103",
        "end_marker": "# END VAPT RISK-103",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-103...# END VAPT RISK-103 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-103\n0 1 * * * cd /var/www/html && wp comment delete --status=spam --allow-root > /var/log/wp-spam-cleanup.log 2>&1\n# END VAPT RISK-103",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-103",
          "if_found": "skip"
        }
      }
    },
    "RISK-104": {
      "risk_id": "RISK-104",
      "title": "No Failed Login Log Rotation",
      "category": "Configuration",
      "severity": "low",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "fail2ban_logrotate",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/fail2ban",
        "wrapped_code": "# BEGIN VAPT RISK-104\n0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/fail2ban\n# END VAPT RISK-104",
        "begin_marker": "# BEGIN VAPT RISK-104",
        "end_marker": "# END VAPT RISK-104",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-104...# END VAPT RISK-104 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-104\n0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/fail2ban\n# END VAPT RISK-104",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-104",
          "if_found": "skip"
        }
      }
    },
    "RISK-105": {
      "risk_id": "RISK-105",
      "title": "No SSL Certificate Renewal",
      "category": "Configuration",
      "severity": "high",
      "server_cron": {
        "enforcer": "Server Cron",
        "operation": "cron_job_exists",
        "target_file": "Server Cron",
        "insertion_point": "ssl_renewal",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "0 0 1 * * /usr/bin/certbot renew --quiet --post-hook 'systemctl reload nginx'",
        "wrapped_code": "# BEGIN VAPT RISK-105\n0 0 1 * * /usr/bin/certbot renew --quiet --post-hook 'systemctl reload nginx'\n# END VAPT RISK-105",
        "begin_marker": "# BEGIN VAPT RISK-105",
        "end_marker": "# END VAPT RISK-105",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "crontab -l | grep vapt",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-105...# END VAPT RISK-105 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "write_block": "# BEGIN VAPT RISK-105\n0 0 1 * * /usr/bin/certbot renew --quiet --post-hook 'systemctl reload nginx'\n# END VAPT RISK-105",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-105",
          "if_found": "skip"
        }
      }
    },
    "RISK-106": {
      "risk_id": "RISK-106",
      "title": "Inactive Plugins Present",
      "category": "Configuration",
      "severity": "medium",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "hook_active",
        "target_file": "WordPress",
        "insertion_point": "inactive_plugins",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('admin_init', 'vapt_remove_inactive_plugins');",
        "wrapped_code": "// BEGIN VAPT RISK-106\nadd_action('admin_init', 'vapt_remove_inactive_plugins');\n// END VAPT RISK-106",
        "begin_marker": "// BEGIN VAPT RISK-106",
        "end_marker": "// END VAPT RISK-106",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-106...// END VAPT RISK-106 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-106\nadd_action('admin_init', 'vapt_remove_inactive_plugins');\n// END VAPT RISK-106",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-106",
          "if_found": "skip"
        }
      }
    },
    "RISK-107": {
      "risk_id": "RISK-107",
      "title": "Inactive Themes Present",
      "category": "Configuration",
      "severity": "medium",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "hook_active",
        "target_file": "WordPress",
        "insertion_point": "inactive_themes",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('admin_init', 'vapt_remove_inactive_themes');",
        "wrapped_code": "// BEGIN VAPT RISK-107\nadd_action('admin_init', 'vapt_remove_inactive_themes');\n// END VAPT RISK-107",
        "begin_marker": "// BEGIN VAPT RISK-107",
        "end_marker": "// END VAPT RISK-107",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-107...// END VAPT RISK-107 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-107\nadd_action('admin_init', 'vapt_remove_inactive_themes');\n// END VAPT RISK-107",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-107",
          "if_found": "skip"
        }
      }
    },
    "RISK-108": {
      "risk_id": "RISK-108",
      "title": "Default Theme Not Deleted",
      "category": "Configuration",
      "severity": "low",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "hook_active",
        "target_file": "WordPress",
        "insertion_point": "default_themes",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('admin_init', 'vapt_remove_default_themes');",
        "wrapped_code": "// BEGIN VAPT RISK-108\nadd_action('admin_init', 'vapt_remove_default_themes');\n// END VAPT RISK-108",
        "begin_marker": "// BEGIN VAPT RISK-108",
        "end_marker": "// END VAPT RISK-108",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-108...// END VAPT RISK-108 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-108\nadd_action('admin_init', 'vapt_remove_default_themes');\n// END VAPT RISK-108",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-108",
          "if_found": "skip"
        }
      }
    },
    "RISK-109": {
      "risk_id": "RISK-109",
      "title": "Hello Dolly Plugin Active",
      "category": "Configuration",
      "severity": "low",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "hook_active",
        "target_file": "WordPress",
        "insertion_point": "hello_dolly",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_action('admin_init', 'vapt_remove_hello_dolly');",
        "wrapped_code": "// BEGIN VAPT RISK-109\nadd_action('admin_init', 'vapt_remove_hello_dolly');\n// END VAPT RISK-109",
        "begin_marker": "// BEGIN VAPT RISK-109",
        "end_marker": "// END VAPT RISK-109",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-109...// END VAPT RISK-109 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-109\nadd_action('admin_init', 'vapt_remove_hello_dolly');\n// END VAPT RISK-109",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-109",
          "if_found": "skip"
        }
      }
    },
    "RISK-110": {
      "risk_id": "RISK-110",
      "title": "WordPress Version Publicly Visible",
      "category": "Information Disclosure",
      "severity": "low",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "filter_applied",
        "target_file": "WordPress",
        "insertion_point": "version_generator",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "add_filter('the_generator', '__return_empty_string');",
        "wrapped_code": "// BEGIN VAPT RISK-110\nadd_filter('the_generator', '__return_empty_string');\n// END VAPT RISK-110",
        "begin_marker": "// BEGIN VAPT RISK-110",
        "end_marker": "// END VAPT RISK-110",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-110...// END VAPT RISK-110 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-110\nadd_filter('the_generator', '__return_empty_string');\n// END VAPT RISK-110",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-110",
          "if_found": "skip"
        }
      }
    },
    "RISK-111": {
      "risk_id": "RISK-111",
      "title": "Emoji Scripts Loaded",
      "category": "Configuration",
      "severity": "low",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "hook_removed",
        "target_file": "WordPress",
        "insertion_point": "emoji_scripts",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "remove_action('wp_head', 'print_emoji_detection_script', 7); remove_action('wp_print_styles', 'print_emoji_styles');",
        "wrapped_code": "// BEGIN VAPT RISK-111\nremove_action('wp_head', 'print_emoji_detection_script', 7); remove_action('wp_print_styles', 'print_emoji_styles');\n// END VAPT RISK-111",
        "begin_marker": "// BEGIN VAPT RISK-111",
        "end_marker": "// END VAPT RISK-111",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-111...// END VAPT RISK-111 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-111\nremove_action('wp_head', 'print_emoji_detection_script', 7); remove_action('wp_print_styles', 'print_emoji_styles');\n// END VAPT RISK-111",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-111",
          "if_found": "skip"
        }
      }
    },
    "RISK-112": {
      "risk_id": "RISK-112",
      "title": "oEmbed Discovery Enabled",
      "category": "Configuration",
      "severity": "low",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "hook_removed",
        "target_file": "WordPress",
        "insertion_point": "oembed_discovery",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "remove_action('wp_head', 'wp_oembed_add_discovery_links');",
        "wrapped_code": "// BEGIN VAPT RISK-112\nremove_action('wp_head', 'wp_oembed_add_discovery_links');\n// END VAPT RISK-112",
        "begin_marker": "// BEGIN VAPT RISK-112",
        "end_marker": "// END VAPT RISK-112",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-112...// END VAPT RISK-112 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-112\nremove_action('wp_head', 'wp_oembed_add_discovery_links');\n// END VAPT RISK-112",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-112",
          "if_found": "skip"
        }
      }
    },
    "RISK-113": {
      "risk_id": "RISK-113",
      "title": "RSD Link Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "hook_removed",
        "target_file": "WordPress",
        "insertion_point": "rsd_link",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "remove_action('wp_head', 'rsd_link');",
        "wrapped_code": "// BEGIN VAPT RISK-113\nremove_action('wp_head', 'rsd_link');\n// END VAPT RISK-113",
        "begin_marker": "// BEGIN VAPT RISK-113",
        "end_marker": "// END VAPT RISK-113",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-113...// END VAPT RISK-113 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-113\nremove_action('wp_head', 'rsd_link');\n// END VAPT RISK-113",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-113",
          "if_found": "skip"
        }
      }
    },
    "RISK-114": {
      "risk_id": "RISK-114",
      "title": "WLWManifest Link Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "hook_removed",
        "target_file": "WordPress",
        "insertion_point": "wlwmanifest",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "remove_action('wp_head', 'wlwmanifest_link');",
        "wrapped_code": "// BEGIN VAPT RISK-114\nremove_action('wp_head', 'wlwmanifest_link');\n// END VAPT RISK-114",
        "begin_marker": "// BEGIN VAPT RISK-114",
        "end_marker": "// END VAPT RISK-114",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-114...// END VAPT RISK-114 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-114\nremove_action('wp_head', 'wlwmanifest_link');\n// END VAPT RISK-114",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-114",
          "if_found": "skip"
        }
      }
    },
    "RISK-115": {
      "risk_id": "RISK-115",
      "title": "Shortlink Header Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "wordpress": {
        "enforcer": "WordPress",
        "operation": "hook_removed",
        "target_file": "WordPress",
        "insertion_point": "shortlink",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "remove_action('wp_head', 'wp_shortlink_wp_head');",
        "wrapped_code": "// BEGIN VAPT RISK-115\nremove_action('wp_head', 'wp_shortlink_wp_head');\n// END VAPT RISK-115",
        "begin_marker": "// BEGIN VAPT RISK-115",
        "end_marker": "// END VAPT RISK-115",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "wp plugin list",
          "expected": "No errors"
        },
        "rollback": "Remove // BEGIN VAPT RISK-115...// END VAPT RISK-115 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "write_block": "// BEGIN VAPT RISK-115\nremove_action('wp_head', 'wp_shortlink_wp_head');\n// END VAPT RISK-115",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "// BEGIN VAPT RISK-115",
          "if_found": "skip"
        }
      }
    },
    "RISK-116": {
      "risk_id": "RISK-116",
      "title": "Nginx Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "nginx": {
        "enforcer": "Nginx",
        "operation": "configtest_pass",
        "target_file": "Nginx",
        "insertion_point": "server_tokens",
        "anchor": {
          "search": "server_tokens",
          "position": "before",
          "fallback": "append"
        },
        "code": "server_tokens off;",
        "wrapped_code": "# BEGIN VAPT RISK-116\nserver_tokens off;\n# END VAPT RISK-116",
        "begin_marker": "# BEGIN VAPT RISK-116",
        "end_marker": "# END VAPT RISK-116",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "nginx -t && nginx -s reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-116...# END VAPT RISK-116 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "write_block": "# BEGIN VAPT RISK-116\nserver_tokens off;\n# END VAPT RISK-116",
          "anchor_string": "server_tokens",
          "anchor_position": "before",
          "fallback": "append",
          "idempotency_check": "# BEGIN VAPT RISK-116",
          "if_found": "skip"
        }
      }
    },
    "RISK-117": {
      "risk_id": "RISK-117",
      "title": "Apache Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "apache": {
        "enforcer": "Apache",
        "operation": "configtest_pass",
        "target_file": "Apache",
        "insertion_point": "ServerTokens",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "ServerTokens Prod\nServerSignature Off",
        "wrapped_code": "# BEGIN VAPT RISK-117\nServerTokens Prod\nServerSignature Off\n# END VAPT RISK-117",
        "begin_marker": "# BEGIN VAPT RISK-117",
        "end_marker": "# END VAPT RISK-117",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "apachectl -t && service apache2 reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-117...# END VAPT RISK-117 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/apache2/conf-available/vapt-security.conf",
          "write_block": "# BEGIN VAPT RISK-117\nServerTokens Prod\nServerSignature Off\n# END VAPT RISK-117",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-117",
          "if_found": "skip"
        }
      }
    },
    "RISK-118": {
      "risk_id": "RISK-118",
      "title": "Nginx Buffer Size Misconfigured",
      "category": "Configuration",
      "severity": "medium",
      "nginx": {
        "enforcer": "Nginx",
        "operation": "configtest_pass",
        "target_file": "Nginx",
        "insertion_point": "buffer_size",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "client_body_buffer_size 10M;\nclient_header_buffer_size 1k;\nlarge_client_header_buffers 4 8k;",
        "wrapped_code": "# BEGIN VAPT RISK-118\nclient_body_buffer_size 10M;\nclient_header_buffer_size 1k;\nlarge_client_header_buffers 4 8k;\n# END VAPT RISK-118",
        "begin_marker": "# BEGIN VAPT RISK-118",
        "end_marker": "# END VAPT RISK-118",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "nginx -t && nginx -s reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-118...# END VAPT RISK-118 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "write_block": "# BEGIN VAPT RISK-118\nclient_body_buffer_size 10M;\nclient_header_buffer_size 1k;\nlarge_client_header_buffers 4 8k;\n# END VAPT RISK-118",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-118",
          "if_found": "skip"
        }
      }
    },
    "RISK-119": {
      "risk_id": "RISK-119",
      "title": "Nginx Timeout Not Configured",
      "category": "Configuration",
      "severity": "medium",
      "nginx": {
        "enforcer": "Nginx",
        "operation": "configtest_pass",
        "target_file": "Nginx",
        "insertion_point": "timeout",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "client_body_timeout 10s;\nclient_header_timeout 10s;\nkeepalive_timeout 30s;\nsend_timeout 10s;",
        "wrapped_code": "# BEGIN VAPT RISK-119\nclient_body_timeout 10s;\nclient_header_timeout 10s;\nkeepalive_timeout 30s;\nsend_timeout 10s;\n# END VAPT RISK-119",
        "begin_marker": "# BEGIN VAPT RISK-119",
        "end_marker": "# END VAPT RISK-119",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "nginx -t && nginx -s reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-119...# END VAPT RISK-119 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "write_block": "# BEGIN VAPT RISK-119\nclient_body_timeout 10s;\nclient_header_timeout 10s;\nkeepalive_timeout 30s;\nsend_timeout 10s;\n# END VAPT RISK-119",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-119",
          "if_found": "skip"
        }
      }
    },
    "RISK-120": {
      "risk_id": "RISK-120",
      "title": "Nginx Rate Limiting Not Configured",
      "category": "Configuration",
      "severity": "high",
      "nginx": {
        "enforcer": "Nginx",
        "operation": "configtest_pass",
        "target_file": "Nginx",
        "insertion_point": "rate_limit",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "limit_req_zone $binary_remote_addr zone=one:10m rate=1r/s;\nlimit_req zone=one burst=5 nodelay;",
        "wrapped_code": "# BEGIN VAPT RISK-120\nlimit_req_zone $binary_remote_addr zone=one:10m rate=1r/s;\nlimit_req zone=one burst=5 nodelay;\n# END VAPT RISK-120",
        "begin_marker": "# BEGIN VAPT RISK-120",
        "end_marker": "# END VAPT RISK-120",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "nginx -t && nginx -s reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-120...# END VAPT RISK-120 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "write_block": "# BEGIN VAPT RISK-120\nlimit_req_zone $binary_remote_addr zone=one:10m rate=1r/s;\nlimit_req zone=one burst=5 nodelay;\n# END VAPT RISK-120",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-120",
          "if_found": "skip"
        }
      }
    },
    "RISK-121": {
      "risk_id": "RISK-121",
      "title": "Apache ModSecurity Not Enabled",
      "category": "Configuration",
      "severity": "high",
      "apache": {
        "enforcer": "Apache",
        "operation": "configtest_pass",
        "target_file": "Apache",
        "insertion_point": "modsecurity",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "LoadModule security2_module modules/mod_security2.so\nInclude modsecurity.d/*.conf",
        "wrapped_code": "# BEGIN VAPT RISK-121\nLoadModule security2_module modules/mod_security2.so\nInclude modsecurity.d/*.conf\n# END VAPT RISK-121",
        "begin_marker": "# BEGIN VAPT RISK-121",
        "end_marker": "# END VAPT RISK-121",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "apachectl -t && service apache2 reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-121...# END VAPT RISK-121 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/apache2/conf-available/vapt-security.conf",
          "write_block": "# BEGIN VAPT RISK-121\nLoadModule security2_module modules/mod_security2.so\nInclude modsecurity.d/*.conf\n# END VAPT RISK-121",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-121",
          "if_found": "skip"
        }
      }
    },
    "RISK-122": {
      "risk_id": "RISK-122",
      "title": "Nginx Gzip Compression Not Configured",
      "category": "Configuration",
      "severity": "low",
      "nginx": {
        "enforcer": "Nginx",
        "operation": "configtest_pass",
        "target_file": "Nginx",
        "insertion_point": "gzip",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "gzip on;\ngzip_types text/plain text/css application/json application/javascript;",
        "wrapped_code": "# BEGIN VAPT RISK-122\ngzip on;\ngzip_types text/plain text/css application/json application/javascript;\n# END VAPT RISK-122",
        "begin_marker": "# BEGIN VAPT RISK-122",
        "end_marker": "# END VAPT RISK-122",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "nginx -t && nginx -s reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-122...# END VAPT RISK-122 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "write_block": "# BEGIN VAPT RISK-122\ngzip on;\ngzip_types text/plain text/css application/json application/javascript;\n# END VAPT RISK-122",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-122",
          "if_found": "skip"
        }
      }
    },
    "RISK-123": {
      "risk_id": "RISK-123",
      "title": "Caddy Server Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "caddy_native": {
        "enforcer": "Caddy",
        "operation": "configtest_pass",
        "target_file": "Caddy",
        "insertion_point": "Server",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "header -Server",
        "wrapped_code": "# BEGIN VAPT RISK-123\nheader -Server\n# END VAPT RISK-123",
        "begin_marker": "# BEGIN VAPT RISK-123",
        "end_marker": "# END VAPT RISK-123",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "caddy validate --config /etc/caddy/Caddyfile && caddy reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-123...# END VAPT RISK-123 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/caddy/Caddyfile",
          "write_block": "# BEGIN VAPT RISK-123\nheader -Server\n# END VAPT RISK-123",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-123",
          "if_found": "skip"
        }
      }
    },
    "RISK-124": {
      "risk_id": "RISK-124",
      "title": "Caddy Admin Interface Exposed",
      "category": "Configuration",
      "severity": "critical",
      "caddy_native": {
        "enforcer": "Caddy",
        "operation": "configtest_pass",
        "target_file": "Caddy",
        "insertion_point": "admin",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "admin off",
        "wrapped_code": "# BEGIN VAPT RISK-124\nadmin off\n# END VAPT RISK-124",
        "begin_marker": "# BEGIN VAPT RISK-124",
        "end_marker": "# END VAPT RISK-124",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "caddy validate --config /etc/caddy/Caddyfile && caddy reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-124...# END VAPT RISK-124 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/caddy/Caddyfile",
          "write_block": "# BEGIN VAPT RISK-124\nadmin off\n# END VAPT RISK-124",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-124",
          "if_found": "skip"
        }
      }
    },
    "RISK-125": {
      "risk_id": "RISK-125",
      "title": "Nginx SSL Configuration Weak",
      "category": "Configuration",
      "severity": "high",
      "nginx": {
        "enforcer": "Nginx",
        "operation": "configtest_pass",
        "target_file": "Nginx",
        "insertion_point": "ssl_config",
        "anchor": {
          "search": null,
          "position": "append",
          "fallback": null
        },
        "code": "ssl_protocols TLSv1.2 TLSv1.3;\nssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';\nssl_prefer_server_ciphers on;",
        "wrapped_code": "# BEGIN VAPT RISK-125\nssl_protocols TLSv1.2 TLSv1.3;\nssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';\nssl_prefer_server_ciphers on;\n# END VAPT RISK-125",
        "begin_marker": "# BEGIN VAPT RISK-125",
        "end_marker": "# END VAPT RISK-125",
        "target_hook": null,
        "target_jail": null,
        "target_constant": null,
        "target_value": null,
        "verification": {
          "command": "nginx -t && nginx -s reload",
          "expected": "No errors"
        },
        "rollback": "Remove # BEGIN VAPT RISK-125...# END VAPT RISK-125 from target file",
        "driver": {
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "write_block": "# BEGIN VAPT RISK-125\nssl_protocols TLSv1.2 TLSv1.3;\nssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';\nssl_prefer_server_ciphers on;\n# END VAPT RISK-125",
          "anchor_string": null,
          "anchor_position": "append",
          "fallback": null,
          "idempotency_check": "# BEGIN VAPT RISK-125",
          "if_found": "skip"
        }
      }
    }
  }
}