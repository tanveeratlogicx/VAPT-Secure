{
  "schema_version": "2.0.0",
  "bundle_date": "2026-02-21",
  "source_file": "VAPT-Risk-Catalogue-Full-125-v3_4_1.json",
  "file_role": "driver_manifest",
  "bundle_files": {
    "pattern_library": "enforcer_pattern_library_v2.0.json",
    "interface_schema": "interface_schema_v2.0.json",
    "agent_instructions": "ai_agent_instructions_v2.0.json",
    "driver_manifest": "vapt_driver_manifest_v2.0.json",
    "driver_reference": "VAPT_Driver_Reference_v2.0.php",
    "readme": "VAPT_AI_Agent_System_README_v2.0.md"
  },
  "description": "VAPT Driver Manifest v2.0 \u2014 Machine-executable instructions for the WordPress plugin driver. Every field is directly usable with no inference required. Enforcer lib_key names match enforcer_pattern_library_v2.0 exactly.",
  "driver_contract": {
    "read_sequence": [
      "1. Resolve {ABSPATH} in target_file to full filesystem path",
      "2. Create target file if it does not exist (especially wp-content/uploads/.htaccess)",
      "3. Read idempotency.check_string \u2014 if found in file AND if_found=skip \u2192 stop, return already-applied",
      "4. If backup_required=true, copy target_file to target_file + '.vapt.bak.' + timestamp",
      "5. Read insertion.anchor_string \u2014 search target_file content for this exact string",
      "6. If anchor found: apply anchor_position (before/after/prepend/append) to place write_block",
      "7. If anchor NOT found: use insertion.fallback strategy (prepend/append)",
      "8. Write new content to target_file",
      "9. Run verification.command \u2014 check output matches verification.expected",
      "10. On failure: remove begin_marker..end_marker block from target_file (rollback)"
    ],
    "write_modes": {
      "insert_at_anchor": "Find anchor_string in file. Insert write_block at anchor_position (before/after).",
      "prepend_to_file": "Insert write_block at the very beginning of the file.",
      "append_to_file": "Append write_block to the end of the file."
    },
    "idempotency_rule": "Always check idempotency.check_string before writing. Never insert a block twice.",
    "abspath_rule": "Replace {ABSPATH} with WordPress ABSPATH constant (trailing slash included).",
    "rollback_rule": "Regex-remove everything from begin_marker line through end_marker line, inclusive."
  },
  "insertion_anchor_definitions": {
    "before_wordpress_rewrite": {
      "search": "# BEGIN WordPress",
      "position": "before",
      "fallback": "prepend"
    },
    "after_wordpress_rewrite": {
      "search": "# END WordPress",
      "position": "after",
      "fallback": "append"
    },
    "beginning_of_file": {
      "search": null,
      "position": "prepend",
      "fallback": null
    },
    "end_of_file": {
      "search": null,
      "position": "append",
      "fallback": null
    },
    "before_wp_settings": {
      "search": "require_once ABSPATH",
      "position": "before",
      "fallback": "append"
    },
    "functions_php": {
      "search": null,
      "position": "append",
      "fallback": null
    },
    "jail_local": {
      "search": null,
      "position": "append",
      "fallback": null
    },
    "http_block": {
      "search": "http {",
      "position": "after",
      "fallback": "append"
    },
    "server_tokens": {
      "search": "server_tokens",
      "position": "before",
      "fallback": "append"
    },
    "crontab_entry": {
      "search": null,
      "position": "append",
      "fallback": null
    }
  },
  "target_file_definitions": {
    ".htaccess": "{ABSPATH}.htaccess",
    "wp-content/uploads/.htaccess": "{ABSPATH}wp-content/uploads/.htaccess",
    "wp-config.php": "{ABSPATH}wp-config.php",
    "PHP Functions": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
    "WordPress": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
    "WordPress Core": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
    "fail2ban": "/etc/fail2ban/jail.local",
    "Nginx": "/etc/nginx/conf.d/vapt-security.conf",
    "Apache": "/etc/apache2/conf-available/vapt-security.conf",
    "Caddy": "/etc/caddy/Caddyfile",
    "Server Cron": "crontab"
  },
  "risks": {
    "RISK-001": {
      "risk_id": "RISK-001",
      "title": "wp-cron.php Enabled Leads to DoS Attack",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "add_constant",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-001 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-001 */\ndefine('DISABLE_WP_CRON', true);\n/* END VAPT RISK-001 */",
          "begin_marker": "/* BEGIN VAPT RISK-001 */",
          "end_marker": "/* END VAPT RISK-001 */",
          "raw_code": "define('DISABLE_WP_CRON', true);",
          "verification": {
            "command": "wp config get DISABLE_WP_CRON",
            "expected": "true"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-001 */",
            "end_marker": "/* END VAPT RISK-001 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-002": {
      "risk_id": "RISK-002",
      "title": "Xmlrpc enabled Leads to Ping back attack",
      "category": "Information Disclosure",
      "severity": "high",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-002",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-002\n<Files \"xmlrpc.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-002",
          "begin_marker": "# BEGIN VAPT RISK-002",
          "end_marker": "# END VAPT RISK-002",
          "raw_code": "<Files \"xmlrpc.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-002",
            "end_marker": "# END VAPT RISK-002",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-003": {
      "risk_id": "RISK-003",
      "title": "Username Enumeration via WordPress REST API",
      "category": "Authentication",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_rewrite_rule",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-003",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "# BEGIN WordPress",
            "anchor_position": "before",
            "fallback": "prepend"
          },
          "write_block": "# BEGIN VAPT RISK-003\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^wp-json/wp/v2/users$ - [F,L]\n    RewriteRule ^wp-json/wp/v2/users/ - [F,L]\n</IfModule>\n# END VAPT RISK-003",
          "begin_marker": "# BEGIN VAPT RISK-003",
          "end_marker": "# END VAPT RISK-003",
          "raw_code": "<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^wp-json/wp/v2/users$ - [F,L]\n    RewriteRule ^wp-json/wp/v2/users/ - [F,L]\n</IfModule>",
          "verification": {
            "command": "apachectl -t && curl -sI 'https://yoursite.com/' | grep HTTP",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-003",
            "end_marker": "# END VAPT RISK-003",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-004": {
      "risk_id": "RISK-004",
      "title": "Email Flooding via Password Reset",
      "category": "Authentication",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "add_action_hook",
          "write_mode": "append_to_file",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-004",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-004\nadd_action('login_init', 'vapt_rate_limit_password_reset');\nfunction vapt_rate_limit_password_reset() {\n    if ($_POST['user_login'] ?? false) {\n        $ip = $_SERVER['REMOTE_ADDR'];\n        $transient = 'pwd_reset_' . md5($ip);\n        if (get_transient($transient)) {\n            wp_die('Too many attempts. Please try again later.');\n        }\n        set_transient($transient, true, 300); // 5 minutes\n    }\n}\n// END VAPT RISK-004",
          "begin_marker": "// BEGIN VAPT RISK-004",
          "end_marker": "// END VAPT RISK-004",
          "raw_code": "add_action('login_init', 'vapt_rate_limit_password_reset');\nfunction vapt_rate_limit_password_reset() {\n    if ($_POST['user_login'] ?? false) {\n        $ip = $_SERVER['REMOTE_ADDR'];\n        $transient = 'pwd_reset_' . md5($ip);\n        if (get_transient($transient)) {\n            wp_die('Too many attempts. Please try again later.');\n        }\n        set_transient($transient, true, 300); // 5 minutes\n    }\n}",
          "verification": {
            "command": "wp eval \"do_action('login_init');\" --skip-themes",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-004",
            "end_marker": "// END VAPT RISK-004",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-005": {
      "risk_id": "RISK-005",
      "title": "Exposed WordPress Admin Username via Author Query",
      "category": "Information Disclosure",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_rewrite_cond",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-005",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "# BEGIN WordPress",
            "anchor_position": "before",
            "fallback": "prepend"
          },
          "write_block": "# BEGIN VAPT RISK-005\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{QUERY_STRING} (^|&)author=\\d+ [NC]\n    RewriteRule ^ - [F,L]\n</IfModule>\n# END VAPT RISK-005",
          "begin_marker": "# BEGIN VAPT RISK-005",
          "end_marker": "# END VAPT RISK-005",
          "raw_code": "<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{QUERY_STRING} (^|&)author=\\d+ [NC]\n    RewriteRule ^ - [F,L]\n</IfModule>",
          "verification": {
            "command": "apachectl -t && curl -sI 'https://yoursite.com/' | grep HTTP",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-005",
            "end_marker": "# END VAPT RISK-005",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-006": {
      "risk_id": "RISK-006",
      "title": "Endpoint Disclosure (auto-generated WP REST routes)",
      "category": "API Security",
      "severity": "low",
      "steps": [
        {
          "enforcer": "WordPress Core",
          "lib_key": "wordpress_core",
          "operation": "add_filter_hook",
          "write_mode": "append_to_file",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-006",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-006\nadd_filter('rest_authentication_errors', 'vapt_restrict_rest_api');\nfunction vapt_restrict_rest_api($result) {\n    if (!empty($result)) return $result;\n    if (!is_user_logged_in()) {\n        return new WP_Error('rest_not_logged_in', 'Authentication required.', array('status' => 401));\n    }\n    return $result;\n}\n// END VAPT RISK-006",
          "begin_marker": "// BEGIN VAPT RISK-006",
          "end_marker": "// END VAPT RISK-006",
          "raw_code": "add_filter('rest_authentication_errors', 'vapt_restrict_rest_api');\nfunction vapt_restrict_rest_api($result) {\n    if (!empty($result)) return $result;\n    if (!is_user_logged_in()) {\n        return new WP_Error('rest_not_logged_in', 'Authentication required.', array('status' => 401));\n    }\n    return $result;\n}",
          "verification": {
            "command": "wp eval \"do_action('rest_authentication_errors');\" --skip-themes",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-006",
            "end_marker": "// END VAPT RISK-006",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-007": {
      "risk_id": "RISK-007",
      "title": "Lack of Rate Limiting on WordPress Login",
      "category": "Authentication",
      "severity": "high",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "add_jail_config",
          "write_mode": "append_to_file",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-007",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-007\n[wordpress-login]\nenabled = true\nport = http,https\nfilter = wordpress-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-007",
          "begin_marker": "# BEGIN VAPT RISK-007",
          "end_marker": "# END VAPT RISK-007",
          "raw_code": "[wordpress-login]\nenabled = true\nport = http,https\nfilter = wordpress-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress-login",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-007",
            "end_marker": "# END VAPT RISK-007",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-008": {
      "risk_id": "RISK-008",
      "title": "Username Enumeration via wp-login.php",
      "category": "Authentication",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "add_filter_hook",
          "write_mode": "append_to_file",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-008",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-008\nadd_filter('login_errors', 'vapt_hide_login_errors');\nfunction vapt_hide_login_errors() {\n    return 'Invalid credentials. Please try again.';\n}\n// END VAPT RISK-008",
          "begin_marker": "// BEGIN VAPT RISK-008",
          "end_marker": "// END VAPT RISK-008",
          "raw_code": "add_filter('login_errors', 'vapt_hide_login_errors');\nfunction vapt_hide_login_errors() {\n    return 'Invalid credentials. Please try again.';\n}",
          "verification": {
            "command": "wp eval \"do_action('login_errors');\" --skip-themes",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-008",
            "end_marker": "// END VAPT RISK-008",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-009": {
      "risk_id": "RISK-009",
      "title": "Lack of Rate Limiting on Contact and Registration Forms",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "add_action_hook",
          "write_mode": "append_to_file",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-009",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-009\nadd_action('wp_enqueue_scripts', 'vapt_add_recaptcha_v3');\nfunction vapt_add_recaptcha_v3() {\n    wp_enqueue_script('google-recaptcha', 'https://www.google.com/recaptcha/api.js?render=YOUR_SITE_KEY');\n}\n// END VAPT RISK-009",
          "begin_marker": "// BEGIN VAPT RISK-009",
          "end_marker": "// END VAPT RISK-009",
          "raw_code": "add_action('wp_enqueue_scripts', 'vapt_add_recaptcha_v3');\nfunction vapt_add_recaptcha_v3() {\n    wp_enqueue_script('google-recaptcha', 'https://www.google.com/recaptcha/api.js?render=YOUR_SITE_KEY');\n}",
          "verification": {
            "command": "wp eval \"do_action('wp_enqueue_scripts');\" --skip-themes",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-009",
            "end_marker": "// END VAPT RISK-009",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-010": {
      "risk_id": "RISK-010",
      "title": "Server Banner Grabbing",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "Nginx",
          "lib_key": "nginx",
          "operation": "modify_server_tokens",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-010",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "http {",
            "anchor_position": "after",
            "fallback": "append"
          },
          "write_block": "# BEGIN VAPT RISK-010\nServerTokens Prod\nServerSignature Off\n# END VAPT RISK-010",
          "begin_marker": "# BEGIN VAPT RISK-010",
          "end_marker": "# END VAPT RISK-010",
          "raw_code": "ServerTokens Prod\nServerSignature Off",
          "verification": {
            "command": "nginx -t && nginx -s reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-010",
            "end_marker": "# END VAPT RISK-010",
            "target_file": "/etc/nginx/conf.d/vapt-security.conf"
          }
        }
      ]
    },
    "RISK-011": {
      "risk_id": "RISK-011",
      "title": "Information Disclosure via readme.html",
      "category": "Information Disclosure",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-011",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-011\n<Files \"readme.html\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-011",
          "begin_marker": "# BEGIN VAPT RISK-011",
          "end_marker": "# END VAPT RISK-011",
          "raw_code": "<Files \"readme.html\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-011",
            "end_marker": "# END VAPT RISK-011",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-012": {
      "risk_id": "RISK-012",
      "title": "HSTS Not Implemented",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-012",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-012\nHeader always set Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\"\n# END VAPT RISK-012",
          "begin_marker": "# BEGIN VAPT RISK-012",
          "end_marker": "# END VAPT RISK-012",
          "raw_code": "Header always set Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Strict-Transport-Security'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-012",
            "end_marker": "# END VAPT RISK-012",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-013": {
      "risk_id": "RISK-013",
      "title": "Directory Listing Enabled",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_directive",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-013",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-013\nOptions -Indexes\n# END VAPT RISK-013",
          "begin_marker": "# BEGIN VAPT RISK-013",
          "end_marker": "# END VAPT RISK-013",
          "raw_code": "Options -Indexes",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-013",
            "end_marker": "# END VAPT RISK-013",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-014": {
      "risk_id": "RISK-014",
      "title": "Missing X-Frame-Options Header",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-014",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-014\nHeader always set X-Frame-Options \"SAMEORIGIN\"\n# END VAPT RISK-014",
          "begin_marker": "# BEGIN VAPT RISK-014",
          "end_marker": "# END VAPT RISK-014",
          "raw_code": "Header always set X-Frame-Options \"SAMEORIGIN\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'X-Frame-Options'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-014",
            "end_marker": "# END VAPT RISK-014",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-015": {
      "risk_id": "RISK-015",
      "title": "Missing X-Content-Type-Options Header",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-015",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-015\nHeader always set X-Content-Type-Options \"nosniff\"\n# END VAPT RISK-015",
          "begin_marker": "# BEGIN VAPT RISK-015",
          "end_marker": "# END VAPT RISK-015",
          "raw_code": "Header always set X-Content-Type-Options \"nosniff\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'X-Content-Type-Options'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-015",
            "end_marker": "# END VAPT RISK-015",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-016": {
      "risk_id": "RISK-016",
      "title": "Missing X-XSS-Protection Header",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-016",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-016\nHeader always set X-XSS-Protection \"1; mode=block\"\n# END VAPT RISK-016",
          "begin_marker": "# BEGIN VAPT RISK-016",
          "end_marker": "# END VAPT RISK-016",
          "raw_code": "Header always set X-XSS-Protection \"1; mode=block\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'X-XSS-Protection'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-016",
            "end_marker": "# END VAPT RISK-016",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-017": {
      "risk_id": "RISK-017",
      "title": "Missing Referrer-Policy Header",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-017",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-017\nHeader always set Referrer-Policy \"strict-origin-when-cross-origin\"\n# END VAPT RISK-017",
          "begin_marker": "# BEGIN VAPT RISK-017",
          "end_marker": "# END VAPT RISK-017",
          "raw_code": "Header always set Referrer-Policy \"strict-origin-when-cross-origin\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Referrer-Policy'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-017",
            "end_marker": "# END VAPT RISK-017",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-018": {
      "risk_id": "RISK-018",
      "title": "Missing Permissions-Policy Header",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-018",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-018\nHeader always set Permissions-Policy \"geolocation=(), microphone=(), camera=()\"\n# END VAPT RISK-018",
          "begin_marker": "# BEGIN VAPT RISK-018",
          "end_marker": "# END VAPT RISK-018",
          "raw_code": "Header always set Permissions-Policy \"geolocation=(), microphone=(), camera=()\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Permissions-Policy'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-018",
            "end_marker": "# END VAPT RISK-018",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-019": {
      "risk_id": "RISK-019",
      "title": "Sensitive Files Accessible",
      "category": "Information Disclosure",
      "severity": "high",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_match_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-019",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-019\n<FilesMatch \"\\.(env|git|sql|log|ini|yml|yaml|bak|conf)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-019",
          "begin_marker": "# BEGIN VAPT RISK-019",
          "end_marker": "# END VAPT RISK-019",
          "raw_code": "<FilesMatch \"\\.(env|git|sql|log|ini|yml|yaml|bak|conf)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-019",
            "end_marker": "# END VAPT RISK-019",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-020": {
      "risk_id": "RISK-020",
      "title": "PHP File Execution in Uploads Directory",
      "category": "Configuration",
      "severity": "critical",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_match_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}wp-content/uploads/.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-020",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-020\n<FilesMatch \"\\.php$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-020",
          "begin_marker": "# BEGIN VAPT RISK-020",
          "end_marker": "# END VAPT RISK-020",
          "raw_code": "<FilesMatch \"\\.php$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-020",
            "end_marker": "# END VAPT RISK-020",
            "target_file": "{ABSPATH}wp-content/uploads/.htaccess"
          }
        }
      ]
    },
    "RISK-021": {
      "risk_id": "RISK-021",
      "title": "WordPress Config File Accessible",
      "category": "Information Disclosure",
      "severity": "critical",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-021",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-021\n<Files \"wp-config.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-021",
          "begin_marker": "# BEGIN VAPT RISK-021",
          "end_marker": "# END VAPT RISK-021",
          "raw_code": "<Files \"wp-config.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-021",
            "end_marker": "# END VAPT RISK-021",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-022": {
      "risk_id": "RISK-022",
      "title": "Missing Content-Security-Policy Header",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-022",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-022\nHeader always set Content-Security-Policy \"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';\"\n# END VAPT RISK-022",
          "begin_marker": "# BEGIN VAPT RISK-022",
          "end_marker": "# END VAPT RISK-022",
          "raw_code": "Header always set Content-Security-Policy \"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Content-Security-Policy'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-022",
            "end_marker": "# END VAPT RISK-022",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-023": {
      "risk_id": "RISK-023",
      "title": "Trace Method Enabled",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_rewrite_rule",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-023",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "# BEGIN WordPress",
            "anchor_position": "before",
            "fallback": "prepend"
          },
          "write_block": "# BEGIN VAPT RISK-023\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{REQUEST_METHOD} ^TRACE [NC]\n    RewriteRule .* - [F,L]\n</IfModule>\n# END VAPT RISK-023",
          "begin_marker": "# BEGIN VAPT RISK-023",
          "end_marker": "# END VAPT RISK-023",
          "raw_code": "<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteCond %{REQUEST_METHOD} ^TRACE [NC]\n    RewriteRule .* - [F,L]\n</IfModule>",
          "verification": {
            "command": "apachectl -t && curl -sI 'https://yoursite.com/' | grep HTTP",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-023",
            "end_marker": "# END VAPT RISK-023",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-024": {
      "risk_id": "RISK-024",
      "title": "Server Signature Enabled",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-024",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-024\nHeader unset Server\nHeader always unset X-Powered-By\nHeader unset X-Powered-By\n# END VAPT RISK-024",
          "begin_marker": "# BEGIN VAPT RISK-024",
          "end_marker": "# END VAPT RISK-024",
          "raw_code": "Header unset Server\nHeader always unset X-Powered-By\nHeader unset X-Powered-By",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Server'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-024",
            "end_marker": "# END VAPT RISK-024",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-025": {
      "risk_id": "RISK-025",
      "title": "ETags Information Leakage",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_directive",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-025",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-025\nFileETag None\n# END VAPT RISK-025",
          "begin_marker": "# BEGIN VAPT RISK-025",
          "end_marker": "# END VAPT RISK-025",
          "raw_code": "FileETag None",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-025",
            "end_marker": "# END VAPT RISK-025",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-026": {
      "risk_id": "RISK-026",
      "title": "Symbolic Links Following Enabled",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_directive",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-026",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-026\nOptions -FollowSymLinks\nOptions +SymLinksIfOwnerMatch\n# END VAPT RISK-026",
          "begin_marker": "# BEGIN VAPT RISK-026",
          "end_marker": "# END VAPT RISK-026",
          "raw_code": "Options -FollowSymLinks\nOptions +SymLinksIfOwnerMatch",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-026",
            "end_marker": "# END VAPT RISK-026",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-027": {
      "risk_id": "RISK-027",
      "title": "WordPress Install File Accessible",
      "category": "Information Disclosure",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-027",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-027\n<Files \"install.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-027",
          "begin_marker": "# BEGIN VAPT RISK-027",
          "end_marker": "# END VAPT RISK-027",
          "raw_code": "<Files \"install.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-027",
            "end_marker": "# END VAPT RISK-027",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-028": {
      "risk_id": "RISK-028",
      "title": "WordPress Upgrade File Accessible",
      "category": "Information Disclosure",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-028",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-028\n<Files \"upgrade.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-028",
          "begin_marker": "# BEGIN VAPT RISK-028",
          "end_marker": "# END VAPT RISK-028",
          "raw_code": "<Files \"upgrade.php\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-028",
            "end_marker": "# END VAPT RISK-028",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-029": {
      "risk_id": "RISK-029",
      "title": "Backup Files Accessible",
      "category": "Information Disclosure",
      "severity": "high",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_match_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-029",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-029\n<FilesMatch \"\\.(bak|backup|old|orig|save|swp|sql|dump)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-029",
          "begin_marker": "# BEGIN VAPT RISK-029",
          "end_marker": "# END VAPT RISK-029",
          "raw_code": "<FilesMatch \"\\.(bak|backup|old|orig|save|swp|sql|dump)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-029",
            "end_marker": "# END VAPT RISK-029",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-030": {
      "risk_id": "RISK-030",
      "title": "Log Files Accessible",
      "category": "Information Disclosure",
      "severity": "high",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_match_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-030",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-030\n<FilesMatch \"\\.(log|error_log|access_log)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>\n# END VAPT RISK-030",
          "begin_marker": "# BEGIN VAPT RISK-030",
          "end_marker": "# END VAPT RISK-030",
          "raw_code": "<FilesMatch \"\\.(log|error_log|access_log)$\">\n    Order Deny,Allow\n    Deny from all\n</FilesMatch>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-030",
            "end_marker": "# END VAPT RISK-030",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-031": {
      "risk_id": "RISK-031",
      "title": "Missing Cross-Origin-Resource-Policy",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-031",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-031\nHeader always set Cross-Origin-Resource-Policy \"same-origin\"\n# END VAPT RISK-031",
          "begin_marker": "# BEGIN VAPT RISK-031",
          "end_marker": "# END VAPT RISK-031",
          "raw_code": "Header always set Cross-Origin-Resource-Policy \"same-origin\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Cross-Origin-Resource-Policy'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-031",
            "end_marker": "# END VAPT RISK-031",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-032": {
      "risk_id": "RISK-032",
      "title": "Missing Cross-Origin-Embedder-Policy",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-032",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-032\nHeader always set Cross-Origin-Embedder-Policy \"require-corp\"\n# END VAPT RISK-032",
          "begin_marker": "# BEGIN VAPT RISK-032",
          "end_marker": "# END VAPT RISK-032",
          "raw_code": "Header always set Cross-Origin-Embedder-Policy \"require-corp\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Cross-Origin-Embedder-Policy'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-032",
            "end_marker": "# END VAPT RISK-032",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-033": {
      "risk_id": "RISK-033",
      "title": "Missing Cross-Origin-Opener-Policy",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_header",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-033",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-033\nHeader always set Cross-Origin-Opener-Policy \"same-origin\"\n# END VAPT RISK-033",
          "begin_marker": "# BEGIN VAPT RISK-033",
          "end_marker": "# END VAPT RISK-033",
          "raw_code": "Header always set Cross-Origin-Opener-Policy \"same-origin\"",
          "verification": {
            "command": "apachectl -t && curl -sI https://yoursite.com | grep -i 'Cross-Origin-Opener-Policy'",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-033",
            "end_marker": "# END VAPT RISK-033",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-034": {
      "risk_id": "RISK-034",
      "title": "WordPress Debug Log Exposed",
      "category": "Information Disclosure",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_files_block",
          "write_mode": "prepend_to_file",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-034",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "prepend",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-034\n<Files \"debug.log\">\n    Order Deny,Allow\n    Deny from all\n</Files>\n# END VAPT RISK-034",
          "begin_marker": "# BEGIN VAPT RISK-034",
          "end_marker": "# END VAPT RISK-034",
          "raw_code": "<Files \"debug.log\">\n    Order Deny,Allow\n    Deny from all\n</Files>",
          "verification": {
            "command": "apachectl -t",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-034",
            "end_marker": "# END VAPT RISK-034",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-035": {
      "risk_id": "RISK-035",
      "title": "Apache Status Page Accessible",
      "category": "Information Disclosure",
      "severity": "medium",
      "steps": [
        {
          "enforcer": ".htaccess",
          "lib_key": "htaccess",
          "operation": "add_rewrite_rule",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}.htaccess",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-035",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "# BEGIN WordPress",
            "anchor_position": "before",
            "fallback": "prepend"
          },
          "write_block": "# BEGIN VAPT RISK-035\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^server-status - [F,L]\n    RewriteRule ^server-info - [F,L]\n</IfModule>\n# END VAPT RISK-035",
          "begin_marker": "# BEGIN VAPT RISK-035",
          "end_marker": "# END VAPT RISK-035",
          "raw_code": "<IfModule mod_rewrite.c>\n    RewriteEngine On\n    RewriteBase /\n    RewriteRule ^server-status - [F,L]\n    RewriteRule ^server-info - [F,L]\n</IfModule>",
          "verification": {
            "command": "apachectl -t && curl -sI 'https://yoursite.com/' | grep HTTP",
            "expected": "Exit 0, no syntax errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-035",
            "end_marker": "# END VAPT RISK-035",
            "target_file": "{ABSPATH}.htaccess"
          }
        }
      ]
    },
    "RISK-036": {
      "risk_id": "RISK-036",
      "title": "PHP Error Display Enabled",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-036",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-036\nadd_action('init', function() { @ini_set('display_errors', 0); });\n// END VAPT RISK-036",
          "begin_marker": "// BEGIN VAPT RISK-036",
          "end_marker": "// END VAPT RISK-036",
          "raw_code": "add_action('init', function() { @ini_set('display_errors', 0); });",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-036",
            "end_marker": "// END VAPT RISK-036",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-037": {
      "risk_id": "RISK-037",
      "title": "PHP Version Exposed in Headers",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-037",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-037\nadd_action('init', function() { header_remove('X-Powered-By'); });\n// END VAPT RISK-037",
          "begin_marker": "// BEGIN VAPT RISK-037",
          "end_marker": "// END VAPT RISK-037",
          "raw_code": "add_action('init', function() { header_remove('X-Powered-By'); });",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-037",
            "end_marker": "// END VAPT RISK-037",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-038": {
      "risk_id": "RISK-038",
      "title": "WordPress Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_removed",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-038",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-038\nremove_action('wp_head', 'wp_generator');\n// END VAPT RISK-038",
          "begin_marker": "// BEGIN VAPT RISK-038",
          "end_marker": "// END VAPT RISK-038",
          "raw_code": "remove_action('wp_head', 'wp_generator');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-038",
            "end_marker": "// END VAPT RISK-038",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-039": {
      "risk_id": "RISK-039",
      "title": "Plugin Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-039",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-039\nadd_filter('style_loader_src', 'vapt_remove_version_query'); add_filter('script_loader_src', 'vapt_remove_version_query');\n// END VAPT RISK-039",
          "begin_marker": "// BEGIN VAPT RISK-039",
          "end_marker": "// END VAPT RISK-039",
          "raw_code": "add_filter('style_loader_src', 'vapt_remove_version_query'); add_filter('script_loader_src', 'vapt_remove_version_query');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-039",
            "end_marker": "// END VAPT RISK-039",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-040": {
      "risk_id": "RISK-040",
      "title": "WordPress Login Page Not Protected",
      "category": "Authentication",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-040",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-040\nadd_action('login_init', 'vapt_restrict_login_by_ip');\n// END VAPT RISK-040",
          "begin_marker": "// BEGIN VAPT RISK-040",
          "end_marker": "// END VAPT RISK-040",
          "raw_code": "add_action('login_init', 'vapt_restrict_login_by_ip');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-040",
            "end_marker": "// END VAPT RISK-040",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-041": {
      "risk_id": "RISK-041",
      "title": "Weak Password Policy",
      "category": "Authentication",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-041",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-041\nadd_action('validate_password_reset', 'vapt_enforce_strong_password', 10, 2);\n// END VAPT RISK-041",
          "begin_marker": "// BEGIN VAPT RISK-041",
          "end_marker": "// END VAPT RISK-041",
          "raw_code": "add_action('validate_password_reset', 'vapt_enforce_strong_password', 10, 2);",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-041",
            "end_marker": "// END VAPT RISK-041",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-042": {
      "risk_id": "RISK-042",
      "title": "Session Timeout Not Configured",
      "category": "Authentication",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-042",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-042\nadd_filter('auth_cookie_expiration', 'vapt_set_session_timeout', 10, 3);\n// END VAPT RISK-042",
          "begin_marker": "// BEGIN VAPT RISK-042",
          "end_marker": "// END VAPT RISK-042",
          "raw_code": "add_filter('auth_cookie_expiration', 'vapt_set_session_timeout', 10, 3);",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-042",
            "end_marker": "// END VAPT RISK-042",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-043": {
      "risk_id": "RISK-043",
      "title": "No Account Lockout Policy",
      "category": "Authentication",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-043",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-043\nadd_action('wp_login_failed', 'vapt_track_failed_logins');\n// END VAPT RISK-043",
          "begin_marker": "// BEGIN VAPT RISK-043",
          "end_marker": "// END VAPT RISK-043",
          "raw_code": "add_action('wp_login_failed', 'vapt_track_failed_logins');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-043",
            "end_marker": "// END VAPT RISK-043",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-044": {
      "risk_id": "RISK-044",
      "title": "User Registration Without Verification",
      "category": "Authentication",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-044",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-044\nadd_action('user_register', 'vapt_require_email_verification');\n// END VAPT RISK-044",
          "begin_marker": "// BEGIN VAPT RISK-044",
          "end_marker": "// END VAPT RISK-044",
          "raw_code": "add_action('user_register', 'vapt_require_email_verification');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-044",
            "end_marker": "// END VAPT RISK-044",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-045": {
      "risk_id": "RISK-045",
      "title": "Default Admin Account Exists",
      "category": "Authentication",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-045",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-045\nadd_action('admin_init', 'vapt_check_default_admin');\n// END VAPT RISK-045",
          "begin_marker": "// BEGIN VAPT RISK-045",
          "end_marker": "// END VAPT RISK-045",
          "raw_code": "add_action('admin_init', 'vapt_check_default_admin');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-045",
            "end_marker": "// END VAPT RISK-045",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-046": {
      "risk_id": "RISK-046",
      "title": "No Two-Factor Authentication",
      "category": "Authentication",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-046",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-046\nadd_action('wp_login', 'vapt_require_2fa_for_admins', 10, 2);\n// END VAPT RISK-046",
          "begin_marker": "// BEGIN VAPT RISK-046",
          "end_marker": "// END VAPT RISK-046",
          "raw_code": "add_action('wp_login', 'vapt_require_2fa_for_admins', 10, 2);",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-046",
            "end_marker": "// END VAPT RISK-046",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-047": {
      "risk_id": "RISK-047",
      "title": "File Upload Without Validation",
      "category": "Configuration",
      "severity": "critical",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-047",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-047\nadd_filter('upload_mimes', 'vapt_restrict_upload_types');\n// END VAPT RISK-047",
          "begin_marker": "// BEGIN VAPT RISK-047",
          "end_marker": "// END VAPT RISK-047",
          "raw_code": "add_filter('upload_mimes', 'vapt_restrict_upload_types');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-047",
            "end_marker": "// END VAPT RISK-047",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-048": {
      "risk_id": "RISK-048",
      "title": "SQL Injection via Search",
      "category": "Injection",
      "severity": "critical",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-048",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-048\nadd_filter('query_vars', 'vapt_sanitize_search_queries');\n// END VAPT RISK-048",
          "begin_marker": "// BEGIN VAPT RISK-048",
          "end_marker": "// END VAPT RISK-048",
          "raw_code": "add_filter('query_vars', 'vapt_sanitize_search_queries');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-048",
            "end_marker": "// END VAPT RISK-048",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-049": {
      "risk_id": "RISK-049",
      "title": "Cross-Site Scripting in Comments",
      "category": "Injection",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-049",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-049\nadd_filter('pre_comment_content', 'vapt_sanitize_comment_content');\n// END VAPT RISK-049",
          "begin_marker": "// BEGIN VAPT RISK-049",
          "end_marker": "// END VAPT RISK-049",
          "raw_code": "add_filter('pre_comment_content', 'vapt_sanitize_comment_content');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-049",
            "end_marker": "// END VAPT RISK-049",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-050": {
      "risk_id": "RISK-050",
      "title": "CSRF Protection Missing",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-050",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-050\nadd_action('init', 'vapt_verify_form_nonces');\n// END VAPT RISK-050",
          "begin_marker": "// BEGIN VAPT RISK-050",
          "end_marker": "// END VAPT RISK-050",
          "raw_code": "add_action('init', 'vapt_verify_form_nonces');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-050",
            "end_marker": "// END VAPT RISK-050",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-051": {
      "risk_id": "RISK-051",
      "title": "Unfiltered HTML in Posts",
      "category": "Injection",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-051",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-051\nadd_filter('content_save_pre', 'vapt_filter_post_html');\n// END VAPT RISK-051",
          "begin_marker": "// BEGIN VAPT RISK-051",
          "end_marker": "// END VAPT RISK-051",
          "raw_code": "add_filter('content_save_pre', 'vapt_filter_post_html');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-051",
            "end_marker": "// END VAPT RISK-051",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-052": {
      "risk_id": "RISK-052",
      "title": "Theme Editor Enabled",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-052",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-052\nadd_action('admin_init', 'vapt_disable_theme_editor');\n// END VAPT RISK-052",
          "begin_marker": "// BEGIN VAPT RISK-052",
          "end_marker": "// END VAPT RISK-052",
          "raw_code": "add_action('admin_init', 'vapt_disable_theme_editor');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-052",
            "end_marker": "// END VAPT RISK-052",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-053": {
      "risk_id": "RISK-053",
      "title": "Plugin Editor Enabled",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-053",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-053\nadd_action('admin_init', 'vapt_disable_plugin_editor');\n// END VAPT RISK-053",
          "begin_marker": "// BEGIN VAPT RISK-053",
          "end_marker": "// END VAPT RISK-053",
          "raw_code": "add_action('admin_init', 'vapt_disable_plugin_editor');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-053",
            "end_marker": "// END VAPT RISK-053",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-054": {
      "risk_id": "RISK-054",
      "title": "XML External Entity Processing",
      "category": "Injection",
      "severity": "critical",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "function_called",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-054",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-054\nlibxml_disable_entity_loader(true);\n// END VAPT RISK-054",
          "begin_marker": "// BEGIN VAPT RISK-054",
          "end_marker": "// END VAPT RISK-054",
          "raw_code": "libxml_disable_entity_loader(true);",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-054",
            "end_marker": "// END VAPT RISK-054",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-055": {
      "risk_id": "RISK-055",
      "title": "PHP Deserialization Vulnerability",
      "category": "Injection",
      "severity": "critical",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-055",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-055\nadd_filter('wp_check_filetype', 'vapt_prevent_phar_deserialization');\n// END VAPT RISK-055",
          "begin_marker": "// BEGIN VAPT RISK-055",
          "end_marker": "// END VAPT RISK-055",
          "raw_code": "add_filter('wp_check_filetype', 'vapt_prevent_phar_deserialization');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-055",
            "end_marker": "// END VAPT RISK-055",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-056": {
      "risk_id": "RISK-056",
      "title": "Open Redirect Vulnerability",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-056",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-056\nadd_filter('wp_redirect', 'vapt_validate_redirects');\n// END VAPT RISK-056",
          "begin_marker": "// BEGIN VAPT RISK-056",
          "end_marker": "// END VAPT RISK-056",
          "raw_code": "add_filter('wp_redirect', 'vapt_validate_redirects');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-056",
            "end_marker": "// END VAPT RISK-056",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-057": {
      "risk_id": "RISK-057",
      "title": "Information Leak via JSON API",
      "category": "Information Disclosure",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-057",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-057\nadd_filter('rest_prepare_user', 'vapt_filter_user_api_response');\n// END VAPT RISK-057",
          "begin_marker": "// BEGIN VAPT RISK-057",
          "end_marker": "// END VAPT RISK-057",
          "raw_code": "add_filter('rest_prepare_user', 'vapt_filter_user_api_response');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-057",
            "end_marker": "// END VAPT RISK-057",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-058": {
      "risk_id": "RISK-058",
      "title": "Comment Spam Not Protected",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-058",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-058\nadd_filter('preprocess_comment', 'vapt_check_comment_spam');\n// END VAPT RISK-058",
          "begin_marker": "// BEGIN VAPT RISK-058",
          "end_marker": "// END VAPT RISK-058",
          "raw_code": "add_filter('preprocess_comment', 'vapt_check_comment_spam');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-058",
            "end_marker": "// END VAPT RISK-058",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-059": {
      "risk_id": "RISK-059",
      "title": "Pingback XML-RPC Enabled",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-059",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-059\nadd_filter('xmlrpc_methods', 'vapt_disable_pingback_method');\n// END VAPT RISK-059",
          "begin_marker": "// BEGIN VAPT RISK-059",
          "end_marker": "// END VAPT RISK-059",
          "raw_code": "add_filter('xmlrpc_methods', 'vapt_disable_pingback_method');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-059",
            "end_marker": "// END VAPT RISK-059",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-060": {
      "risk_id": "RISK-060",
      "title": "Trackback Enabled",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "PHP Functions",
          "lib_key": "php_functions",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-060",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-060\nadd_action('init', 'vapt_disable_trackbacks');\n// END VAPT RISK-060",
          "begin_marker": "// BEGIN VAPT RISK-060",
          "end_marker": "// END VAPT RISK-060",
          "raw_code": "add_action('init', 'vapt_disable_trackbacks');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-060",
            "end_marker": "// END VAPT RISK-060",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-061": {
      "risk_id": "RISK-061",
      "title": "WordPress Salts Not Configured",
      "category": "Configuration",
      "severity": "critical",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-061 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-061 */\ndefine('AUTH_KEY', 'unique-key-here'); define('SECURE_AUTH_KEY', 'unique-key-here');\n/* END VAPT RISK-061 */",
          "begin_marker": "/* BEGIN VAPT RISK-061 */",
          "end_marker": "/* END VAPT RISK-061 */",
          "raw_code": "define('AUTH_KEY', 'unique-key-here'); define('SECURE_AUTH_KEY', 'unique-key-here');",
          "verification": {
            "command": "wp config get AUTH_KEY",
            "expected": "unique-key-here"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-061 */",
            "end_marker": "/* END VAPT RISK-061 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-062": {
      "risk_id": "RISK-062",
      "title": "Database Credentials Exposed",
      "category": "Configuration",
      "severity": "critical",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-062 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-062 */\ndefine('DB_PASSWORD', getenv('DB_PASSWORD'));\n/* END VAPT RISK-062 */",
          "begin_marker": "/* BEGIN VAPT RISK-062 */",
          "end_marker": "/* END VAPT RISK-062 */",
          "raw_code": "define('DB_PASSWORD', getenv('DB_PASSWORD'));",
          "verification": {
            "command": "wp config get DB_PASSWORD",
            "expected": "getenv('DB_PASSWORD"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-062 */",
            "end_marker": "/* END VAPT RISK-062 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-063": {
      "risk_id": "RISK-063",
      "title": "Debug Mode Enabled in Production",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-063 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-063 */\ndefine('WP_DEBUG', false);\n/* END VAPT RISK-063 */",
          "begin_marker": "/* BEGIN VAPT RISK-063 */",
          "end_marker": "/* END VAPT RISK-063 */",
          "raw_code": "define('WP_DEBUG', false);",
          "verification": {
            "command": "wp config get WP_DEBUG",
            "expected": "false"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-063 */",
            "end_marker": "/* END VAPT RISK-063 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-064": {
      "risk_id": "RISK-064",
      "title": "Script Debug Enabled",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-064 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-064 */\ndefine('SCRIPT_DEBUG', false);\n/* END VAPT RISK-064 */",
          "begin_marker": "/* BEGIN VAPT RISK-064 */",
          "end_marker": "/* END VAPT RISK-064 */",
          "raw_code": "define('SCRIPT_DEBUG', false);",
          "verification": {
            "command": "wp config get SCRIPT_DEBUG",
            "expected": "false"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-064 */",
            "end_marker": "/* END VAPT RISK-064 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-065": {
      "risk_id": "RISK-065",
      "title": "Save Queries Enabled",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-065 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-065 */\ndefine('SAVEQUERIES', false);\n/* END VAPT RISK-065 */",
          "begin_marker": "/* BEGIN VAPT RISK-065 */",
          "end_marker": "/* END VAPT RISK-065 */",
          "raw_code": "define('SAVEQUERIES', false);",
          "verification": {
            "command": "wp config get SAVEQUERIES",
            "expected": "false"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-065 */",
            "end_marker": "/* END VAPT RISK-065 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-066": {
      "risk_id": "RISK-066",
      "title": "File Edit Not Disabled",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-066 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-066 */\ndefine('DISALLOW_FILE_EDIT', true);\n/* END VAPT RISK-066 */",
          "begin_marker": "/* BEGIN VAPT RISK-066 */",
          "end_marker": "/* END VAPT RISK-066 */",
          "raw_code": "define('DISALLOW_FILE_EDIT', true);",
          "verification": {
            "command": "wp config get DISALLOW_FILE_EDIT",
            "expected": "true"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-066 */",
            "end_marker": "/* END VAPT RISK-066 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-067": {
      "risk_id": "RISK-067",
      "title": "File Modification Not Restricted",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-067 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-067 */\ndefine('DISALLOW_FILE_MODS', true);\n/* END VAPT RISK-067 */",
          "begin_marker": "/* BEGIN VAPT RISK-067 */",
          "end_marker": "/* END VAPT RISK-067 */",
          "raw_code": "define('DISALLOW_FILE_MODS', true);",
          "verification": {
            "command": "wp config get DISALLOW_FILE_MODS",
            "expected": "true"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-067 */",
            "end_marker": "/* END VAPT RISK-067 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-068": {
      "risk_id": "RISK-068",
      "title": "Automatic Updates Disabled",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-068 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-068 */\ndefine('WP_AUTO_UPDATE_CORE', true);\n/* END VAPT RISK-068 */",
          "begin_marker": "/* BEGIN VAPT RISK-068 */",
          "end_marker": "/* END VAPT RISK-068 */",
          "raw_code": "define('WP_AUTO_UPDATE_CORE', true);",
          "verification": {
            "command": "wp config get WP_AUTO_UPDATE_CORE",
            "expected": "true"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-068 */",
            "end_marker": "/* END VAPT RISK-068 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-069": {
      "risk_id": "RISK-069",
      "title": "SSL Not Enforced for Admin",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-069 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-069 */\ndefine('FORCE_SSL_ADMIN', true);\n/* END VAPT RISK-069 */",
          "begin_marker": "/* BEGIN VAPT RISK-069 */",
          "end_marker": "/* END VAPT RISK-069 */",
          "raw_code": "define('FORCE_SSL_ADMIN', true);",
          "verification": {
            "command": "wp config get FORCE_SSL_ADMIN",
            "expected": "true"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-069 */",
            "end_marker": "/* END VAPT RISK-069 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-070": {
      "risk_id": "RISK-070",
      "title": "SSL Not Enforced for Login",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-070 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-070 */\ndefine('FORCE_SSL_LOGIN', true);\n/* END VAPT RISK-070 */",
          "begin_marker": "/* BEGIN VAPT RISK-070 */",
          "end_marker": "/* END VAPT RISK-070 */",
          "raw_code": "define('FORCE_SSL_LOGIN', true);",
          "verification": {
            "command": "wp config get FORCE_SSL_LOGIN",
            "expected": "true"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-070 */",
            "end_marker": "/* END VAPT RISK-070 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-071": {
      "risk_id": "RISK-071",
      "title": "Cookie Domain Not Set",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-071 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-071 */\ndefine('COOKIE_DOMAIN', 'example.com');\n/* END VAPT RISK-071 */",
          "begin_marker": "/* BEGIN VAPT RISK-071 */",
          "end_marker": "/* END VAPT RISK-071 */",
          "raw_code": "define('COOKIE_DOMAIN', 'example.com');",
          "verification": {
            "command": "wp config get COOKIE_DOMAIN",
            "expected": "example.com"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-071 */",
            "end_marker": "/* END VAPT RISK-071 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-072": {
      "risk_id": "RISK-072",
      "title": "Cookie Path Not Restricted",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-072 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-072 */\ndefine('COOKIEPATH', '/');\n/* END VAPT RISK-072 */",
          "begin_marker": "/* BEGIN VAPT RISK-072 */",
          "end_marker": "/* END VAPT RISK-072 */",
          "raw_code": "define('COOKIEPATH', '/');",
          "verification": {
            "command": "wp config get COOKIEPATH",
            "expected": "/"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-072 */",
            "end_marker": "/* END VAPT RISK-072 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-073": {
      "risk_id": "RISK-073",
      "title": "Trash Auto-Delete Not Configured",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-073 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-073 */\ndefine('EMPTY_TRASH_DAYS', 7);\n/* END VAPT RISK-073 */",
          "begin_marker": "/* BEGIN VAPT RISK-073 */",
          "end_marker": "/* END VAPT RISK-073 */",
          "raw_code": "define('EMPTY_TRASH_DAYS', 7);",
          "verification": {
            "command": "wp config get EMPTY_TRASH_DAYS",
            "expected": "7"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-073 */",
            "end_marker": "/* END VAPT RISK-073 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-074": {
      "risk_id": "RISK-074",
      "title": "Post Revisions Unlimited",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-074 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-074 */\ndefine('WP_POST_REVISIONS', 5);\n/* END VAPT RISK-074 */",
          "begin_marker": "/* BEGIN VAPT RISK-074 */",
          "end_marker": "/* END VAPT RISK-074 */",
          "raw_code": "define('WP_POST_REVISIONS', 5);",
          "verification": {
            "command": "wp config get WP_POST_REVISIONS",
            "expected": "5"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-074 */",
            "end_marker": "/* END VAPT RISK-074 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-075": {
      "risk_id": "RISK-075",
      "title": "Autosave Interval Too Long",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-075 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-075 */\ndefine('AUTOSAVE_INTERVAL', 60);\n/* END VAPT RISK-075 */",
          "begin_marker": "/* BEGIN VAPT RISK-075 */",
          "end_marker": "/* END VAPT RISK-075 */",
          "raw_code": "define('AUTOSAVE_INTERVAL', 60);",
          "verification": {
            "command": "wp config get AUTOSAVE_INTERVAL",
            "expected": "60"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-075 */",
            "end_marker": "/* END VAPT RISK-075 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-076": {
      "risk_id": "RISK-076",
      "title": "Memory Limit Too Low",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-076 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-076 */\ndefine('WP_MEMORY_LIMIT', '256M');\n/* END VAPT RISK-076 */",
          "begin_marker": "/* BEGIN VAPT RISK-076 */",
          "end_marker": "/* END VAPT RISK-076 */",
          "raw_code": "define('WP_MEMORY_LIMIT', '256M');",
          "verification": {
            "command": "wp config get WP_MEMORY_LIMIT",
            "expected": "256M"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-076 */",
            "end_marker": "/* END VAPT RISK-076 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-077": {
      "risk_id": "RISK-077",
      "title": "Max Memory Limit Not Set",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-077 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-077 */\ndefine('WP_MAX_MEMORY_LIMIT', '512M');\n/* END VAPT RISK-077 */",
          "begin_marker": "/* BEGIN VAPT RISK-077 */",
          "end_marker": "/* END VAPT RISK-077 */",
          "raw_code": "define('WP_MAX_MEMORY_LIMIT', '512M');",
          "verification": {
            "command": "wp config get WP_MAX_MEMORY_LIMIT",
            "expected": "512M"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-077 */",
            "end_marker": "/* END VAPT RISK-077 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-078": {
      "risk_id": "RISK-078",
      "title": "Table Prefix Default",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "variable_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-078 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-078 */\n$table_prefix = 'wp_x7k9m2_';\n/* END VAPT RISK-078 */",
          "begin_marker": "/* BEGIN VAPT RISK-078 */",
          "end_marker": "/* END VAPT RISK-078 */",
          "raw_code": "$table_prefix = 'wp_x7k9m2_';",
          "verification": {
            "command": "wp config get table_prefix",
            "expected": "wp_x7k9m2_"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-078 */",
            "end_marker": "/* END VAPT RISK-078 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-079": {
      "risk_id": "RISK-079",
      "title": "Database Host Exposed",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-079 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-079 */\ndefine('DB_HOST', getenv('DB_HOST') ?: 'localhost');\n/* END VAPT RISK-079 */",
          "begin_marker": "/* BEGIN VAPT RISK-079 */",
          "end_marker": "/* END VAPT RISK-079 */",
          "raw_code": "define('DB_HOST', getenv('DB_HOST') ?: 'localhost');",
          "verification": {
            "command": "wp config get DB_HOST",
            "expected": "getenv('DB_HOST"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-079 */",
            "end_marker": "/* END VAPT RISK-079 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-080": {
      "risk_id": "RISK-080",
      "title": "Custom User Table Not Defined",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "wp-config.php",
          "lib_key": "wp_config",
          "operation": "constant_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-config.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "/* BEGIN VAPT RISK-080 */",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "require_once ABSPATH",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "/* BEGIN VAPT RISK-080 */\ndefine('CUSTOM_USER_TABLE', 'custom_users');\n/* END VAPT RISK-080 */",
          "begin_marker": "/* BEGIN VAPT RISK-080 */",
          "end_marker": "/* END VAPT RISK-080 */",
          "raw_code": "define('CUSTOM_USER_TABLE', 'custom_users');",
          "verification": {
            "command": "wp config get CUSTOM_USER_TABLE",
            "expected": "custom_users"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "/* BEGIN VAPT RISK-080 */",
            "end_marker": "/* END VAPT RISK-080 */",
            "target_file": "{ABSPATH}wp-config.php"
          }
        }
      ]
    },
    "RISK-081": {
      "risk_id": "RISK-081",
      "title": "XML-RPC Brute Force Not Blocked",
      "category": "Authentication",
      "severity": "high",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-081",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-081\n[wordpress-xmlrpc]\nenabled = true\nport = http,https\nfilter = wordpress-xmlrpc\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-081",
          "begin_marker": "# BEGIN VAPT RISK-081",
          "end_marker": "# END VAPT RISK-081",
          "raw_code": "[wordpress-xmlrpc]\nenabled = true\nport = http,https\nfilter = wordpress-xmlrpc\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-081",
            "end_marker": "# END VAPT RISK-081",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-082": {
      "risk_id": "RISK-082",
      "title": "WP-Admin Brute Force Not Blocked",
      "category": "Authentication",
      "severity": "high",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-082",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-082\n[wordpress-admin]\nenabled = true\nport = http,https\nfilter = wordpress-admin\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600\n# END VAPT RISK-082",
          "begin_marker": "# BEGIN VAPT RISK-082",
          "end_marker": "# END VAPT RISK-082",
          "raw_code": "[wordpress-admin]\nenabled = true\nport = http,https\nfilter = wordpress-admin\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-082",
            "end_marker": "# END VAPT RISK-082",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-083": {
      "risk_id": "RISK-083",
      "title": "404 Exploit Scanning Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-083",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-083\n[wordpress-404]\nenabled = true\nport = http,https\nfilter = wordpress-404\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 1800\n# END VAPT RISK-083",
          "begin_marker": "# BEGIN VAPT RISK-083",
          "end_marker": "# END VAPT RISK-083",
          "raw_code": "[wordpress-404]\nenabled = true\nport = http,https\nfilter = wordpress-404\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 1800",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-083",
            "end_marker": "# END VAPT RISK-083",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-084": {
      "risk_id": "RISK-084",
      "title": "Comment Spam Not Rate Limited",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-084",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-084\n[wordpress-comments]\nenabled = true\nport = http,https\nfilter = wordpress-comments\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600\n# END VAPT RISK-084",
          "begin_marker": "# BEGIN VAPT RISK-084",
          "end_marker": "# END VAPT RISK-084",
          "raw_code": "[wordpress-comments]\nenabled = true\nport = http,https\nfilter = wordpress-comments\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-084",
            "end_marker": "# END VAPT RISK-084",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-085": {
      "risk_id": "RISK-085",
      "title": "Registration Spam Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-085",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-085\n[wordpress-register]\nenabled = true\nport = http,https\nfilter = wordpress-register\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-085",
          "begin_marker": "# BEGIN VAPT RISK-085",
          "end_marker": "# END VAPT RISK-085",
          "raw_code": "[wordpress-register]\nenabled = true\nport = http,https\nfilter = wordpress-register\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-085",
            "end_marker": "# END VAPT RISK-085",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-086": {
      "risk_id": "RISK-086",
      "title": "REST API Abuse Not Blocked",
      "category": "API Security",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-086",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-086\n[wordpress-rest]\nenabled = true\nport = http,https\nfilter = wordpress-rest\nlogpath = /var/log/apache2/access.log\nmaxretry = 20\nbantime = 1800\n# END VAPT RISK-086",
          "begin_marker": "# BEGIN VAPT RISK-086",
          "end_marker": "# END VAPT RISK-086",
          "raw_code": "[wordpress-rest]\nenabled = true\nport = http,https\nfilter = wordpress-rest\nlogpath = /var/log/apache2/access.log\nmaxretry = 20\nbantime = 1800",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-086",
            "end_marker": "# END VAPT RISK-086",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-087": {
      "risk_id": "RISK-087",
      "title": "Password Reset Abuse Not Blocked",
      "category": "Authentication",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-087",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-087\n[wordpress-reset]\nenabled = true\nport = http,https\nfilter = wordpress-reset\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-087",
          "begin_marker": "# BEGIN VAPT RISK-087",
          "end_marker": "# END VAPT RISK-087",
          "raw_code": "[wordpress-reset]\nenabled = true\nport = http,https\nfilter = wordpress-reset\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-087",
            "end_marker": "# END VAPT RISK-087",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-088": {
      "risk_id": "RISK-088",
      "title": "File Upload Abuse Not Blocked",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-088",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-088\n[wordpress-upload]\nenabled = true\nport = http,https\nfilter = wordpress-upload\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 3600\n# END VAPT RISK-088",
          "begin_marker": "# BEGIN VAPT RISK-088",
          "end_marker": "# END VAPT RISK-088",
          "raw_code": "[wordpress-upload]\nenabled = true\nport = http,https\nfilter = wordpress-upload\nlogpath = /var/log/apache2/access.log\nmaxretry = 10\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-088",
            "end_marker": "# END VAPT RISK-088",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-089": {
      "risk_id": "RISK-089",
      "title": "Search Query Abuse Not Blocked",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-089",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-089\n[wordpress-search]\nenabled = true\nport = http,https\nfilter = wordpress-search\nlogpath = /var/log/apache2/access.log\nmaxretry = 15\nbantime = 1800\n# END VAPT RISK-089",
          "begin_marker": "# BEGIN VAPT RISK-089",
          "end_marker": "# END VAPT RISK-089",
          "raw_code": "[wordpress-search]\nenabled = true\nport = http,https\nfilter = wordpress-search\nlogpath = /var/log/apache2/access.log\nmaxretry = 15\nbantime = 1800",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-089",
            "end_marker": "# END VAPT RISK-089",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-090": {
      "risk_id": "RISK-090",
      "title": "Bot Traffic Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-090",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-090\n[wordpress-badbots]\nenabled = true\nport = http,https\nfilter = wordpress-badbots\nlogpath = /var/log/apache2/access.log\nmaxretry = 1\nbantime = 86400\n# END VAPT RISK-090",
          "begin_marker": "# BEGIN VAPT RISK-090",
          "end_marker": "# END VAPT RISK-090",
          "raw_code": "[wordpress-badbots]\nenabled = true\nport = http,https\nfilter = wordpress-badbots\nlogpath = /var/log/apache2/access.log\nmaxretry = 1\nbantime = 86400",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-090",
            "end_marker": "# END VAPT RISK-090",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-091": {
      "risk_id": "RISK-091",
      "title": "HTTP Method Abuse Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-091",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-091\n[wordpress-methods]\nenabled = true\nport = http,https\nfilter = wordpress-methods\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600\n# END VAPT RISK-091",
          "begin_marker": "# BEGIN VAPT RISK-091",
          "end_marker": "# END VAPT RISK-091",
          "raw_code": "[wordpress-methods]\nenabled = true\nport = http,https\nfilter = wordpress-methods\nlogpath = /var/log/apache2/access.log\nmaxretry = 5\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-091",
            "end_marker": "# END VAPT RISK-091",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-092": {
      "risk_id": "RISK-092",
      "title": "User Agent Abuse Not Blocked",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-092",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-092\n[wordpress-useragent]\nenabled = true\nport = http,https\nfilter = wordpress-useragent\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-092",
          "begin_marker": "# BEGIN VAPT RISK-092",
          "end_marker": "# END VAPT RISK-092",
          "raw_code": "[wordpress-useragent]\nenabled = true\nport = http,https\nfilter = wordpress-useragent\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-092",
            "end_marker": "# END VAPT RISK-092",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-093": {
      "risk_id": "RISK-093",
      "title": "XML-RPC Pingback Abuse Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-093",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-093\n[wordpress-pingback]\nenabled = true\nport = http,https\nfilter = wordpress-pingback\nlogpath = /var/log/apache2/access.log\nmaxretry = 2\nbantime = 86400\n# END VAPT RISK-093",
          "begin_marker": "# BEGIN VAPT RISK-093",
          "end_marker": "# END VAPT RISK-093",
          "raw_code": "[wordpress-pingback]\nenabled = true\nport = http,https\nfilter = wordpress-pingback\nlogpath = /var/log/apache2/access.log\nmaxretry = 2\nbantime = 86400",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-093",
            "end_marker": "# END VAPT RISK-093",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-094": {
      "risk_id": "RISK-094",
      "title": "WooCommerce Login Not Protected",
      "category": "Authentication",
      "severity": "high",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-094",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-094\n[woocommerce-login]\nenabled = true\nport = http,https\nfilter = woocommerce-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600\n# END VAPT RISK-094",
          "begin_marker": "# BEGIN VAPT RISK-094",
          "end_marker": "# END VAPT RISK-094",
          "raw_code": "[woocommerce-login]\nenabled = true\nport = http,https\nfilter = woocommerce-login\nlogpath = /var/log/apache2/access.log\nmaxretry = 3\nbantime = 3600",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-094",
            "end_marker": "# END VAPT RISK-094",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-095": {
      "risk_id": "RISK-095",
      "title": "Long Duration Attacks Not Blocked",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "fail2ban",
          "lib_key": "fail2ban",
          "operation": "service_restart",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/fail2ban/jail.local",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-095",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-095\n[wordpress-slow]\nenabled = true\nport = http,https\nfilter = wordpress-slow\nlogpath = /var/log/apache2/access.log\nfindtime = 86400\nmaxretry = 10\nbantime = 86400\n# END VAPT RISK-095",
          "begin_marker": "# BEGIN VAPT RISK-095",
          "end_marker": "# END VAPT RISK-095",
          "raw_code": "[wordpress-slow]\nenabled = true\nport = http,https\nfilter = wordpress-slow\nlogpath = /var/log/apache2/access.log\nfindtime = 86400\nmaxretry = 10\nbantime = 86400",
          "verification": {
            "command": "fail2ban-client -t && fail2ban-client reload && fail2ban-client status wordpress",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-095",
            "end_marker": "# END VAPT RISK-095",
            "target_file": "/etc/fail2ban/jail.local"
          }
        }
      ]
    },
    "RISK-096": {
      "risk_id": "RISK-096",
      "title": "WordPress Cron Not Replaced with Server Cron",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-096",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-096\n*/5 * * * * curl -s https://site.com/wp-cron.php?doing_wp_cron > /dev/null 2>&1\n# END VAPT RISK-096",
          "begin_marker": "# BEGIN VAPT RISK-096",
          "end_marker": "# END VAPT RISK-096",
          "raw_code": "*/5 * * * * curl -s https://site.com/wp-cron.php?doing_wp_cron > /dev/null 2>&1",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-096",
            "end_marker": "# END VAPT RISK-096",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-097": {
      "risk_id": "RISK-097",
      "title": "No Automated Backup Schedule",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-097",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-097\n0 2 * * * /usr/local/bin/wp-backup.sh > /var/log/wp-backup.log 2>&1\n# END VAPT RISK-097",
          "begin_marker": "# BEGIN VAPT RISK-097",
          "end_marker": "# END VAPT RISK-097",
          "raw_code": "0 2 * * * /usr/local/bin/wp-backup.sh > /var/log/wp-backup.log 2>&1",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-097",
            "end_marker": "# END VAPT RISK-097",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-098": {
      "risk_id": "RISK-098",
      "title": "No Security Scan Schedule",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-098",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-098\n0 3 * * 0 /usr/local/bin/wp-security-scan.sh > /var/log/wp-scan.log 2>&1\n# END VAPT RISK-098",
          "begin_marker": "# BEGIN VAPT RISK-098",
          "end_marker": "# END VAPT RISK-098",
          "raw_code": "0 3 * * 0 /usr/local/bin/wp-security-scan.sh > /var/log/wp-scan.log 2>&1",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-098",
            "end_marker": "# END VAPT RISK-098",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-099": {
      "risk_id": "RISK-099",
      "title": "No Log Rotation Configured",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-099",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-099\n0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/wordpress\n# END VAPT RISK-099",
          "begin_marker": "# BEGIN VAPT RISK-099",
          "end_marker": "# END VAPT RISK-099",
          "raw_code": "0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/wordpress",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-099",
            "end_marker": "# END VAPT RISK-099",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-100": {
      "risk_id": "RISK-100",
      "title": "No Plugin Update Schedule",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-100",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-100\n0 4 * * * cd /var/www/html && wp plugin update --all --allow-root > /var/log/wp-plugin-update.log 2>&1\n# END VAPT RISK-100",
          "begin_marker": "# BEGIN VAPT RISK-100",
          "end_marker": "# END VAPT RISK-100",
          "raw_code": "0 4 * * * cd /var/www/html && wp plugin update --all --allow-root > /var/log/wp-plugin-update.log 2>&1",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-100",
            "end_marker": "# END VAPT RISK-100",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-101": {
      "risk_id": "RISK-101",
      "title": "No Core Update Schedule",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-101",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-101\n0 5 * * * cd /var/www/html && wp core update --allow-root > /var/log/wp-core-update.log 2>&1\n# END VAPT RISK-101",
          "begin_marker": "# BEGIN VAPT RISK-101",
          "end_marker": "# END VAPT RISK-101",
          "raw_code": "0 5 * * * cd /var/www/html && wp core update --allow-root > /var/log/wp-core-update.log 2>&1",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-101",
            "end_marker": "# END VAPT RISK-101",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-102": {
      "risk_id": "RISK-102",
      "title": "No Database Optimization Schedule",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-102",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-102\n0 2 * * 0 cd /var/www/html && wp db optimize --allow-root > /var/log/wp-db-optimize.log 2>&1\n# END VAPT RISK-102",
          "begin_marker": "# BEGIN VAPT RISK-102",
          "end_marker": "# END VAPT RISK-102",
          "raw_code": "0 2 * * 0 cd /var/www/html && wp db optimize --allow-root > /var/log/wp-db-optimize.log 2>&1",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-102",
            "end_marker": "# END VAPT RISK-102",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-103": {
      "risk_id": "RISK-103",
      "title": "No Spam Cleanup Schedule",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-103",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-103\n0 1 * * * cd /var/www/html && wp comment delete --status=spam --allow-root > /var/log/wp-spam-cleanup.log 2>&1\n# END VAPT RISK-103",
          "begin_marker": "# BEGIN VAPT RISK-103",
          "end_marker": "# END VAPT RISK-103",
          "raw_code": "0 1 * * * cd /var/www/html && wp comment delete --status=spam --allow-root > /var/log/wp-spam-cleanup.log 2>&1",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-103",
            "end_marker": "# END VAPT RISK-103",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-104": {
      "risk_id": "RISK-104",
      "title": "No Failed Login Log Rotation",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-104",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-104\n0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/fail2ban\n# END VAPT RISK-104",
          "begin_marker": "# BEGIN VAPT RISK-104",
          "end_marker": "# END VAPT RISK-104",
          "raw_code": "0 0 * * 0 /usr/sbin/logrotate -f /etc/logrotate.d/fail2ban",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-104",
            "end_marker": "# END VAPT RISK-104",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-105": {
      "risk_id": "RISK-105",
      "title": "No SSL Certificate Renewal",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "Server Cron",
          "lib_key": "server_cron",
          "operation": "cron_job_exists",
          "write_mode": "insert_at_anchor",
          "target_file": "crontab",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-105",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-105\n0 0 1 * * /usr/bin/certbot renew --quiet --post-hook 'systemctl reload nginx'\n# END VAPT RISK-105",
          "begin_marker": "# BEGIN VAPT RISK-105",
          "end_marker": "# END VAPT RISK-105",
          "raw_code": "0 0 1 * * /usr/bin/certbot renew --quiet --post-hook 'systemctl reload nginx'",
          "verification": {
            "command": "crontab -l | grep vapt",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-105",
            "end_marker": "# END VAPT RISK-105",
            "target_file": "crontab"
          }
        }
      ]
    },
    "RISK-106": {
      "risk_id": "RISK-106",
      "title": "Inactive Plugins Present",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-106",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-106\nadd_action('admin_init', 'vapt_remove_inactive_plugins');\n// END VAPT RISK-106",
          "begin_marker": "// BEGIN VAPT RISK-106",
          "end_marker": "// END VAPT RISK-106",
          "raw_code": "add_action('admin_init', 'vapt_remove_inactive_plugins');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-106",
            "end_marker": "// END VAPT RISK-106",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-107": {
      "risk_id": "RISK-107",
      "title": "Inactive Themes Present",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-107",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-107\nadd_action('admin_init', 'vapt_remove_inactive_themes');\n// END VAPT RISK-107",
          "begin_marker": "// BEGIN VAPT RISK-107",
          "end_marker": "// END VAPT RISK-107",
          "raw_code": "add_action('admin_init', 'vapt_remove_inactive_themes');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-107",
            "end_marker": "// END VAPT RISK-107",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-108": {
      "risk_id": "RISK-108",
      "title": "Default Theme Not Deleted",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-108",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-108\nadd_action('admin_init', 'vapt_remove_default_themes');\n// END VAPT RISK-108",
          "begin_marker": "// BEGIN VAPT RISK-108",
          "end_marker": "// END VAPT RISK-108",
          "raw_code": "add_action('admin_init', 'vapt_remove_default_themes');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-108",
            "end_marker": "// END VAPT RISK-108",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-109": {
      "risk_id": "RISK-109",
      "title": "Hello Dolly Plugin Active",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "hook_active",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-109",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-109\nadd_action('admin_init', 'vapt_remove_hello_dolly');\n// END VAPT RISK-109",
          "begin_marker": "// BEGIN VAPT RISK-109",
          "end_marker": "// END VAPT RISK-109",
          "raw_code": "add_action('admin_init', 'vapt_remove_hello_dolly');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-109",
            "end_marker": "// END VAPT RISK-109",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-110": {
      "risk_id": "RISK-110",
      "title": "WordPress Version Publicly Visible",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "filter_applied",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-110",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-110\nadd_filter('the_generator', '__return_empty_string');\n// END VAPT RISK-110",
          "begin_marker": "// BEGIN VAPT RISK-110",
          "end_marker": "// END VAPT RISK-110",
          "raw_code": "add_filter('the_generator', '__return_empty_string');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-110",
            "end_marker": "// END VAPT RISK-110",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-111": {
      "risk_id": "RISK-111",
      "title": "Emoji Scripts Loaded",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "hook_removed",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-111",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-111\nremove_action('wp_head', 'print_emoji_detection_script', 7); remove_action('wp_print_styles', 'print_emoji_styles');\n// END VAPT RISK-111",
          "begin_marker": "// BEGIN VAPT RISK-111",
          "end_marker": "// END VAPT RISK-111",
          "raw_code": "remove_action('wp_head', 'print_emoji_detection_script', 7); remove_action('wp_print_styles', 'print_emoji_styles');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-111",
            "end_marker": "// END VAPT RISK-111",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-112": {
      "risk_id": "RISK-112",
      "title": "oEmbed Discovery Enabled",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "hook_removed",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-112",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-112\nremove_action('wp_head', 'wp_oembed_add_discovery_links');\n// END VAPT RISK-112",
          "begin_marker": "// BEGIN VAPT RISK-112",
          "end_marker": "// END VAPT RISK-112",
          "raw_code": "remove_action('wp_head', 'wp_oembed_add_discovery_links');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-112",
            "end_marker": "// END VAPT RISK-112",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-113": {
      "risk_id": "RISK-113",
      "title": "RSD Link Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "hook_removed",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-113",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-113\nremove_action('wp_head', 'rsd_link');\n// END VAPT RISK-113",
          "begin_marker": "// BEGIN VAPT RISK-113",
          "end_marker": "// END VAPT RISK-113",
          "raw_code": "remove_action('wp_head', 'rsd_link');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-113",
            "end_marker": "// END VAPT RISK-113",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-114": {
      "risk_id": "RISK-114",
      "title": "WLWManifest Link Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "hook_removed",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-114",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-114\nremove_action('wp_head', 'wlwmanifest_link');\n// END VAPT RISK-114",
          "begin_marker": "// BEGIN VAPT RISK-114",
          "end_marker": "// END VAPT RISK-114",
          "raw_code": "remove_action('wp_head', 'wlwmanifest_link');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-114",
            "end_marker": "// END VAPT RISK-114",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-115": {
      "risk_id": "RISK-115",
      "title": "Shortlink Header Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "WordPress",
          "lib_key": "wordpress",
          "operation": "hook_removed",
          "write_mode": "insert_at_anchor",
          "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php",
          "backup_required": true,
          "idempotency": {
            "check_string": "// BEGIN VAPT RISK-115",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "// BEGIN VAPT RISK-115\nremove_action('wp_head', 'wp_shortlink_wp_head');\n// END VAPT RISK-115",
          "begin_marker": "// BEGIN VAPT RISK-115",
          "end_marker": "// END VAPT RISK-115",
          "raw_code": "remove_action('wp_head', 'wp_shortlink_wp_head');",
          "verification": {
            "command": "wp plugin list",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "// BEGIN VAPT RISK-115",
            "end_marker": "// END VAPT RISK-115",
            "target_file": "{ABSPATH}wp-content/plugins/vapt-protection-suite/vapt-functions.php"
          }
        }
      ]
    },
    "RISK-116": {
      "risk_id": "RISK-116",
      "title": "Nginx Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "Nginx",
          "lib_key": "nginx",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-116",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": "server_tokens",
            "anchor_position": "before",
            "fallback": "append"
          },
          "write_block": "# BEGIN VAPT RISK-116\nserver_tokens off;\n# END VAPT RISK-116",
          "begin_marker": "# BEGIN VAPT RISK-116",
          "end_marker": "# END VAPT RISK-116",
          "raw_code": "server_tokens off;",
          "verification": {
            "command": "nginx -t && nginx -s reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-116",
            "end_marker": "# END VAPT RISK-116",
            "target_file": "/etc/nginx/conf.d/vapt-security.conf"
          }
        }
      ]
    },
    "RISK-117": {
      "risk_id": "RISK-117",
      "title": "Apache Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "Apache",
          "lib_key": "apache",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/apache2/conf-available/vapt-security.conf",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-117",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-117\nServerTokens Prod\nServerSignature Off\n# END VAPT RISK-117",
          "begin_marker": "# BEGIN VAPT RISK-117",
          "end_marker": "# END VAPT RISK-117",
          "raw_code": "ServerTokens Prod\nServerSignature Off",
          "verification": {
            "command": "apachectl -t && service apache2 reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-117",
            "end_marker": "# END VAPT RISK-117",
            "target_file": "/etc/apache2/conf-available/vapt-security.conf"
          }
        }
      ]
    },
    "RISK-118": {
      "risk_id": "RISK-118",
      "title": "Nginx Buffer Size Misconfigured",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "Nginx",
          "lib_key": "nginx",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-118",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-118\nclient_body_buffer_size 10M;\nclient_header_buffer_size 1k;\nlarge_client_header_buffers 4 8k;\n# END VAPT RISK-118",
          "begin_marker": "# BEGIN VAPT RISK-118",
          "end_marker": "# END VAPT RISK-118",
          "raw_code": "client_body_buffer_size 10M;\nclient_header_buffer_size 1k;\nlarge_client_header_buffers 4 8k;",
          "verification": {
            "command": "nginx -t && nginx -s reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-118",
            "end_marker": "# END VAPT RISK-118",
            "target_file": "/etc/nginx/conf.d/vapt-security.conf"
          }
        }
      ]
    },
    "RISK-119": {
      "risk_id": "RISK-119",
      "title": "Nginx Timeout Not Configured",
      "category": "Configuration",
      "severity": "medium",
      "steps": [
        {
          "enforcer": "Nginx",
          "lib_key": "nginx",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-119",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-119\nclient_body_timeout 10s;\nclient_header_timeout 10s;\nkeepalive_timeout 30s;\nsend_timeout 10s;\n# END VAPT RISK-119",
          "begin_marker": "# BEGIN VAPT RISK-119",
          "end_marker": "# END VAPT RISK-119",
          "raw_code": "client_body_timeout 10s;\nclient_header_timeout 10s;\nkeepalive_timeout 30s;\nsend_timeout 10s;",
          "verification": {
            "command": "nginx -t && nginx -s reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-119",
            "end_marker": "# END VAPT RISK-119",
            "target_file": "/etc/nginx/conf.d/vapt-security.conf"
          }
        }
      ]
    },
    "RISK-120": {
      "risk_id": "RISK-120",
      "title": "Nginx Rate Limiting Not Configured",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "Nginx",
          "lib_key": "nginx",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-120",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-120\nlimit_req_zone $binary_remote_addr zone=one:10m rate=1r/s;\nlimit_req zone=one burst=5 nodelay;\n# END VAPT RISK-120",
          "begin_marker": "# BEGIN VAPT RISK-120",
          "end_marker": "# END VAPT RISK-120",
          "raw_code": "limit_req_zone $binary_remote_addr zone=one:10m rate=1r/s;\nlimit_req zone=one burst=5 nodelay;",
          "verification": {
            "command": "nginx -t && nginx -s reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-120",
            "end_marker": "# END VAPT RISK-120",
            "target_file": "/etc/nginx/conf.d/vapt-security.conf"
          }
        }
      ]
    },
    "RISK-121": {
      "risk_id": "RISK-121",
      "title": "Apache ModSecurity Not Enabled",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "Apache",
          "lib_key": "apache",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/apache2/conf-available/vapt-security.conf",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-121",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-121\nLoadModule security2_module modules/mod_security2.so\nInclude modsecurity.d/*.conf\n# END VAPT RISK-121",
          "begin_marker": "# BEGIN VAPT RISK-121",
          "end_marker": "# END VAPT RISK-121",
          "raw_code": "LoadModule security2_module modules/mod_security2.so\nInclude modsecurity.d/*.conf",
          "verification": {
            "command": "apachectl -t && service apache2 reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-121",
            "end_marker": "# END VAPT RISK-121",
            "target_file": "/etc/apache2/conf-available/vapt-security.conf"
          }
        }
      ]
    },
    "RISK-122": {
      "risk_id": "RISK-122",
      "title": "Nginx Gzip Compression Not Configured",
      "category": "Configuration",
      "severity": "low",
      "steps": [
        {
          "enforcer": "Nginx",
          "lib_key": "nginx",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-122",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-122\ngzip on;\ngzip_types text/plain text/css application/json application/javascript;\n# END VAPT RISK-122",
          "begin_marker": "# BEGIN VAPT RISK-122",
          "end_marker": "# END VAPT RISK-122",
          "raw_code": "gzip on;\ngzip_types text/plain text/css application/json application/javascript;",
          "verification": {
            "command": "nginx -t && nginx -s reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-122",
            "end_marker": "# END VAPT RISK-122",
            "target_file": "/etc/nginx/conf.d/vapt-security.conf"
          }
        }
      ]
    },
    "RISK-123": {
      "risk_id": "RISK-123",
      "title": "Caddy Server Version Exposed",
      "category": "Information Disclosure",
      "severity": "low",
      "steps": [
        {
          "enforcer": "Caddy",
          "lib_key": "caddy_native",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/caddy/Caddyfile",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-123",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-123\nheader -Server\n# END VAPT RISK-123",
          "begin_marker": "# BEGIN VAPT RISK-123",
          "end_marker": "# END VAPT RISK-123",
          "raw_code": "header -Server",
          "verification": {
            "command": "caddy validate --config /etc/caddy/Caddyfile && caddy reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-123",
            "end_marker": "# END VAPT RISK-123",
            "target_file": "/etc/caddy/Caddyfile"
          }
        }
      ]
    },
    "RISK-124": {
      "risk_id": "RISK-124",
      "title": "Caddy Admin Interface Exposed",
      "category": "Configuration",
      "severity": "critical",
      "steps": [
        {
          "enforcer": "Caddy",
          "lib_key": "caddy_native",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/caddy/Caddyfile",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-124",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-124\nadmin off\n# END VAPT RISK-124",
          "begin_marker": "# BEGIN VAPT RISK-124",
          "end_marker": "# END VAPT RISK-124",
          "raw_code": "admin off",
          "verification": {
            "command": "caddy validate --config /etc/caddy/Caddyfile && caddy reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-124",
            "end_marker": "# END VAPT RISK-124",
            "target_file": "/etc/caddy/Caddyfile"
          }
        }
      ]
    },
    "RISK-125": {
      "risk_id": "RISK-125",
      "title": "Nginx SSL Configuration Weak",
      "category": "Configuration",
      "severity": "high",
      "steps": [
        {
          "enforcer": "Nginx",
          "lib_key": "nginx",
          "operation": "configtest_pass",
          "write_mode": "insert_at_anchor",
          "target_file": "/etc/nginx/conf.d/vapt-security.conf",
          "backup_required": true,
          "idempotency": {
            "check_string": "# BEGIN VAPT RISK-125",
            "if_found": "skip",
            "if_not_found": "insert"
          },
          "insertion": {
            "anchor_string": null,
            "anchor_position": "append",
            "fallback": null
          },
          "write_block": "# BEGIN VAPT RISK-125\nssl_protocols TLSv1.2 TLSv1.3;\nssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';\nssl_prefer_server_ciphers on;\n# END VAPT RISK-125",
          "begin_marker": "# BEGIN VAPT RISK-125",
          "end_marker": "# END VAPT RISK-125",
          "raw_code": "ssl_protocols TLSv1.2 TLSv1.3;\nssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';\nssl_prefer_server_ciphers on;",
          "verification": {
            "command": "nginx -t && nginx -s reload",
            "expected": "No errors"
          },
          "rollback": {
            "action": "remove_block",
            "begin_marker": "# BEGIN VAPT RISK-125",
            "end_marker": "# END VAPT RISK-125",
            "target_file": "/etc/nginx/conf.d/vapt-security.conf"
          }
        }
      ]
    }
  }
}